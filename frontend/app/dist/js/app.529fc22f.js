(function(){"use strict";var e={2660:function(e,t,o){var s=o(3751),a=o(641);const r={id:"app"};function n(e,t,o,s,n,l){const i=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(i)])}var l={name:"App"},i=o(6262);const c=(0,i.A)(l,[["render",n]]);var d=c,p=(o(8111),o(3579),o(4979),o(5220)),u=o(33);const h={class:"content-section m-8 md:ml-72"},m={class:"flex flex-col md:flex-row justify-between mb-4 border-b pb-5"},g={class:"message-generator",style:{"margin-bottom":"24px"}},b={key:0,style:{background:"#f4ffec",border:"1px solid #d7ecd0","border-radius":"4px",padding:"13px"}},f={class:"text-xl md:text-2xs mb-4 text-gray-600"},k={key:0,class:"ml-5 w-5 h-5 border-2 border-green-500 border-t-transparent rounded-full animate-spin inline-block"},y={class:"overflow-x-auto max-h-[55vh] custom-scrollbar mb-2"},v={class:""},w={class:"p-3 md:p-4 text-left border border-gray-200"},x={class:"p-3 md:p-4 text-center border border-gray-200"},L={class:"p-3 md:p-4 text-center border border-gray-200"},C={class:"p-3 md:p-4 text-center border border-gray-200"},S={class:"p-3 md:p-4 text-center border border-gray-200"},E={class:"p-3 md:p-4 text-center border border-gray-200"},T={class:"p-3 md:p-4 text-center border border-gray-200"},_=["onClick"],A={class:"p-3 md:p-4 text-center border border-gray-200"},P=["onClick"],D={class:"flex flex-col aspect-[10/19] p-3 max-h-[670px] bg-[url('@/assets/chat-bg.jpg')] bg-cover bg-center custom-scrollbar"},I={class:"message"},U=["innerHTML"],M={class:"flex"},j={class:"mr-4 max-h-[600px] overflow-y-auto custom-scrollbar"},B={class:"grid grid-cols-3 gap-4 bg-[#f5f6fa] p-4 mb-2"},F={class:"relative mb-2"},W={key:0,class:"text-red-500 text-xs absolute top-full left-0 mt-1"},X={class:"mb-4"},$={class:"bg-[#f5f6fa] p-4"},N={key:0},O={key:1},R={class:"flex ml-4 place-items-stretch justify-between w-full"},V=["disabled"],z={key:0,class:"mt-2 p-3 bg-yellow-100 text-yellow-800 text-sm rounded-md border border-yellow-300"},J={class:"font-semibold"},H={class:"flex items=flex-end justify-end"},G={key:0},Q=["placeholder","onUpdate:modelValue"],Y={class:"bg-[#f5f6fa] p-4"},q={class:"mt-2"},K=["disabled"],Z={key:0,class:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 mr-2"},ee={class:"flex flex-col flex-grow h-full overflow-y-auto aspect-[10/19] min-w-[320px] p-3 max-h-[600px] bg-[url('@/assets/chat-bg.jpg')] bg-cover bg-center custom-scrollbar"},te={class:"message"},oe=["innerHTML"];function se(e,t,o,r,n,l){const i=(0,a.g2)("lord-icon"),c=(0,a.g2)("confirmationPopup"),d=(0,a.g2)("PopUp_preview"),p=(0,a.g2)("PopUp");return(0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("div",m,[(0,a.Lk)("div",g,[t[23]||(t[23]=(0,a.Lk)("h3",{style:{"font-weight":"bold"}},"Message Generator",-1)),t[24]||(t[24]=(0,a.Lk)("label",{style:{"font-size":"13px"}},"Enter your prompt:",-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.messagePrompt=e),placeholder:"e.g. I am trying to send Diwali wishes to my ...",rows:"2",style:{width:"100%","font-size":"15px",padding:"8px","margin-bottom":"10px",border:"1px solid #ccc","border-radius":"5px"}},null,512),[[s.Jo,n.messagePrompt]]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.generateMessage&&l.generateMessage(...e)),style:{background:"#208463",color:"white",border:"none","border-radius":"5px","font-size":"1em",width:"100%",padding:"12px","margin-bottom":"10px"}},(0,u.v_)(n.loading?"Generating...":"Generate Message"),1),n.generatedMessage?((0,a.uX)(),(0,a.CE)("div",b,[t[21]||(t[21]=(0,a.Lk)("b",null,"Generated Message:",-1)),t[22]||(t[22]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)((0,u.v_)(n.generatedMessage),1)])):(0,a.Q3)("",!0)])]),t[48]||(t[48]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-xl md:text-2xl font-bold"},"Manage Templates"),(0,a.Lk)("p",{class:"text-sm md:text-base"},"Your content for scheduled broadcasts goes here.")],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("button",{class:"bg-green-700 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center hover:from-[#078478] hover:via-[#08b496] hover:to-[#078478] transition-all duration-300",onClick:t[2]||(t[2]=e=>n.showPopup=!0)},t[25]||(t[25]=[(0,a.Lk)("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),(0,a.eW)(" New Template ")]))]),(0,a.Lk)("h3",f,[t[26]||(t[26]=(0,a.Lk)("b",null,"Template List",-1)),n.cursor?((0,a.uX)(),(0,a.CE)("span",k)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",y,[(0,a.Lk)("table",{class:(0,u.C4)(["w-full border border-gray-300 rounded-lg text-sm md:text-base bg-white",{"opacity-50 pointer-events-none":n.tableLoading}])},[t[27]||(t[27]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-3 md:p-4 text-left border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Name"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Language"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Status"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Category"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Sub Category"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"ID"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Preview"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Actions")])],-1)),(0,a.Lk)("tbody",v,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.templates,(t=>((0,a.uX)(),(0,a.CE)("tr",{key:t.id,class:"hover:bg-gray-50"},[(0,a.Lk)("td",w,(0,u.v_)(t.name),1),(0,a.Lk)("td",x,(0,u.v_)(t.language),1),(0,a.Lk)("td",L,[(0,a.Lk)("div",{class:(0,u.C4)({" text-green-600 font-semibold px-2 py-1 rounded":"APPROVED"===t.status," text-blue-600 font-semibold px-2 py-1 rounded":"PENDING"===t.status," text-red-500 font-semibold px-2 py-1 rounded":"REJECTED"===t.status})},(0,u.v_)(t.status),3)]),(0,a.Lk)("td",C,(0,u.v_)(t.category),1),(0,a.Lk)("td",S,(0,u.v_)(t.sub_category),1),(0,a.Lk)("td",E,(0,u.v_)(t.id),1),(0,a.Lk)("td",T,[(0,a.Lk)("button",{class:"text-gray-600 underline hover:text-gray-800 hover:bg-inherit font-medium",onClick:e=>l.showpreview(t.preview)}," Preview ",8,_)]),(0,a.Lk)("td",A,[(0,a.Lk)("button",{onClick:o=>e.showConfirmationPopup(t.name),class:"hover:bg-white rounded-full p-2 transition"},[(0,a.bF)(i,{src:"https://cdn.lordicon.com/skkahier.json",trigger:"hover",colors:"primary:#ff5757,secondary:#000000",style:{width:"32px",height:"32px"}})],8,P)])])))),128))])],2)]),n.showConfirmPopup?((0,a.uX)(),(0,a.Wv)(c,{key:0,onYes:t[3]||(t[3]=e=>l.deleteTemplate(n.deleteTemplateName)),onNo:t[4]||(t[4]=e=>n.showConfirmPopup=!1),onClose:t[5]||(t[5]=e=>n.showConfirmPopup=!1)})):(0,a.Q3)("",!0),n.showPreview?((0,a.uX)(),(0,a.Wv)(d,{key:1,onClose:l.closePreview},{default:(0,a.k6)((()=>[(0,a.Lk)("div",D,[(0,a.Lk)("div",I,[(0,a.Lk)("span",{style:{"white-space":"pre-line"},innerHTML:n.preview_data},null,8,U)])])])),_:1},8,["onClose"])):(0,a.Q3)("",!0),n.showPopup?((0,a.uX)(),(0,a.Wv)(p,{key:2,onClose:l.closePopup,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 custom-scrollbar"},{default:(0,a.k6)((()=>[t[46]||(t[46]=(0,a.Lk)("h2",{class:"text-xl font-semibold mb-4 text-green-800"},"Create Message Template",-1)),t[47]||(t[47]=(0,a.Lk)("hr",{class:"pb-4"},null,-1)),(0,a.Lk)("div",null,[(0,a.Lk)("div",M,[(0,a.Lk)("div",j,[(0,a.Lk)("form",{class:(0,u.C4)(["p-4",{"opacity-50 pointer-events-none":n.isSubmitted}])},[t[40]||(t[40]=(0,a.Lk)("h4",{class:"text-green-800"},[(0,a.Lk)("b",null,"Template name and language")],-1)),t[41]||(t[41]=(0,a.Lk)("p",{class:"text-sm mb-2"},"Categorize your template",-1)),(0,a.Lk)("div",B,[(0,a.Lk)("div",null,[t[28]||(t[28]=(0,a.Lk)("label",{class:"block below-402:text-custom-small text-sm font-medium"},[(0,a.eW)("Template Name "),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.Lk)("div",F,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>n.template.name=e),placeholder:"Template Name",onBlur:t[7]||(t[7]=(...e)=>l.validateTemplateName&&l.validateTemplateName(...e)),class:"mt-1 p-2 w-full border border-gray-300 rounded-md h-10",required:""},null,544),[[s.Jo,n.template.name]]),n.nameError?((0,a.uX)(),(0,a.CE)("span",W,(0,u.v_)(n.nameError),1)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",null,[t[30]||(t[30]=(0,a.Lk)("label",{class:"block text-sm font-medium"},[(0,a.eW)("Category"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>n.selectedCategory=e),class:"mt-1 p-2 w-full border border-gray-300 rounded-md h-10",required:""},t[29]||(t[29]=[(0,a.Lk)("option",{value:"Marketing"},"Marketing",-1),(0,a.Lk)("option",{value:"Utility"},"Utility",-1)]),512),[[s.u1,n.selectedCategory]])]),(0,a.Lk)("div",X,[t[32]||(t[32]=(0,a.Lk)("label",{class:"block text-sm font-medium"},[(0,a.eW)("Language"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>n.selectedLanguage=e),class:"mt-1 p-2 w-full border border-gray-300 rounded-md h-10",required:""},t[31]||(t[31]=[(0,a.Lk)("option",{value:"en_US",default:""},"English (US)",-1),(0,a.Lk)("option",{value:"en_GB"},"English (UK)",-1),(0,a.Lk)("option",{value:"hi"},"Hindi",-1)]),512),[[s.u1,n.selectedLanguage]])])]),t[42]||(t[42]=(0,a.Lk)("h4",{class:"text-green-800"},[(0,a.Lk)("b",null,"Content")],-1)),t[43]||(t[43]=(0,a.Lk)("p",{class:"text-sm mb-2"},"Fill in the header, body and footer sections of your template.",-1)),(0,a.Lk)("div",$,[(0,a.Lk)("div",null,[t[34]||(t[34]=(0,a.Lk)("label",{class:"block text-sm font-medium"},"Header",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>n.headerMediaComponent.format=e),class:"border border-[#ddd] p-2 rounded-md w-full mb-2"},t[33]||(t[33]=[(0,a.Lk)("option",{value:"TEXT"},"Text",-1),(0,a.Lk)("option",{value:"IMAGE"},"Image",-1),(0,a.Lk)("option",{value:"VIDEO"},"Video",-1)]),512),[[s.u1,n.headerMediaComponent.format]]),"TEXT"===n.headerMediaComponent.format?((0,a.uX)(),(0,a.CE)("div",N,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>n.headerComponent.text=e),class:"border border-[#ddd] p-2 rounded-md w-full mb-2"},null,512),[[s.Jo,n.headerComponent.text]])])):(0,a.Q3)("",!0),"IMAGE"===n.headerMediaComponent.format||"VIDEO"===n.headerMediaComponent.format?((0,a.uX)(),(0,a.CE)("div",O,[(0,a.Lk)("div",R,[(0,a.Lk)("input",{type:"file",onChange:t[12]||(t[12]=(...e)=>l.handleFileChange&&l.handleFileChange(...e)),class:"mb-4"},null,32),(0,a.Lk)("div",null,[(0,a.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>l.uploadFile&&l.uploadFile(...e)),disabled:!n.selectedFile||n.isUploading,class:"mr-5 px-4 py-2 bg-green-700 hover:bg-green-800 text-white rounded-lg disabled:cursor-not-allowed"},(0,u.v_)(n.isUploading?"Uploading...":"Upload")+(0,u.v_)(n.uploadResponse?"ed":""),9,V)])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",null,[t[35]||(t[35]=(0,a.Lk)("label",{class:"block text-sm font-medium"},[(0,a.eW)("Body"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[14]||(t[14]=e=>n.bodyComponent.text=e),class:"mt-1 p-2 w-full border border-gray-300 rounded-md h-30",placeholder:"Enter text",rows:"4",required:""},null,512),[[s.Jo,n.bodyComponent.text]]),n.warningData?((0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("p",J,"Warning:"+(0,u.v_)(n.warningData),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",H,[(0,a.Lk)("button",{type:"button",onClick:t[15]||(t[15]=(...e)=>l.addVariable&&l.addVariable(...e)),class:"text-black p-2 text-xs font-bold hover:bg-gray-200"}," + Add variable ")]),n.variables.length?((0,a.uX)(),(0,a.CE)("div",G,[t[36]||(t[36]=(0,a.Lk)("h4",null,null,-1)),t[37]||(t[37]=(0,a.Lk)("label",{class:"block text-sm font-medium"},[(0,a.eW)("Samples for body content"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),t[38]||(t[38]=(0,a.Lk)("span",{class:"text-sm text-gray-500"},"To help us review your message template, please add an example for each variable in your body text. Do not use real customer information. Cloud API hosted by Meta reviews templates and variable parameters to protect the security and integrity of our services.",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.variables,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Variable "+(t+1),"onUpdate:modelValue":e=>n.variables[t]=e,class:"border border-[#ddd] p-2 rounded-md w-50px mb-2",required:""},null,8,Q),[[s.Jo,n.variables[t]]])])))),128))])):(0,a.Q3)("",!0),t[39]||(t[39]=(0,a.Lk)("label",{class:"block text-sm font-medium"},"Footer",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>n.footerComponent.text=e),placeholder:"Enter text",class:"border border-[#ddd] p-2 rounded-md w-full mb-2"},null,512),[[s.Jo,n.footerComponent.text]])]),t[44]||(t[44]=(0,a.Lk)("h4",{class:"text-green-800 mt-2"},[(0,a.Lk)("b",null,"Buttons")],-1)),t[45]||(t[45]=(0,a.Lk)("p",{class:"text-sm mb-2"},"Create buttons that let customers respond to your message or take action.",-1)),(0,a.Lk)("div",Y,[(0,a.Lk)("span",null,[(0,a.Lk)("button",{class:"text-black p-2 text-small border border-black hover:bg-gray-200",onClick:t[17]||(t[17]=(0,s.D$)(((...e)=>l.addbutton&&l.addbutton(...e)),["prevent"]))}," + Add Button ")]),(0,a.Lk)("div",q,[n.addButton&&"ORDER_STATUS"!==n.selectedSubCategory?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:0,"onUpdate:modelValue":t[18]||(t[18]=e=>n.button.text=e),placeholder:"Text",class:"border border-[#ddd] p-2 rounded-md w-full mb-2"},null,512)),[[s.Jo,n.button.text]]):(0,a.Q3)("",!0),n.addButton&&"ORDER_STATUS"!==n.selectedSubCategory?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,"onUpdate:modelValue":t[19]||(t[19]=e=>n.button.url=e),placeholder:"URL",class:"border border-[#ddd] p-2 rounded-md w-full mb-2"},null,512)),[[s.Jo,n.button.url]]):(0,a.Q3)("",!0)])]),(0,a.Lk)("button",{onClick:t[20]||(t[20]=(0,s.D$)(((...e)=>l.submitTemplate&&l.submitTemplate(...e)),["prevent"])),class:"bg-green-700 mt-4 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center",disabled:n.loading||n.isSubmitted},[n.loading?((0,a.uX)(),(0,a.CE)("span",Z)):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,u.v_)(n.isSubmitted?"Submitted":n.loading?"Submitting...":"Submit"),1)],8,K)],2)]),(0,a.Lk)("div",ee,[(0,a.Lk)("div",te,[(0,a.Lk)("span",{style:{"white-space":"pre-line"},innerHTML:n.preview_data},null,8,oe)])])])])])),_:1,__:[46,47]},8,["onClose"])):(0,a.Q3)("",!0)])}o(4114),o(2489),o(7588),o(1701),o(7642),o(8004),o(3853),o(5876),o(2475),o(5024),o(1698);var ae=o(4335);const re={class:"fixed inset-0 bg-black bg-opacity-20 flex justify-center items-center p-5 z-[10000] text-left shadow-lg"},ne={class:"bg-[#ffffff] p-6 rounded-md w-[1000px] relative max-h-[750px]"},le={class:"flex"};function ie(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",re,[(0,a.Lk)("div",ne,[(0,a.Lk)("div",le,[(0,a.Lk)("span",{class:"close",onClick:t[0]||(t[0]=t=>e.$emit("close")),hover:""},"×")]),(0,a.RG)(e.$slots,"default",{},void 0,!0)])])}var ce={name:"PopUp"};const de=(0,i.A)(ce,[["render",ie],["__scopeId","data-v-59477ffe"]]);var pe=de,ue=o(5246);const he={class:"phone-frame relative flex flex-col items-center justify-start p-4"},me={class:"screen w-full h-max-[60vh] overflow-y-auto"};function ge(e,t,o,r,n,l){return(0,a.uX)(),(0,a.CE)("div",{class:"fixed inset-0 bg-black bg-opacity-20 flex justify-center items-center p-3 z-[10000]",onClick:t[0]||(t[0]=(0,s.D$)((t=>e.$emit("close")),["self"]))},[(0,a.Lk)("div",he,[t[1]||(t[1]=(0,a.Lk)("div",{class:"w-full flex justify-end px-2 pt-2"},null,-1)),(0,a.Lk)("div",me,[(0,a.RG)(e.$slots,"default",{},void 0,!0)])])])}var be={name:"PopUp_preview"};const fe=(0,i.A)(be,[["render",ge],["__scopeId","data-v-966138b2"]]);var ke=fe;const ye={class:"fixed inset-0 bg-black bg-opacity-20 flex justify-center items-center p-5 z-[10000] text-left shadow-lg"},ve={class:"bg-white p-6 rounded-md w-full max-w-md relative"},we={class:"flex"},xe={class:"flex justify-end gap-4"};function Le(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",ye,[(0,a.Lk)("div",ve,[(0,a.Lk)("div",we,[(0,a.Lk)("span",{class:"close",onClick:t[0]||(t[0]=t=>e.$emit("close")),hover:""},"×")]),t[3]||(t[3]=(0,a.Lk)("div",{class:"text-lg font-medium text-gray-800 mb-6"}," Are you sure you want to proceed? ",-1)),(0,a.Lk)("div",xe,[(0,a.Lk)("button",{class:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400",onClick:t[1]||(t[1]=t=>e.$emit("no"))}," No "),(0,a.Lk)("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:t[2]||(t[2]=t=>e.$emit("yes"))}," Yes ")])])])}var Ce={name:"ConfirmationPopup"};const Se=(0,i.A)(Ce,[["render",Le],["__scopeId","data-v-5d69e07e"]]);var Ee=Se,Te={name:"BroadCast1",components:{PopUp_preview:ke,confirmationPopup:Ee,PopUp:pe},props:{contactReport:{type:Object,required:!1,default:()=>({})}},data(){return{apiUrl:"http://localhost:8000",messagePrompt:"",generatedMessage:"",loading:!1,cursor:!1,selectedFile:null,isUploading:!1,uploadResponse:null,uploadError:null,uploadHandleID:null,deleteTemplateName:"",showConfirmPopup:!1,loadingGenerate:!1,isSubmitted:!1,tableLoading:!1,showPreview:!1,preview_data:"",tooltipVisible:!1,tooltipStyles:{top:"0px",left:"0px",width:"170px",height:"100px"},templateName:"",isTemplateNameValid:!0,templates:[],showPopup:!1,addButton:!1,showSelectionPopup:!1,selectedCategory:"Marketing",selectedSubCategory:"",selectedLanguage:"en_US",selectedHeaderFormat:"TEXT",template:{name:"",components:[]},bodyComponent:{type:"BODY",text:""},headerComponent:{type:"HEADER",format:"TEXT",text:""},headerMediaComponent:{type:"HEADER",format:"",example:{header_handle:[""]}},footerComponent:{type:"FOOTER",text:""},button:{type:"URL",text:"",url:""},nameError:"",variableCounter:null,variables:[],warningData:null}},async mounted(){const e=localStorage.getItem("token");e&&await this.fetchtemplateList();const t=document.createElement("script");t.src="https://cdn.lordicon.com/lusqsztk.js",t.async=!0,document.body.appendChild(t)},methods:{async generateMessage(){this.loading=!0,this.generatedMessage="";try{const e=await fetch(`${this.apiUrl}/broadcast/generate_diwali_wish`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:this.messagePrompt.trim()}),mode:"cors"}),t=await e.text();let o;console.log("generate_diwali_wish status:",e.status,"body:",t);try{o=t?JSON.parse(t):null}catch{o=t}if(!e.ok){const t=o&&"object"===typeof o?o.detail??o.error??JSON.stringify(o):o??e.statusText;return void(this.generatedMessage=`Error: ${t}`)}const s=o&&"object"===typeof o?o.wish??o.result??JSON.stringify(o):o??"";this.generatedMessage=s||"Error: AI failed to generate message."}catch(e){console.error("generateMessage error:",e),this.generatedMessage=`Error contacting backend: ${e?.message||String(e)}`}finally{this.loading=!1}},async submitTemplate(){const e=(0,ue.dj)();if(this.nameError)return;this.loading=!0;const t={name:this.template.name,components:this.template.components,language:this.selectedLanguage,category:this.selectedCategory,sub_category:this.selectedSubCategory},o=localStorage.getItem("token");if(!o)return console.error("No access token found in local storage"),void(this.loading=!1);try{const s=await ae.A.post(`${this.apiUrl}/broadcast/create-template`,t,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(s.status>=200&&s.status<300)e.success("Template created successfully"),this.isSubmitted=!0,await this.fetchtemplateList(),this.$router.push("/manage-templates");else{const t=s.data.detail||"Unknown error occurred";e.error(`Error creating template: ${t}`),console.error("Error creating template:",s.data.detail)}}catch(s){const t=s.response?.data?.detail?.error?.error_user_msg||s.response?.data?.detail?.error?.message||s.message;e.error(`Request failed: ${t}`),console.error("Request failed:",s)}finally{this.loading=!1}},addVariable(){const e=this.bodyComponent.text||"",t=e.match(/{{\d+}}/g)||[],o=t.length+1;this.bodyComponent.text+=` {{${o}}}`,this.variableCounter=o;while(this.variables.length<o)this.variables.push("")},showpreview(e){this.showPreview=!0,this.preview_data=e},addbutton(){this.addButton=!this.addButton},openPopup(){this.showPopup=!0,this.selectedType="MARKETING"},async fetchtemplateList(){const e=localStorage.getItem("token");if(this.cursor=!0,!e)return console.warn("fetchtemplateList: no token; aborting."),void(this.cursor=!1);try{const t=await fetch(`${this.apiUrl}/broadcast/template`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),o=await t.text();let s;console.log("/template status:",t.status,"body:",o);try{s=o?JSON.parse(o):null}catch{s=o}if(!t.ok)return console.error("Failed to fetch templates:",t.status,s),void(this.cursor=!1);const a=s;this.templates=a.data||[],this.cursor=!1,this.templates=this.templates.map((e=>({...e,preview:this.generateTemplatePreview(e.components)})))}catch(t){console.error("There was an error fetching the templates:",t),this.cursor=!1}},generateTemplatePreview(e){if(!Array.isArray(e))return console.warn("generateTemplatePreview: components is not an array",e),"";let t="";return e.sort(((e,t)=>{const o={HEADER:1,BODY:2,FOOTER:3,BUTTONS:4};return(o[e.type]||5)-(o[t.type]||5)})),e.forEach((e=>{switch(e.type){case"HEADER":"TEXT"===e.format?t+=`<strong>${e.text}\n</strong> `:"IMAGE"!==e.format&&"VIDEO"!==e.format||!e.example?.header_handle||("IMAGE"===e.format?t+=`<div style="width: auto; height: 200px; overflow: hidden; position: relative; border-radius: 5px">\n  <img src="${e.example.header_handle[0]}" alt="Description of image" \n       style="width: 100%; height: 100%; object-fit: cover; object-position: start; display: block ; border-radius: 4px">\n</div>`:t+=`<div style="width: auto; height: 200px; overflow: hidden; position: relative; border-radius: 5px">\n                <video controls \n                    src="${e.example.header_handle[0]}" \n                    style="width: 100%; height: 100%; object-fit: cover; object-position: start; display: block; border-radius: 4px">\n                    Your browser does not support the video tag.\n                </video>\n            </div>`);break;case"BODY":{let o=e.text;o=this.replacePlaceholders(o,e.example?.body_text),t+=o;break}case"FOOTER":t+=`<span style="font-weight: lighter; color:gray;">\n${e.text}</span> `;break;case"BUTTONS":e.buttons&&Array.isArray(e.buttons)&&(t+='<div style=" text-align: left;">',e.buttons.forEach((e=>{"URL"===e.type?t+=`\n          <a href="${e.url}" target="_blank" \n             style="display: inline-flex; align-items: center; \n                    text-decoration: none; font-weight: bold; color: #007bff; \n                     border-top: 1px solid #ddd;">\n            <svg xmlns="http://www.w3.org/2000/svg" fill="#007bff" width="19" height="19" viewBox="0 0 24 24" style="margin-right: 5px;">\n              <path d="M14 3v2h3.586l-8.293 8.293 1.414 1.414 8.293-8.293v3.586h2v-7h-7z"/>\n              <path d="M5 5h6v-2h-6c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-6h-2v6h-14v-14z"/>\n            </svg>\n            <span style="padding:5px">${e.text}</span>\n          </a>`:"REPLY"===e.type&&(t+=`\n          <button style="display: inline-block; margin: 5px 0; padding: 10px 15px; \n                         background-color: #007bff; color: white; border: none; \n                         border-radius: 20px; cursor: pointer; font-weight: bold;">\n            ${e.text}\n          </button>`)})),t+="</div>");break;default:t+="[Unknown Component Type] ";break}})),t},replacePlaceholders(e,t){return e&&Array.isArray(t)&&0!==t.length?(t.forEach(((t,o)=>{if(t&&""!==t.toString().trim()){const s=new RegExp(`\\{\\{${o+1}\\}\\}`,"g");e=e.replace(s,t.toString().trim())}})),e):e},updateTemplateComponents(){const e={...this.bodyComponent};this.variables.length>0&&(e.example={body_text:this.variables});let t=[e];this.headerComponent.text&&t.push(this.headerComponent),this.headerMediaComponent.example.header_handle&&this.headerMediaComponent.example.header_handle.length>0&&""!==this.headerMediaComponent.example.header_handle[0]&&t.push(this.headerMediaComponent),this.footerComponent.text&&t.push(this.footerComponent),this.button.text&&this.button.url&&t.push({type:"BUTTONS",buttons:[this.button]}),this.template.components=t},validateTemplateName(){this.template.name=this.template.name.toLowerCase().replace(/\s+/g,"_").trim();const e=/^[a-z_0-9]+$/;""===this.template.name?this.nameError="Template name is required":e.test(this.template.name)?this.nameError="":this.nameError="Template name must contain only lowercase letters, numbers, and underscores."},async deleteTemplate(e){this.showConfirmPopup=!1;const t=(0,ue.dj)(),o=localStorage.getItem("token");try{this.tableLoading=!0;const s=await fetch(`${this.apiUrl}/delete-template/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(s.ok)t.success("Template deleted successfully"),await this.fetchtemplateList();else{const e=await s.json();t.error(`Error: ${e.detail}`)}}catch(s){console.error("Error deleting template:",s.response?s.response.data:s.message)}finally{this.tableLoading=!1,this.deleteTemplateName=""}},closePopup(){this.showPopup=!1,this.clearForm()},clearForm(){this.Loading=!1,this.template.name="",this.isSubmitted=!1,this.variableCounter=null,this.template.components=[],this.bodyComponent.text="",this.headerComponent.text="",this.footerComponent.text="",this.button.text="",this.button.url="",this.variables=[],this.addButton=!1,this.selectedCategory="Marketing",this.selectedSubCategory="",this.selectedLanguage="en_US",this.nameError="",this.loading=!1,this.preview_data=""},closePreview(){this.showPreview=!1,this.preview_data=""},handleFileChange(e){this.selectedFile=e.target.files[0]},async uploadFile(){if(!this.selectedFile)return void(this.uploadError="No file selected for upload.");this.isUploading=!0,this.uploadResponse=null,this.uploadError=null;const e=new FormData;e.append("file",this.selectedFile);try{const t=localStorage.getItem("token"),o=await ae.A.post(`${this.apiUrl}/resumable-upload/`,e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data"}});this.uploadResponse=o.data,this.headerMediaComponent.example||(this.headerMediaComponent.example={header_handle:[""]}),this.headerMediaComponent.example.header_handle[0]=o.data.upload_response?.h||"N/A"}catch(t){this.uploadError=t.response?t.response.data.detail:"Upload failed"}finally{this.isUploading=!1}},updateVariablesFromText(e){const t=e.match(/{{\d+}}/g)||[],o=[...new Set(t.map((e=>parseInt(e.match(/\d+/)[0]))))],s=o.length;if(this.variables.length<s)while(this.variables.length<s)this.variables.push("");else this.variables.length>s&&this.variables.splice(s)},validateTemplateText(e){const t=e=>e?e.split(/\s+/).filter((e=>e.trim().length>0)).length:0,o=e||"",s=t(o),a=o.match(/{{\d+}}/g)||[],r=a.length;if(r>0){const e=(s-1)/r;this.warningData=e<3?"This template contains too many variable parameters relative to the message length. You need to decrease the number of variable parameters or increase the message length.":null}else this.warningData=null}},watch:{templateName(){this.validateTemplateName()},"bodyComponent.text"(e){this.updateVariablesFromText(e),this.validateTemplateText(e)},selectType(e){this.selectedType=e,this.showSelectionPopup=!1,this.showPopup=!0},closeSelectionPopup(){this.showSelectionPopup=!1},"template.components":{deep:!0,handler(e){this.preview_data=this.generateTemplatePreview(e)}},variables:{deep:!0,handler(){this.updateTemplateComponents()}},bodyComponent:{deep:!0,handler(){this.updateTemplateComponents()}},headerComponent:{deep:!0,handler(){this.updateTemplateComponents()}},headerMediaComponent:{deep:!0,handler(){this.updateTemplateComponents()}},footerComponent:{deep:!0,handler(){this.updateTemplateComponents()}},button:{deep:!0,handler(){this.updateTemplateComponents()}}}};const _e=(0,i.A)(Te,[["render",se],["__scopeId","data-v-1a47d92f"]]);var Ae=_e;const Pe={class:"content-section m-8 md:ml-72"},De={class:"flex flex-col md:flex-row justify-between mb-4 border-b pb-5"},Ie={class:"flex"},Ue={class:"popup-content custom-scrollbar p-4"},Me={class:"p-4 bg-[#f5f6fa] mb-4"},je={class:"mb-2"},Be={class:"mb-2"},Fe=["value"],We={key:0},Xe={key:0},$e={key:1},Ne={key:1},Oe={class:"p-4 bg-[#f5f6fa] mb-4"},Re={class:"mb-2"},Ve={class:"mb-1"},ze={key:0},Je={key:1},He={class:"flex bg-[#f5f6fa] items-center space-x-2 p-2 justify-between"},Ge={class:"overflow-x-auto max-h-[20vh] mb-8 custom-scrollbar"},Qe={class:"contact-table w-full rounded-lg border-collapse"},Ye={class:"bg-[#ffffff] text-center"},qe={class:"z-10 p-2 bg-[#ffffff] sticky top-0"},Ke={class:"text-center p-2 md:p-4 scale-125"},Ze=["value"],et={class:"text-center p-2 md:p-4"},tt={class:"text-center p-2 md:p-4"},ot={class:"text-center p-2 md:p-4"},st={class:"font-bold"},at={class:"p-4 bg-[#f5f6fa] mb-4"},rt={class:"text-sm font-semibold mb-1"},nt={class:"text-sm font-semibold mb-1"},lt={key:0,class:"flex justify-between"},it={class:"w-[50%]"},ct={class:"w-[50%]"},dt=["disabled"],pt={key:0,class:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 mr-2"},ut={class:"flex flex-col flex-grow h-full overflow-y-auto aspect-[10/19] min-w-[320px] p-3 max-h-[600px] bg-[url('@/assets/chat-bg.jpg')] bg-cover bg-center custom-scrollbar"},ht={class:"message"},mt=["innerHTML"],gt={class:"p-4 filter-container space-x-2"},bt={class:"flex items-center"},ft={class:"pb-2 pl-2"},kt={class:"flex justify-between"},yt={class:"flex items-center filter-container space-x-2"},vt={class:"w-40px"},wt={class:"overflow-x-auto max-h-[51vh] custom-scrollbar"},xt={class:"w-full border border-gray-300 rounded-lg text-sm md:text-base bg-white"},Lt={class:"p-3 md:p-4 text-left border border-gray-200"},Ct={class:"p-3 md:p-4 text-center border border-gray-200"},St={class:"p-3 md:p-4 text-center border border-gray-200"},Et={class:"p-3 md:p-4 text-center border border-gray-200"},Tt={class:"p-3 md:p-4 text-center border border-gray-200"},_t={class:"p-3 md:p-4 text-center border border-gray-200"},At=["onClick"],Pt={class:"flex justify-center mt-4"},Dt={class:"flex items-center space-x-4 bg-white shadow-md rounded-lg px-4 py-2"},It=["disabled"],Ut={class:"px-4 py-1 border border-gray-300 rounded text-gray-700 font-semibold"},Mt={class:"grid grid-cols-4 gap-4 p-4"},jt={class:"bg-gray-100 p-4 rounded-md shadow-sm flex flex-col items-left border-2 border-green-600"},Bt={class:"flex justify-between items-center"},Ft={class:"text-3xl font-semibold"},Wt={class:"bg-gray-100 p-4 rounded-md shadow-sm flex flex-col items-left border-2 border-green-600"},Xt={class:"flex justify-between items-center"},$t={class:"text-3xl font-semibold"},Nt={class:"bg-gray-100 p-4 rounded-md shadow-sm flex flex-col items-left border-2 border-green-600"},Ot={class:"flex justify-between items-center"},Rt={class:"text-3xl font-semibold"},Vt={class:"bg-gray-100 p-4 rounded-md shadow-sm flex flex-col items-left border-2 border-green-600"},zt={class:"flex justify-between items-center"},Jt={class:"text-3xl font-semibold"},Ht={class:"bg-gray-100 p-4 rounded-md shadow-sm flex flex-col items-left border-2 border-green-600"},Gt={class:"flex justify-between items-center"},Qt={class:"text-3xl font-semibold"},Yt={class:"bg-gray-100 p-4 rounded-md shadow-sm flex flex-col items-left border-2 border-green-600"},qt={class:"flex justify-between items-center"},Kt={class:"text-3xl font-semibold"},Zt={class:"p-4 overflow-x-auto max-h-[51vh] custom-scrollbar"},eo={class:"w-full border border-gray-300 rounded-lg text-sm md:text-base bg-white"},to={class:"bg-white"},oo={class:"border-[#ddd] p-2 md:p-4 text-center"},so={class:"border-[#ddd] p-2 md:p-4 text-center"},ao={class:"border-[#ddd] p-2 md:p-4 text-center"},ro={class:"border-[#ddd] p-2 md:p-4 text-center"},no={class:"relative flex justify-center items-center"},lo=["onMouseenter"];function io(e,t,o,r,n,l){const i=(0,a.g2)("PopUp"),c=(0,a.g2)("PopUp1");return(0,a.uX)(),(0,a.CE)("div",Pe,[(0,a.Lk)("div",De,[t[28]||(t[28]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-xl md:text-2xl font-bold text-green-800"},"Broadcast Messages"),(0,a.Lk)("p",{class:"text-sm md:text-base"},"Send out Broadcast Messages using templates")],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("button",{class:"bg-green-700 hover:bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center",onClick:t[0]||(t[0]=e=>(n.showPopup=!0,l.fetchContacts()))},t[27]||(t[27]=[(0,a.Lk)("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),(0,a.eW)(" New Broadcast ")]))])]),n.showPopup?((0,a.uX)(),(0,a.Wv)(i,{key:0,onClose:t[20]||(t[20]=e=>l.closePopup()),class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 custom-scrollbar"},{default:(0,a.k6)((()=>[t[55]||(t[55]=(0,a.Lk)("h2",{class:"text-xl font-semibold mb-4 text-green-800"},"New Broadcast",-1)),t[56]||(t[56]=(0,a.Lk)("hr",{class:"pb-4"},null,-1)),(0,a.Lk)("div",Ie,[(0,a.Lk)("div",Ue,[(0,a.Lk)("form",{onSubmit:t[19]||(t[19]=(0,s.D$)(((...e)=>l.handleBroadcast&&l.handleBroadcast(...e)),["prevent"])),id:"messageForm",class:(0,u.C4)({"opacity-50 pointer-events-none":n.isSubmitted})},[t[49]||(t[49]=(0,a.Lk)("h4",{class:"text-green-700"},[(0,a.Lk)("b",null,"What message do you want to send?")],-1)),t[50]||(t[50]=(0,a.Lk)("p",{class:"text-sm mb-2"},"Add broadcast name and template below",-1)),(0,a.Lk)("div",Me,[(0,a.Lk)("div",je,[t[29]||(t[29]=(0,a.Lk)("label",{for:"broadcastName",class:"block text-sm font-medium"},[(0,a.eW)("Broadcast Name"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>n.broadcastName=e),id:"broadcastName",placeholder:"Broadcast Name",required:"",class:"border border-gray-300 rounded px-3 py-2 w-full"},null,512),[[s.Jo,n.broadcastName]])]),(0,a.Lk)("div",Be,[t[35]||(t[35]=(0,a.Lk)("label",{for:"templates",class:"block text-sm font-medium"},[(0,a.eW)("Choose a template"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("select",{id:"template-select","onUpdate:modelValue":t[2]||(t[2]=e=>n.selectedTemplateId=e),onChange:t[3]||(t[3]=(...e)=>l.onTemplateSelect&&l.onTemplateSelect(...e)),class:"border border-gray-300 rounded px-3 py-2 w-full max-h-[50px]",required:""},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.templates,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,u.v_)(e.name),9,Fe)))),128))],544),[[s.u1,n.selectedTemplateId]]),n.selectedTemplateHasMedia?((0,a.uX)(),(0,a.CE)("div",We,[t[32]||(t[32]=(0,a.Lk)("label",{for:"",class:"block text-sm font-semibold"},"Upload Media",-1)),(0,a.Lk)("input",{type:"file",onChange:t[4]||(t[4]=(...e)=>l.onFileChange&&l.onFileChange(...e)),class:"mb-2 w-[60%] mr-1"},null,32),n.uploadedMedia?((0,a.uX)(),(0,a.CE)("div",Xe,t[30]||(t[30]=[(0,a.Lk)("p",{class:"text-green-800 font-bold"},"Uploaded",-1)]))):((0,a.uX)(),(0,a.CE)("div",$e,t[31]||(t[31]=[(0,a.Lk)("span",{class:"ml-5 w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin inline-block"},null,-1)])))])):(0,a.Q3)("",!0),n.selectedTemplateHasParameters?((0,a.uX)(),(0,a.CE)("div",Ne,[t[34]||(t[34]=(0,a.Lk)("label",{for:""},"Select Parameter",-1)),(0,a.bo)((0,a.Lk)("select",{name:"",id:"","onUpdate:modelValue":t[5]||(t[5]=e=>n.bodyParameter=e)},t[33]||(t[33]=[(0,a.Lk)("option",{value:"Name"},"Cotact_Name",-1)]),512),[[s.u1,n.bodyParameter]])])):(0,a.Q3)("",!0)])]),t[51]||(t[51]=(0,a.Lk)("h4",{class:"text-green-700"},[(0,a.Lk)("b",null,"Who do you want to send it to?")],-1)),t[52]||(t[52]=(0,a.Lk)("p",{class:"text-sm mb-2"},[(0,a.eW)("Select contacts below or "),(0,a.Lk)("a",{href:"https://drive.google.com/file/d/1hVQErwmNN6eGN1zLBoniW_34-GzAtMwm/view?usp=sharing",target:"_blank",class:"text-blue-500"},[(0,a.Lk)("u",null,"Download sample format for contact upload")])],-1)),(0,a.Lk)("div",Oe,[(0,a.Lk)("div",Re,[t[36]||(t[36]=(0,a.Lk)("label",{for:"recipients",class:"block text-sm font-medium"},[(0,a.eW)("Recipients"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>n.recipients=e),id:"recipients",placeholder:"Enter phone numbers, comma-separated",required:"",class:"border border-gray-300 rounded px-3 py-2 w-full"},null,512),[[s.Jo,n.recipients]])]),(0,a.Lk)("div",Ve,[t[37]||(t[37]=(0,a.Lk)("label",{for:"csvFile",class:"block text-sm font-semibold"},"Upload CSV for Contacts:",-1)),(0,a.Lk)("input",{type:"file",onChange:t[7]||(t[7]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e)),class:"mb-2 w-[60%] mr-1"},null,32)])]),n.csvUploaded?((0,a.uX)(),(0,a.CE)("div",ze,t[38]||(t[38]=[(0,a.Lk)("h4",null,[(0,a.Lk)("b",null,"Imported Contacts")],-1),(0,a.Lk)("p",{class:"text-sm mb-2"},"Imported contacts are not saved to your contacts directory",-1)]))):((0,a.uX)(),(0,a.CE)("div",Je,t[39]||(t[39]=[(0,a.Lk)("h4",{class:"text-green-700"},[(0,a.Lk)("b",null,"Contacts")],-1),(0,a.Lk)("p",{class:"text-sm mb-2"},"Select from your saved contacts",-1)]))),(0,a.Lk)("div",He,[t[40]||(t[40]=(0,a.Lk)("h3",{class:"text-l"},[(0,a.Lk)("b",null,"Filter by tags:")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=t=>e.tag_key=t),placeholder:"Key",class:"border border-gray-300 rounded px-3 py-2 w-30px"},null,512),[[s.Jo,e.tag_key]]),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=t=>e.tag_value=t),placeholder:"Value",class:"border border-gray-300 rounded px-3 py-2 w-30px"},null,512),[[s.Jo,e.tag_value]]),(0,a.Lk)("button",{onClick:t[10]||(t[10]=(0,s.D$)(((...e)=>l.fiterBytTags&&l.fiterBytTags(...e)),["prevent"])),class:"bg-gray-300 hover:bg-gray-400 relative my-2 h-auto w-auto p-1 text-white"},"Apply filter")]),(0,a.Lk)("div",Ge,[(0,a.Lk)("table",Qe,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",Ye,[(0,a.Lk)("th",qe,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",onChange:t[11]||(t[11]=e=>l.selectAll(e)),"onUpdate:modelValue":t[12]||(t[12]=e=>n.allSelected=e),class:"scale-150 m-2 z-10"},null,544),[[s.lH,n.allSelected]]),t[41]||(t[41]=(0,a.eW)("Select "))]),t[42]||(t[42]=(0,a.Lk)("th",{class:"p-2 bg-[#ffffff] sticky top-0"},"Name",-1)),t[43]||(t[43]=(0,a.Lk)("th",{class:"p-2 bg-[#ffffff] sticky top-0"},"Phone Number",-1)),t[44]||(t[44]=(0,a.Lk)("th",{class:"p-2 bg-[#ffffff] sticky top-0"},"Tags",-1))])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.contacts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",Ke,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=e=>n.selectedContacts=e),value:`${e.name}:${e.phone}`},null,8,Ze),[[s.lH,n.selectedContacts]])]),(0,a.Lk)("td",et,(0,u.v_)(e.name),1),(0,a.Lk)("td",tt,(0,u.v_)(e.phone),1),(0,a.Lk)("td",ot,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.tags,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.Lk)("span",st,(0,u.v_)(e.key)+":",1),(0,a.eW)(" "+(0,u.v_)(e.value),1)])))),128))])])))),128))])])]),t[53]||(t[53]=(0,a.Lk)("h4",{class:"text-green-700"},[(0,a.Lk)("b",null,"When do you want to send the message ?")],-1)),t[54]||(t[54]=(0,a.Lk)("p",{class:"text-sm mb-2"},"Select from the options below ",-1)),(0,a.Lk)("div",at,[(0,a.Lk)("p",rt,[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[14]||(t[14]=e=>n.isScheduled=e),value:!1,class:"scale-150 text-green-500 m-2 accent-green-700"},null,512),[[s.XL,n.isScheduled]]),t[45]||(t[45]=(0,a.eW)("Send Now"))]),(0,a.Lk)("p",nt,[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[15]||(t[15]=e=>n.isScheduled=e),value:!0,class:"scale-150 text-green-500 m-2 accent-green-700",onClick:t[16]||(t[16]=(...e)=>l.currentDateTime&&l.currentDateTime(...e))},null,512),[[s.XL,n.isScheduled]]),t[46]||(t[46]=(0,a.eW)("Schedule "))]),n.isScheduled?((0,a.uX)(),(0,a.CE)("div",lt,[(0,a.Lk)("div",it,[t[47]||(t[47]=(0,a.Lk)("label",{for:"scheduleDate",class:"block text-sm font-medium"},[(0,a.eW)("Date"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"date","onUpdate:modelValue":t[17]||(t[17]=e=>n.scheduleDate=e),id:"scheduleDate",required:"",class:"border border-gray-300 rounded px-3 py-2 w-full"},null,512),[[s.Jo,n.scheduleDate]])]),(0,a.Lk)("div",ct,[t[48]||(t[48]=(0,a.Lk)("label",{for:"scheduleTime",class:"block text-sm font-medium"},[(0,a.eW)("Time"),(0,a.Lk)("span",{class:"text-red-800"},"*"),(0,a.eW)("(GMT +5:30)")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"time","onUpdate:modelValue":t[18]||(t[18]=e=>n.scheduleTime=e),id:"scheduleTime",required:"",class:"border border-gray-300 rounded px-3 py-2 w-full"},null,512),[[s.Jo,n.scheduleTime]])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("button",{type:"submit",class:"bg-green-700 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center",disabled:n.popupLoading||n.isSubmitted},[n.popupLoading?((0,a.uX)(),(0,a.CE)("span",pt)):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,u.v_)(n.isSubmitted?"Submitted":n.popupLoading?"Submitting...":n.isScheduled?"Schedule Message":"Send Message"),1)],8,dt)],34)]),(0,a.Lk)("div",ut,[(0,a.Lk)("div",ht,[(0,a.Lk)("span",{style:{"white-space":"pre-line"},innerHTML:n.previewData},null,8,mt)])])])])),_:1,__:[55,56]})):(0,a.Q3)("",!0),(0,a.Lk)("div",gt,[(0,a.Lk)("div",bt,[t[57]||(t[57]=(0,a.Lk)("h3",{class:"text-xl md:text-2xs mb-2 text-green-700"},[(0,a.Lk)("b",null,"Broadcast List ")],-1)),(0,a.Lk)("div",ft,[(0,a.Lk)("button",{class:"text-green-600 underline hover:text-green-700 hover:bg-transparent",onClick:t[21]||(t[21]=e=>l.fetchBroadcastList(this.filterStatus,1))},[(0,a.Lk)("i",{class:(0,u.C4)(["bi bi-arrow-clockwise inline-block text-xl",{"animate-spin":n.loading}])},null,2)])])]),(0,a.Lk)("div",kt,[(0,a.Lk)("div",yt,[t[59]||(t[59]=(0,a.Lk)("h3",null,[(0,a.Lk)("b",null,"Filter by:")],-1)),(0,a.Lk)("div",vt,[(0,a.Lk)("select",{name:"",id:"",onChange:t[22]||(t[22]=(...e)=>l.filterBroadcastsByStatus&&l.filterBroadcastsByStatus(...e)),class:"border border-gray-300 rounded px-3 py-2"},t[58]||(t[58]=[(0,a.Lk)("option",{value:"null"},"Status",-1),(0,a.Lk)("option",{value:"Successful"},"Successful",-1),(0,a.Lk)("option",{value:"Cancelled"},"Cancelled",-1),(0,a.Lk)("option",{value:"Partially Successful"},"Partially Successful",-1)]),32)])])])]),(0,a.Lk)("div",wt,[(0,a.Lk)("table",xt,[t[60]||(t[60]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-3 md:p-4 text-left border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Broadcast Name"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Type"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Template"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Contacts"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Status"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.broadcasts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:"hover:bg-gray-50"},[(0,a.Lk)("td",Lt,(0,u.v_)(e.name),1),(0,a.Lk)("td",Ct,(0,u.v_)(e.type),1),(0,a.Lk)("td",St,(0,u.v_)(e.template),1),(0,a.Lk)("td",Et,(0,u.v_)(e.contacts.length),1),(0,a.Lk)("td",Tt,[(0,a.Lk)("div",{class:(0,u.C4)({"text-emerald-600 font-semibold":"Successful"===e.status,"text-sky-600 font-semibold":"Scheduled"===e.status,"text-rose-600 font-semibold":"Cancelled"===e.status,"text-amber-600 font-semibold":"Partially Successful"===e.status,"text-indigo-600 font-semibold":"processing..."===e.status})},(0,u.v_)(e.status),3)]),(0,a.Lk)("td",_t,[(0,a.Lk)("button",{class:"underline text-gray-800 hover:bg-inherit font-medium",onClick:t=>(n.showReportPopup=!0,l.fetchBroadcastReport(e.id))}," View Report ",8,At)])])))),128))])])]),(0,a.Lk)("div",Pt,[(0,a.Lk)("div",Dt,[(0,a.Lk)("button",{class:"px-3 py-1 bg-green-500 text-white font-medium rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",onClick:t[23]||(t[23]=(...e)=>l.loadPreviousPage&&l.loadPreviousPage(...e)),disabled:1===n.currentPage}," Previous ",8,It),(0,a.Lk)("div",Ut,(0,u.v_)(n.currentPage),1),(0,a.Lk)("button",{class:"px-3 py-1 bg-green-500 text-white font-medium rounded hover:bg-green-600",onClick:t[24]||(t[24]=(...e)=>l.loadNextPage&&l.loadNextPage(...e))}," Next ")])]),n.showReportPopup?((0,a.uX)(),(0,a.Wv)(c,{key:1,onClose:t[26]||(t[26]=e=>(n.showReportPopup=!1,n.broadcastReports=[""]))},{default:(0,a.k6)((()=>[t[74]||(t[74]=(0,a.Lk)("h3",{class:"text-xl md:text-2xs mb-4"},[(0,a.Lk)("b",null,"Broadcast Report")],-1)),(0,a.Lk)("div",Mt,[(0,a.Lk)("div",jt,[(0,a.Lk)("div",Bt,[(0,a.Lk)("span",Ft,(0,u.v_)(l.totals.sent),1),t[61]||(t[61]=(0,a.Lk)("div",{class:"w-10 h-10 flex items-center justify-center mb-auto rounded-full bg-white"},[(0,a.Lk)("svg",{width:"18",height:"14",viewBox:"0 0 18 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M1.66797 7L7.16797 12.5L16.3346 1.5",stroke:"#23A455","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1))]),t[62]||(t[62]=(0,a.Lk)("span",{class:"text-gray-500"},"Sent",-1))]),(0,a.Lk)("div",Wt,[(0,a.Lk)("div",Xt,[(0,a.Lk)("span",$t,(0,u.v_)(l.totals.delivered),1),t[63]||(t[63]=(0,a.Lk)("div",{class:"w-10 h-10 flex items-center justify-center mb-auto rounded-full bg-white"},[(0,a.Lk)("svg",{width:"22",height:"12",viewBox:"0 0 22 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M1.83203 6L6.64453 10.5833L9.05078 7.83333",stroke:"#23A455","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.Lk)("path",{d:"M7.33203 5.99984L12.1445 10.5832L20.1654 1.4165",stroke:"#23A455","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.Lk)("path",{d:"M14.6654 1.4165L11.457 5.08317",stroke:"#23A455","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1))]),t[64]||(t[64]=(0,a.Lk)("span",{class:"text-gray-500"},"Delivered",-1))]),(0,a.Lk)("div",Nt,[(0,a.Lk)("div",Ot,[(0,a.Lk)("span",Rt,(0,u.v_)(l.totals.read),1),t[65]||(t[65]=(0,a.Lk)("div",{class:"w-10 h-10 flex items-center justify-center mb-auto rounded-full bg-white"},[(0,a.Lk)("svg",{width:"22",height:"16",viewBox:"0 0 22 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M20.2565 6.962C20.7305 7.582 20.7305 8.419 20.2565 9.038C18.7635 10.987 15.1815 15 10.9995 15C6.81752 15 3.23552 10.987 1.74252 9.038C1.51191 8.74113 1.38672 8.37592 1.38672 8C1.38672 7.62408 1.51191 7.25887 1.74252 6.962C3.23552 5.013 6.81752 1 10.9995 1C15.1815 1 18.7635 5.013 20.2565 6.962V6.962Z",stroke:"#23A455","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,a.Lk)("path",{d:"M11 11C12.6569 11 14 9.65685 14 8C14 6.34315 12.6569 5 11 5C9.34315 5 8 6.34315 8 8C8 9.65685 9.34315 11 11 11Z",stroke:"#23A455","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1))]),t[66]||(t[66]=(0,a.Lk)("span",{class:"text-gray-500"},"Read",-1))]),(0,a.Lk)("div",Vt,[(0,a.Lk)("div",zt,[(0,a.Lk)("span",Jt,(0,u.v_)(l.totals.replied),1),t[67]||(t[67]=(0,a.Lk)("div",{class:"w-10 h-10 flex items-center justify-center mb-auto rounded-full bg-white"},[(0,a.Lk)("svg",{width:"22",height:"16",viewBox:"0 0 22 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M8.60219 0.736277C8.76965 0.805709 8.91277 0.923237 9.01344 1.074C9.11411 1.22476 9.16782 1.40199 9.16777 1.58328V3.03711L11.2697 0.935194C11.3979 0.807035 11.5612 0.719762 11.739 0.684408C11.9168 0.649055 12.1011 0.667208 12.2685 0.736572C12.436 0.805936 12.5792 0.923397 12.6799 1.07411C12.7806 1.22482 12.8344 1.40201 12.8344 1.58328V4.35986C14.5385 4.45978 15.9245 4.84203 17.0447 5.44519C18.2398 6.0821 19.2221 7.0554 19.8699 8.24469C21.0524 10.3851 21.0844 12.9023 21.0844 14.4166C21.0844 14.6597 20.9879 14.8929 20.816 15.0648C20.644 15.2367 20.4109 15.3333 20.1678 15.3333C19.9247 15.3333 19.6915 15.2367 19.5196 15.0648C19.3477 14.8929 19.2511 14.6597 19.2511 14.4166C19.2511 13.8474 19.0513 13.4257 18.7039 13.0783C18.3335 12.7089 17.7679 12.399 17.0245 12.1616C15.7925 11.7693 14.2562 11.6354 12.8344 11.6437V14.4166C12.8344 14.5979 12.7806 14.7751 12.6799 14.9258C12.5792 15.0765 12.436 15.1939 12.2685 15.2633C12.1011 15.3327 11.9168 15.3508 11.739 15.3155C11.5612 15.2801 11.3979 15.1929 11.2697 15.0647L9.16777 12.9628V14.4166C9.16773 14.5979 9.11395 14.7751 9.01322 14.9258C8.9125 15.0765 8.76935 15.1939 8.60187 15.2633C8.4344 15.3327 8.25012 15.3508 8.07233 15.3155C7.89454 15.2801 7.73122 15.1929 7.60302 15.0647L1.18636 8.64803C1.01451 8.47613 0.917969 8.24301 0.917969 7.99994C0.917969 7.75688 1.01451 7.52376 1.18636 7.35186L7.60302 0.935194C7.73121 0.806922 7.89457 0.719555 8.07243 0.684147C8.25028 0.648739 8.43465 0.666881 8.60219 0.736277ZM7.33444 11.1294L4.85302 8.64803C4.68117 8.47613 4.58464 8.24301 4.58464 7.99994C4.58464 7.75688 4.68117 7.52376 4.85302 7.35186L7.33444 4.87044V3.79611L3.13061 7.99994L7.33444 12.2038V11.1294ZM18.955 11.0011C18.8138 10.3485 18.5814 9.719 18.2648 9.13111C17.7871 8.24994 17.0601 7.5293 16.1748 7.05944C15.1866 6.52686 13.8199 6.16661 11.9178 6.16661C11.6747 6.16661 11.4415 6.07003 11.2696 5.89812C11.0977 5.72622 11.0011 5.49306 11.0011 5.24994V3.79611L6.79727 7.99994L11.0011 12.2038V10.7499C11.0011 10.514 11.0921 10.2871 11.2552 10.1165C11.4182 9.94593 11.6408 9.84481 11.8765 9.83419C13.5989 9.75628 15.787 9.84336 17.5819 10.4154C18.0584 10.5635 18.5185 10.7601 18.955 11.002V11.0011Z",fill:"#23A455"})])],-1))]),t[68]||(t[68]=(0,a.Lk)("span",{class:"text-gray-500"},"Replied",-1))]),(0,a.Lk)("div",Ht,[(0,a.Lk)("div",Gt,[(0,a.Lk)("span",Qt,(0,u.v_)(l.totals.sent),1),t[69]||(t[69]=(0,a.Lk)("div",{class:"w-10 h-10 flex items-center justify-center mb-auto rounded-full bg-white"},[(0,a.Lk)("svg",{width:"22",height:"16",viewBox:"0 0 22 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M8.60219 0.736277C8.76965 0.805709 8.91277 0.923237 9.01344 1.074C9.11411 1.22476 9.16782 1.40199 9.16777 1.58328V3.03711L11.2697 0.935194C11.3979 0.807035 11.5612 0.719762 11.739 0.684408C11.9168 0.649055 12.1011 0.667208 12.2685 0.736572C12.436 0.805936 12.5792 0.923397 12.6799 1.07411C12.7806 1.22482 12.8344 1.40201 12.8344 1.58328V4.35986C14.5385 4.45978 15.9245 4.84203 17.0447 5.44519C18.2398 6.0821 19.2221 7.0554 19.8699 8.24469C21.0524 10.3851 21.0844 12.9023 21.0844 14.4166C21.0844 14.6597 20.9879 14.8929 20.816 15.0648C20.644 15.2367 20.4109 15.3333 20.1678 15.3333C19.9247 15.3333 19.6915 15.2367 19.5196 15.0648C19.3477 14.8929 19.2511 14.6597 19.2511 14.4166C19.2511 13.8474 19.0513 13.4257 18.7039 13.0783C18.3335 12.7089 17.7679 12.399 17.0245 12.1616C15.7925 11.7693 14.2562 11.6354 12.8344 11.6437V14.4166C12.8344 14.5979 12.7806 14.7751 12.6799 14.9258C12.5792 15.0765 12.436 15.1939 12.2685 15.2633C12.1011 15.3327 11.9168 15.3508 11.739 15.3155C11.5612 15.2801 11.3979 15.1929 11.2697 15.0647L9.16777 12.9628V14.4166C9.16773 14.5979 9.11395 14.7751 9.01322 14.9258C8.9125 15.0765 8.76935 15.1939 8.60187 15.2633C8.4344 15.3327 8.25012 15.3508 8.07233 15.3155C7.89454 15.2801 7.73122 15.1929 7.60302 15.0647L1.18636 8.64803C1.01451 8.47613 0.917969 8.24301 0.917969 7.99994C0.917969 7.75688 1.01451 7.52376 1.18636 7.35186L7.60302 0.935194C7.73121 0.806922 7.89457 0.719555 8.07243 0.684147C8.25028 0.648739 8.43465 0.666881 8.60219 0.736277ZM7.33444 11.1294L4.85302 8.64803C4.68117 8.47613 4.58464 8.24301 4.58464 7.99994C4.58464 7.75688 4.68117 7.52376 4.85302 7.35186L7.33444 4.87044V3.79611L3.13061 7.99994L7.33444 12.2038V11.1294ZM18.955 11.0011C18.8138 10.3485 18.5814 9.719 18.2648 9.13111C17.7871 8.24994 17.0601 7.5293 16.1748 7.05944C15.1866 6.52686 13.8199 6.16661 11.9178 6.16661C11.6747 6.16661 11.4415 6.07003 11.2696 5.89812C11.0977 5.72622 11.0011 5.49306 11.0011 5.24994V3.79611L6.79727 7.99994L11.0011 12.2038V10.7499C11.0011 10.514 11.0921 10.2871 11.2552 10.1165C11.4182 9.94593 11.6408 9.84481 11.8765 9.83419C13.5989 9.75628 15.787 9.84336 17.5819 10.4154C18.0584 10.5635 18.5185 10.7601 18.955 11.002V11.0011Z",fill:"#23A455"})])],-1))]),t[70]||(t[70]=(0,a.Lk)("span",{class:"text-gray-500"},"Success",-1))]),(0,a.Lk)("div",Yt,[(0,a.Lk)("div",qt,[(0,a.Lk)("span",Kt,(0,u.v_)(l.totals.failed),1),t[71]||(t[71]=(0,a.Lk)("div",{class:"w-10 h-10 flex items-center justify-center mb-auto rounded-full bg-white"},[(0,a.Lk)("svg",{width:"22",height:"16",viewBox:"0 0 22 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{d:"M8.60219 0.736277C8.76965 0.805709 8.91277 0.923237 9.01344 1.074C9.11411 1.22476 9.16782 1.40199 9.16777 1.58328V3.03711L11.2697 0.935194C11.3979 0.807035 11.5612 0.719762 11.739 0.684408C11.9168 0.649055 12.1011 0.667208 12.2685 0.736572C12.436 0.805936 12.5792 0.923397 12.6799 1.07411C12.7806 1.22482 12.8344 1.40201 12.8344 1.58328V4.35986C14.5385 4.45978 15.9245 4.84203 17.0447 5.44519C18.2398 6.0821 19.2221 7.0554 19.8699 8.24469C21.0524 10.3851 21.0844 12.9023 21.0844 14.4166C21.0844 14.6597 20.9879 14.8929 20.816 15.0648C20.644 15.2367 20.4109 15.3333 20.1678 15.3333C19.9247 15.3333 19.6915 15.2367 19.5196 15.0648C19.3477 14.8929 19.2511 14.6597 19.2511 14.4166C19.2511 13.8474 19.0513 13.4257 18.7039 13.0783C18.3335 12.7089 17.7679 12.399 17.0245 12.1616C15.7925 11.7693 14.2562 11.6354 12.8344 11.6437V14.4166C12.8344 14.5979 12.7806 14.7751 12.6799 14.9258C12.5792 15.0765 12.436 15.1939 12.2685 15.2633C12.1011 15.3327 11.9168 15.3508 11.739 15.3155C11.5612 15.2801 11.3979 15.1929 11.2697 15.0647L9.16777 12.9628V14.4166C9.16773 14.5979 9.11395 14.7751 9.01322 14.9258C8.9125 15.0765 8.76935 15.1939 8.60187 15.2633C8.4344 15.3327 8.25012 15.3508 8.07233 15.3155C7.89454 15.2801 7.73122 15.1929 7.60302 15.0647L1.18636 8.64803C1.01451 8.47613 0.917969 8.24301 0.917969 7.99994C0.917969 7.75688 1.01451 7.52376 1.18636 7.35186L7.60302 0.935194C7.73121 0.806922 7.89457 0.719555 8.07243 0.684147C8.25028 0.648739 8.43465 0.666881 8.60219 0.736277ZM7.33444 11.1294L4.85302 8.64803C4.68117 8.47613 4.58464 8.24301 4.58464 7.99994C4.58464 7.75688 4.68117 7.52376 4.85302 7.35186L7.33444 4.87044V3.79611L3.13061 7.99994L7.33444 12.2038V11.1294ZM18.955 11.0011C18.8138 10.3485 18.5814 9.719 18.2648 9.13111C17.7871 8.24994 17.0601 7.5293 16.1748 7.05944C15.1866 6.52686 13.8199 6.16661 11.9178 6.16661C11.6747 6.16661 11.4415 6.07003 11.2696 5.89812C11.0977 5.72622 11.0011 5.49306 11.0011 5.24994V3.79611L6.79727 7.99994L11.0011 12.2038V10.7499C11.0011 10.514 11.0921 10.2871 11.2552 10.1165C11.4182 9.94593 11.6408 9.84481 11.8765 9.83419C13.5989 9.75628 15.787 9.84336 17.5819 10.4154C18.0584 10.5635 18.5185 10.7601 18.955 11.002V11.0011Z",fill:"#23A455"})])],-1))]),t[72]||(t[72]=(0,a.Lk)("span",{class:"text-gray-500"},"Failed",-1))])]),(0,a.Lk)("div",Zt,[(0,a.Lk)("table",eo,[t[73]||(t[73]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-2 md:p-4 border-b-2 sticky top-0"},"Name"),(0,a.Lk)("th",{class:"p-2 md:p-4 border-b-2 sticky top-0"},"Phone No"),(0,a.Lk)("th",{class:"p-2 md:p-4 border-b-2 sticky top-0"},"Status"),(0,a.Lk)("th",{class:"p-2 md:p-4 border-b-2 sticky top-0"},"Failure Reason")])],-1)),(0,a.Lk)("tbody",to,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.broadcastReports,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",oo,(0,u.v_)(e.contact_name),1),(0,a.Lk)("td",so,(0,u.v_)(e.phone_no),1),(0,a.Lk)("td",ao,(0,u.v_)(e.status),1),(0,a.Lk)("td",ro,[(0,a.Lk)("div",no,[e.error_reason?((0,a.uX)(),(0,a.CE)("button",{key:0,onMouseenter:e=>l.showTooltip(o,e),onMouseleave:t[25]||(t[25]=(...e)=>l.hideTooltip&&l.hideTooltip(...e)),class:"info-button"}," ℹ️ ",40,lo)):(0,a.Q3)("",!0),n.tooltipVisible===o?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"tooltip-container absolute bg-gray-700 text-white p-2 rounded text-sm",style:(0,u.Tr)(n.tooltipStyles)},(0,u.v_)(e.error_reason),5)):(0,a.Q3)("",!0)])])])))),128))])])])])),_:1,__:[74]})):(0,a.Q3)("",!0)])}o(116),o(8237);const co={class:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-[10000]"},po={class:"bg-[#ffffff] p-6 rounded-md w-[750px] relative max-h-[750px]"},uo={class:"flex"};function ho(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",co,[(0,a.Lk)("div",po,[(0,a.Lk)("div",uo,[(0,a.Lk)("span",{class:"close",onClick:t[0]||(t[0]=t=>e.$emit("close")),hover:""},"×")]),(0,a.RG)(e.$slots,"default",{},void 0,!0)])])}var mo={name:"PopUp1"};const go=(0,i.A)(mo,[["render",ho],["__scopeId","data-v-7121ff01"]]);var bo=go,fo={name:"BroadCast2",components:{PopUp:pe,PopUp1:bo},props:{contactReport:{type:Object,required:!0}},data(){return{apiUrl:"http://localhost:8000",previewData:null,loading:!1,currentPage:1,tooltipVisible:null,tooltipStyles:{},mediafile:null,mediaId:"",uploadedMedia:!1,broadcastName:"",recipients:"",selectedTemplate:"",templates:[],contacts:[],broadcasts:[],broadcastReports:[],totalRead:"",totalSent:"",totalDelivered:"",csvUploaded:!1,allSelected:!1,csvFile:null,selectedContacts:[],showPopup:!1,showReportPopup:!1,scheduleDate:"",scheduleTime:"",isScheduled:!1,selectedTemplateId:null,selectedTemplateHasMedia:!1,imageUrl:"",selectedTemplateHasParameters:!1,bodyParameters:[],bodyParameter:"",filterStatus:null,popupLoading:!1,isSubmitted:!1,tableLoading:!1}},async mounted(){await this.fetchContacts(),await this.fetchBroadcastList(),await this.fetchtemplateList()},methods:{generateTemplatePreview(e){let t="";return e.forEach((e=>{switch(e.type){case"HEADER":"TEXT"===e.format?t+=`<strong>${e.text}\n</strong> `:"IMAGE"===e.format&&e.example?.header_handle?t+=`<div style="width: auto; height: 200px; overflow: hidden; position: relative; border-radius: 5px">\n  <img src="${e.example.header_handle[0]}" alt="Description of image" \n       style="width: 100%; height: 100%; object-fit: cover; object-position: start; display: block ; border-radius: 4px">\n</div>`:"VIDEO"===e.format&&e.example?.header_handle&&(t+=`<div style="width: auto; height: 200px; overflow: hidden; position: relative; border-radius: 5px">\n                <video controls \n                    src="${e.example.header_handle[0]}" \n                    style="width: 100%; height: 100%; object-fit: cover; object-position: start; display: block; border-radius: 4px">\n                    Your browser does not support the video tag.\n                </video>\n            </div>`);break;case"BODY":{let o=e.text;o=this.replacePlaceholders(o,e.example?.body_text),t+=o;break}case"FOOTER":t+=`<span style="font-weight: lighter; color:gray;">\n${e.text}</span> `;break;case"BUTTONS":e.buttons&&Array.isArray(e.buttons)&&(t+='<div style=" text-align: left;">',e.buttons.forEach((e=>{"URL"===e.type?t+=`\n          <a href="${e.url}" target="_blank" \n             style="display: inline-flex; align-items: center; \n                    text-decoration: none; font-weight: bold; color: #007bff; \n                     border-top: 1px solid #ddd;">\n            <svg xmlns="http://www.w3.org/2000/svg" fill="#007bff" width="19" height="19" viewBox="0 0 24 24" style="margin-right: 5px;">\n              <path d="M14 3v2h3.586l-8.293 8.293 1.414 1.414 8.293-8.293v3.586h2v-7h-7z"/>\n              <path d="M5 5h6v-2h-6c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-6h-2v6h-14v-14z"/>\n            </svg>\n            <span style="padding:5px">${e.text}</span>\n            \n          </a>`:"REPLY"===e.type&&(t+=`\n          <button style="display: inline-block; margin: 5px 0; padding: 10px 15px; \n                         background-color: #007bff; color: white; border: none; \n                         border-radius: 20px; cursor: pointer; font-weight: bold;">\n            ${e.text}\n          </button>`)})),t+="</div>");break;default:t+="[Unknown Component Type] ";break}})),t},replacePlaceholders(e,t){return t&&t.length>0&&t.forEach(((t,o)=>{const s=`${o+1}`;e=e.replace(s,t[0])})),e},async loadNextPage(){const e=this.broadcasts[0]?.id;await this.fetchBroadcastList(this.filterStatus,this.currentPage+1);const t=this.broadcasts[0]?.id;e!==t&&this.broadcasts.length>0&&(this.currentPage+=1)},async loadPreviousPage(){this.currentPage>1&&(this.currentPage-=1,await this.fetchBroadcastList(this.filterStatus,this.currentPage))},showTooltip(e,t){this.tooltipVisible=e;const{clientX:o,clientY:s}=t;this.tooltipStyles={left:`${o}px`,top:`${s+15}px`}},hideTooltip(){this.tooltipVisible=null},async fetchtemplateList(){const e=localStorage.getItem("token");try{const t=await fetch(`${this.apiUrl}/template`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Network response was not ok");const o=await t.json();this.templates=o.data}catch(t){console.error("There was an error fetching the templates:",t)}},async onTemplateSelect(){const e=this.templates.find((e=>e.id===this.selectedTemplateId));this.previewData=this.generateTemplatePreview(e.components),console.log(this.previewData);const t=e.components.find((e=>"HEADER"===e.type&&("IMAGE"===e.format||"VIDEO"===e.format)));if(t){if(this.selectedTemplateHasMedia=!0,this.imageUrl=t.example?.header_handle?.[0]||"",this.imageUrl)try{const e=localStorage.getItem("token"),t=new URL("http://localhost:8000/download-media");t.searchParams.append("media_url",this.imageUrl);const o=await fetch(t.toString(),{headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error(`Download failed with status ${o.status}`);const s=await o.blob();console.log("Blob received:",s);const a=o.headers.get("content-type")||"application/octet-stream",r=a.split("/")[1]||"bin",n=new File([s],`template-media.${r}`,{type:a}),l={target:{files:[n]}};await this.onFileChange(l),this.popupLoading=!1,console.log(`Template media downloaded and uploaded successfully.: ${this.mediaId}`)}catch(s){console.error("Failed to download/upload template media:",s)}}else this.selectedTemplateHasMedia=!1,this.imageUrl="";const o=e.components.find((e=>"BODY"===e.type));if(o&&o.text.includes("{{")){const e=o.text.match(/{{\d+}}/g);e?(this.selectedTemplateHasParameters=!0,this.bodyParameters=e.map(((e,t)=>({name:`Parameter ${t+1}`,value:""})))):(this.selectedTemplateHasParameters=!1,this.bodyParameters=[])}else this.selectedTemplateHasParameters=!1,this.bodyParameters=[]},async fetchContacts(){try{const e=localStorage.getItem("token"),t=await fetch(`${this.apiUrl}/contacts/?limit=1000&offset=0`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Network response was not ok");const o=await t.json();this.contacts=o.map((e=>({id:e.id,name:e.name,phone:e.phone,tags:e.tags.map((e=>{const[t,o]=e.split(":");return{key:t,value:o}}))})))}catch(e){console.error("Error fetching contacts:",e)}},async fetchBroadcastList(e=null,t=1){const o=localStorage.getItem("token"),s=10;this.filterStatus=e;const a=`${this.apiUrl}/broadcast?limit=${s}&offset=${(t-1)*s}&statusfilter=${this.filterStatus}`;try{this.loading=!0;const e=await fetch(a,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();this.loading=!1,this.broadcasts=t.map((e=>({id:e.id,name:e.name,type:e.type,template:e.template,contacts:e.contacts,success:e.success,failed:e.failed,status:e.status,created_at:e.created_at,updated_at:e.updated_at}))),console.log("Broadcasts:",this.broadcasts)}catch(r){console.error("Error fetching broadcasts:",r)}},filterBroadcastsByStatus(e){const t=e.target.value;this.fetchBroadcastList(t)},formatDateTime(e){const t=String(e.getDate()).padStart(2,"0"),o=String(e.getMonth()+1).padStart(2,"0"),s=e.getFullYear(),a=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0"),n=String(e.getSeconds()).padStart(2,"0");return`${t}/${o}/${s} ${a}:${r}:${n}`},updateRecipients(){this.recipients=this.selectedContacts.join(", ")},async onFileChange(e){this.mediafile=e.target.files[0],this.uploadMedia()},async uploadMedia(){if(!this.mediafile)return void console.error("No file available for upload");const e=localStorage.getItem("token"),t=new FormData;t.append("file",this.mediafile);try{const o=await fetch(`${this.apiUrl}/upload-media`,{method:"POST",headers:{Authorization:`Bearer ${e}`},body:t}),s=await o.json();if(this.mediaId=s.whatsapp_media_id,console.log(this.mediaId),!o.ok)throw new Error("Network response was not ok");this.uploadedMedia=!0}catch(o){console.error("Error uploading media:",o)}},async sendBroadcast(){const e=(0,ue.dj)(),t=this.recipients.split(",").map((e=>{const[t,o]=e.split(":").map((e=>e.trim()));return{name:t,phone:o}})),o=this.templates.find((e=>e.id===this.selectedTemplateId)),s=o.name,a=this.formatDateTime(new Date),r=`${this.broadcastName} - ${a}`,n=this.mediaId,l=localStorage.getItem("token"),i=this.bodyParameter;try{this.popupLoading=!0,this.fetchBroadcastList();const a={name:r,recipients:t,template:s,template_data:JSON.stringify(o),type:"Broadcast",status:"Saved"};n&&(a.image_id=n),i&&(a.body_parameters=i);const c=await fetch(`${this.apiUrl}/send-template-message/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!c.ok)throw new Error("Network response was not ok");this.fetchBroadcastList(),this.popupLoading=!1,this.isSubmitted=!0,e.success("Broadcast sent successfully")}catch(c){console.error("Error sending broadcast:",c)}},closePopup(){this.showPopup=!1,this.clearForm()},async fetchBroadcastReport(e){const t=localStorage.getItem("token");try{const o=await fetch(`${this.apiUrl}/broadcast-report/${e}`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error("Network response was not ok");const s=await o.json();this.broadcastReports=s.map((e=>({phone_no:e.phone_no,contact_name:e.contact_name,status:e.status,sent:e.sent,delivered:e.delivered,read:e.read,replied:e.replied,error_reason:e.error_reason})))}catch(o){console.error("Error fetching report for the broadcast",o)}},handleBroadcast(){this.isScheduled?this.scheduleBroadcast2():this.sendBroadcast()},async scheduleBroadcast2(){const e=this.recipients.split(",").map((e=>{const[t,o]=e.split(":").map((e=>e.trim()));return{name:t,phone:o}})),t=(0,ue.dj)(),o=this.templates.find((e=>e.id===this.selectedTemplateId)),s=o.name,a=this.formatDateTime(new Date),r=`${this.broadcastName} - ${a}`,n=document.getElementById("response"),l=localStorage.getItem("token"),i=this.mediaId,c=this.bodyParameter,d=new Date(`${this.scheduleDate}T${this.scheduleTime}`).toISOString();try{this.popupLoading=!0,this.fetchBroadcastList();const a={name:r,recipients:e,template:s,template_data:JSON.stringify(o),type:"Scheduled",status:"Saved",scheduled_time:d};i&&(a.image_id=i),c&&(a.body_parameters=c);const n=await fetch(`${this.apiUrl}/schedule-template-message/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){const e=await n.json(),o=e.detail||"Unknown error";throw t.error(`Error scheduling broadcast: ${o}`),new Error("Network response was not ok")}t.success("Broadcast scheduled successfully!"),this.popupLoading=!1,this.isSubmitted=!0,this.fetchBroadcastList()}catch(p){console.error("Error scheduling broadcast:",p),n.textContent="Error scheduling broadcast."}},clearForm(){this.popupLoading=!1,this.isSubmitted=!1,this.contact="",this.previewData="",this.broadcastName="",this.selectedTemplateHasParameters="",this.selectedTemplateHasMedia=!1,this.selectedTemplateId="",this.bodyParameter="",this.recipients="",this.selectedTemplate="",this.csvFile=null,this.mediaId="",this.mediafile=null,this.uploadedMedia=!1,this.selectedContacts=[],this.scheduleDate="",this.scheduleTime="",this.isScheduled=!1,this.contacts=[],this.csvUploaded=!1},handleFileUpload(e){this.csvFile=e.target.files[0],this.importCSV()},async importCSV(){const e=(0,ue.dj)();if(!this.csvFile)return;const t=new FormData,o=localStorage.getItem("token");t.append("file",this.csvFile);try{const s=await ae.A.post(`${this.apiUrl}/contacts/bulk_import/`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o}`}});if(s.status>=200&&s.status<300){e.success("Contact created successfully");const{contacts:t,duplicates:o}=s.data;this.contacts=[...t,...o],this.csvUploaded=!0;const a=this.contacts.map((e=>`${e.name}:${e.phone}`)).join(",");this.recipients=this.recipients?`${this.recipients},${a}`:a}else e.error(`Error: ${s.data?.detail||"Unknown error"}`)}catch(s){console.error("Error importing contacts:",s.response?.data?.detail||s.message),e.error(`Error: ${s.response?.data?.detail||"Something went wrong"}`)}},async fiterBytTags(){const e=localStorage.getItem("token"),t=this.tag_value,o=this.tag_key;try{const s=await fetch(`${this.apiUrl}/contacts-filter/filter?tag_key=${o}&tag_value=${t}`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),a=await s.json();if(this.contacts=a.map((e=>({id:e.id,name:e.name,phone:e.phone,email:e.email,tags:e.tags.map((e=>{const[t,o]=e.split(":");return{key:t,value:o}})),created_at:e.created_at,updated_at:e.updated_at}))),!s.ok)throw new Error("Network response not ok")}catch(s){console.error("Error filtering contacts",s)}},selectAll(e){e.target.checked?this.selectedContacts=this.contacts.map((e=>`${e.name}:${e.phone}`)):this.selectedContacts=[]},currentDateTime(){const e=new Date,t=e.getFullYear(),o=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0");this.scheduleDate=`${t}-${o}-${s}`,e.setMinutes(e.getMinutes()+2);const a=e.getHours().toString().padStart(2,"0"),r=e.getMinutes().toString().padStart(2,"0");this.scheduleTime=`${a}:${r}`},async ImportCSV(){const e=(0,ue.dj)();if(!this.file)return;const t=new FormData,o=localStorage.getItem("token");t.append("file",this.file);try{const s=await ae.A.post(`${this.apiUrl}/contacts/bulk_import/`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o}`}});if(s.status>=200&&s.status<300){e.success("Contact created successfully");const t=this.contacts.map((e=>`${e.name}:${e.phone}`)).join(",");this.recipients=this.recipients?`${this.recipients},${t}`:t}else e.error(`Error: ${s.data?.detail||"Unknown error"}`)}catch(s){console.error("Error importing contacts:",s.response?.data?.detail||s.message),e.error(`Error: ${s.response?.data?.detail||"Something went wrong"}`)}}},computed:{totals(){return this.broadcastReports.reduce(((e,t)=>(e.sent+=t.sent?1:0,e.delivered+=t.delivered?1:0,e.read+=t.read?1:0,e.replied+=t.replied?1:0,e.failed+="failed"===t.status?1:0,e)),{sent:0,delivered:0,read:0,replied:0,failed:0})}},watch:{selectedContacts:function(){this.updateRecipients()},selectedContactsAll(e){this.updateRecipients(),this.allSelected=e.length===this.contacts.length},mounted(){}}};const ko=(0,i.A)(fo,[["render",io],["__scopeId","data-v-3cd8a24b"]]);var yo=ko;const vo={class:"content-section m-8 md:ml-72"},wo={class:"overflow-x-auto max-h-[60vh] custom-scrollbar"},xo={class:"w-full border border-gray-300 rounded-lg text-sm md:text-base bg-white"},Lo={class:"p-3 md:p-4 text-center border border-gray-200"},Co={class:"p-3 md:p-4 text-center border border-gray-200"},So={class:"p-3 md:p-4 text-center border border-gray-200"},Eo={class:"p-3 md:p-4 text-center border border-gray-200"},To={class:"p-3 md:p-4 text-center border border-gray-200"},_o={class:"p-3 md:p-4 text-center border border-gray-200"},Ao={class:"p-3 md:p-4 text-center border border-gray-200"},Po=["onClick"];function Do(e,t,o,s,r,n){const l=(0,a.g2)("lord-icon");return(0,a.uX)(),(0,a.CE)("div",vo,[t[1]||(t[1]=(0,a.Lk)("div",{class:"flex flex-col md:flex-row justify-between mb-4 border-b pb-5"},[(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-xl md:text-2xl font-bold text-green-800"},"Scheduled Broadcasts"),(0,a.Lk)("p",{class:"text-sm md:text-base"},"Your content for scheduled broadcasts goes here.")])],-1)),t[2]||(t[2]=(0,a.Lk)("h3",{class:"text-xl md:text-2xs mb-4 text-green-800"},[(0,a.Lk)("b",null,"Scheduled Broadcast List")],-1)),(0,a.Lk)("div",wo,[(0,a.Lk)("table",xo,[t[0]||(t[0]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"ID"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Scheduled Time"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Broadcast Name"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Template"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Contacts"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Status"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.broadcasts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:"hover:bg-gray-50"},[(0,a.Lk)("td",Lo,(0,u.v_)(e.id),1),(0,a.Lk)("td",Co,(0,u.v_)(e.scheduled_time),1),(0,a.Lk)("td",So,(0,u.v_)(e.name),1),(0,a.Lk)("td",Eo,(0,u.v_)(e.template),1),(0,a.Lk)("td",To,(0,u.v_)(e.contacts.length),1),(0,a.Lk)("td",_o,[(0,a.Lk)("div",{class:(0,u.C4)({"bg-green-100 text-green-600 font-semibold px-2 py-1 rounded":"Successful"===e.status,"bg-blue-100 text-blue-600 font-semibold px-2 py-1 rounded":"Scheduled"===e.status,"bg-red-100 text-red-500 font-semibold px-2 py-1 rounded":"Cancelled"===e.status,"bg-yellow-100 text-yellow-500 font-semibold px-2 py-1 rounded":"Partially Successful"===e.status,"bg-yellow-100 text-yellow-600 font-semibold px-2 py-1 rounded":"pending..."===e.status})},(0,u.v_)(e.status),3)]),(0,a.Lk)("td",Ao,[(0,a.Lk)("button",{onClick:t=>n.DeleteScheduledBroadcast(e.id),class:"hover:bg-white rounded-full p-2 transition"},[(0,a.bF)(l,{src:"https://cdn.lordicon.com/skkahier.json",trigger:"hover",colors:"primary:#ff5757,secondary:#000000",style:{width:"32px",height:"32px"}})],8,Po)])])))),128))])])])])}var Io={name:"BroadCast3",data(){return{apiUrl:"http://localhost:8000",broadcasts:[]}},async mounted(){await this.fetchScheduledBroadcastList();const e=document.createElement("script");e.src="https://cdn.lordicon.com/lordicon.js",document.body.appendChild(e)},methods:{async fetchScheduledBroadcastList(){const e=localStorage.getItem("token");try{const t=await fetch(`${this.apiUrl}/scheduled-broadcast`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Network response was not ok");const o=await t.json();this.broadcasts=o.map((e=>({id:e.id,name:e.name.split(" - ")[0],template:e.template,contacts:e.contacts,status:e.status,scheduled_time:e.scheduled_time})))}catch(t){console.error("Error fetching scheduled-broadcastlist:",t)}},async DeleteScheduledBroadcast(e){const t=(0,ue.dj)(),o=localStorage.getItem("token"),s=confirm("Are you sure you want to delete this broadcast?");if(s)try{const s=await fetch(`${this.apiUrl}/broadcasts-delete/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Network response was not ok");t.success("Broadcast deleted successfully"),this.fetchScheduledBroadcastList()}catch(a){console.error("Error fetching contacts:",a)}}}};const Uo=(0,i.A)(Io,[["render",Do],["__scopeId","data-v-2e14e6a8"]]);var Mo=Uo;const jo={class:"content-section m-8 md:ml-72"},Bo={class:"flex flex-col md:flex-row justify-between mb-4 border-b pb-5"},Fo={class:"flex justify-between"},Wo={class:"overflow-y-auto max-h-[70vh] p-6 custom-scrollbar space-y-6"},Xo={class:"flex justify-between items-center space-x-4"},$o=["disabled"],No={key:0},Oo={class:"overflow-y-auto max-h-[30vh] custom-scrollbar"},Ro={class:"w-full table-fixed border border-gray-300 rounded-lg text-sm md:text-base bg-white"},Vo={class:"p-2 text-left border border-gray-200 truncate"},zo={class:"p-2 text-left border border-gray-200 truncate"},Jo={class:"p-2 text-left border border-gray-200 truncate"},Ho={class:"p-2 text-left border border-gray-200"},Go={key:1},Qo={class:"overflow-y-auto max-h-[30vh] custom-scrollbar"},Yo={class:"w-full table-fixed border border-gray-300 rounded-lg text-sm md:text-base bg-white"},qo={class:"p-2 text-left border border-gray-200 truncate"},Ko={class:"p-2 text-left border border-gray-200 truncate"},Zo={class:"p-2 text-left border border-gray-200 truncate"},es={class:"p-2 text-left border border-gray-200"},ts={key:2,class:"flex justify-end"},os=["disabled"],ss={class:"text-xl font-semibold mb-4"},as={class:"p-4 bg-[#f5f6fa]"},rs={class:"mb-4"},ns={class:"mb-4"},ls={class:"flex"},is={class:"mb-4"},cs={class:"custom-scrollbar tags-container-container"},ds={class:"tags-container"},ps=["onUpdate:modelValue"],us=["onUpdate:modelValue"],hs=["onClick"],ms={key:0,class:"text-red-500 text-xs"},gs={class:"flex justify-end pt-4"},bs={type:"submit",class:"bg-green-700 hover:bg-green-600 text-white px-4 py-2 rounded"},fs={class:"p-5 filter-container space-x-2"},ks={class:"flex items-center space-x-2 justify-between"},ys={class:"flex items-center space-x-2 justify-between"},vs={class:"overflow-x-auto max-h-[51vh] custom-scrollbar"},ws={class:"w-full border border-gray-300 rounded-lg text-sm md:text-base bg-white"},xs={class:"p-3 md:p-4 text-center border border-gray-200"},Ls={class:"p-3 md:p-4 text-center border border-gray-200"},Cs={class:"p-3 md:p-4 text-center border border-gray-200"},Ss={class:"p-3 md:p-4 text-center border border-gray-200"},Es={class:"p-3 md:p-4 text-center border border-gray-200"},Ts={class:"font-semibold"},_s={class:"p-3 md:p-4 text-center border border-gray-200"},As={class:"p-3 md:p-4 text-center border border-gray-200"},Ps={class:"flex justify-center space-x-2"},Ds=["onClick"],Is=["onClick"],Us={class:"flex justify-center mt-4"},Ms={class:"flex items-center space-x-4 bg-white shadow-md rounded-lg px-4 py-2"},js=["disabled"],Bs={class:"px-4 py-1 border border-gray-300 rounded text-gray-700 font-semibold"};function Fs(e,t,o,r,n,l){const i=(0,a.g2)("confirmationPopup"),c=(0,a.g2)("PopUp1"),d=(0,a.g2)("lord-icon"),p=(0,a.g2)("PopUpSmall");return(0,a.uX)(),(0,a.CE)("div",jo,[(0,a.Lk)("div",Bo,[t[27]||(t[27]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-xl md:text-2xl font-bold"},"Manage Contacts"),(0,a.Lk)("p",{class:"text-xsm md:text-base"},"Contact list stores the list of numbers that you've interacted with. You can even manually export or import contacts.")],-1)),(0,a.Lk)("div",Fo,[(0,a.Lk)("div",null,[(0,a.Lk)("button",{class:"bg-green-700 hover:bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center",onClick:t[0]||(t[0]=e=>n.showPopup=!0)},t[20]||(t[20]=[(0,a.Lk)("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),(0,a.eW)(" New Contact ")]))])]),n.showConfirmPopup?((0,a.uX)(),(0,a.Wv)(i,{key:0,onYes:t[1]||(t[1]=e=>l.deleteContact(this.selectedContact)),onNo:t[2]||(t[2]=e=>n.showConfirmPopup=!1),onClose:t[3]||(t[3]=e=>n.showConfirmPopup=!1)})):(0,a.Q3)("",!0),n.showPopupimport?((0,a.uX)(),(0,a.Wv)(c,{key:1,onClose:t[7]||(t[7]=e=>l.closePopupimport())},{default:(0,a.k6)((()=>[t[25]||(t[25]=(0,a.Lk)("h2",{class:"text-xl font-semibold mb-4"},"Bulk Import Contacts",-1)),t[26]||(t[26]=(0,a.Lk)("hr",{class:"mb-4 border-gray-300"},null,-1)),(0,a.Lk)("div",Wo,[(0,a.Lk)("div",Xo,[(0,a.Lk)("input",{type:"file",onChange:t[4]||(t[4]=(...e)=>l.onFileChange&&l.onFileChange(...e)),accept:".csv"},null,32),(0,a.Lk)("button",{disabled:!n.file,onClick:t[5]||(t[5]=(...e)=>l.uploadFile&&l.uploadFile(...e)),class:"h-8 w-24 border-2 border-green-500 text-green-500 hover:text-white hover:bg-green-500 transition duration-200"}," Upload ",8,$o)]),n.duplicates.length?((0,a.uX)(),(0,a.CE)("div",No,[t[22]||(t[22]=(0,a.Lk)("h4",{class:"text-green-700 font-semibold mb-2"},"Duplicate Contacts",-1)),(0,a.Lk)("div",Oo,[(0,a.Lk)("table",Ro,[t[21]||(t[21]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[20%]"},"Name"),(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[30%]"},"Email"),(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[20%]"},"Phone"),(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[30%]"},"Tags")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.duplicates,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",Vo,(0,u.v_)(e.name),1),(0,a.Lk)("td",zo,(0,u.v_)(e.email),1),(0,a.Lk)("td",Jo,(0,u.v_)(e.phone),1),(0,a.Lk)("td",Ho,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.tags,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"truncate",key:t},(0,u.v_)(t)+": "+(0,u.v_)(e),1)))),128))])])))),128))])])])])):(0,a.Q3)("",!0),n.importcontacts.length?((0,a.uX)(),(0,a.CE)("div",Go,[t[24]||(t[24]=(0,a.Lk)("h4",{class:"text-green-700 font-semibold mb-2"},"New Contacts",-1)),(0,a.Lk)("div",Qo,[(0,a.Lk)("table",Yo,[t[23]||(t[23]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[20%]"},"Name"),(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[30%]"},"Email"),(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[20%]"},"Phone"),(0,a.Lk)("th",{class:"p-2 border border-gray-300 sticky top-0 z-10 bg-gray-100 w-[30%]"},"Tags")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.importcontacts,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",qo,(0,u.v_)(e.name),1),(0,a.Lk)("td",Ko,(0,u.v_)(e.email),1),(0,a.Lk)("td",Zo,(0,u.v_)(e.phone),1),(0,a.Lk)("td",es,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.tags,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"truncate",key:t},(0,u.v_)(t)+": "+(0,u.v_)(e),1)))),128))])])))),128))])])])])):(0,a.Q3)("",!0),n.importcontacts.length?((0,a.uX)(),(0,a.CE)("div",ts,[(0,a.Lk)("button",{disabled:!n.file,onClick:t[6]||(t[6]=(...e)=>l.ImportCSV&&l.ImportCSV(...e)),class:"h-8 w-24 border-2 border-green-500 text-green-500 hover:text-white hover:bg-green-500 transition duration-200"}," Import ",8,os)])):(0,a.Q3)("",!0)])])),_:1,__:[25,26]})):(0,a.Q3)("",!0)]),n.showPopup?((0,a.uX)(),(0,a.Wv)(p,{key:0,onClose:l.closePopup},{default:(0,a.k6)((()=>[(0,a.Lk)("h2",ss,(0,u.v_)(n.isEditing?"Edit Contact":"Add Contact"),1),t[32]||(t[32]=(0,a.Lk)("hr",{class:"mb-4 border-gray-300"},null,-1)),(0,a.Lk)("form",{onSubmit:t[13]||(t[13]=(0,s.D$)(((...e)=>l.submitForm&&l.submitForm(...e)),["prevent"])),id:"contactForm",class:"w-[400px] bg-white"},[(0,a.Lk)("div",as,[(0,a.Lk)("div",rs,[t[28]||(t[28]=(0,a.Lk)("label",{for:"name",class:"block text-sm font-medium"},[(0,a.eW)("Name"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=e=>n.contact.name=e),id:"name",placeholder:"Name",required:"",class:"border border-gray-300 rounded px-3 py-2 w-full"},null,512),[[s.Jo,n.contact.name]])]),(0,a.Lk)("div",ns,[t[30]||(t[30]=(0,a.Lk)("label",{for:"phone",class:"block text-sm font-medium"},[(0,a.eW)("Phone Number"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.Lk)("div",ls,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>n.contact.countryCode=e),class:"border border-gray-300 rounded-l px-3 py-2 w-20 mr-2"},t[29]||(t[29]=[(0,a.Lk)("option",{value:"1"},"+1",-1),(0,a.Lk)("option",{value:"44"},"+44",-1),(0,a.Lk)("option",{value:"91"},"+91",-1)]),512),[[s.u1,n.contact.countryCode]]),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=e=>n.contact.phone=e),id:"phone",placeholder:"Phone Number",required:"",class:"border border-gray-300 rounded-r px-3 py-2 w-full"},null,512),[[s.Jo,n.contact.phone]])])]),t[31]||(t[31]=(0,a.Lk)("label",{for:"email",class:"block text-sm font-medium"},"Email",-1)),(0,a.bo)((0,a.Lk)("input",{type:"email","onUpdate:modelValue":t[11]||(t[11]=e=>n.contact.email=e),id:"email",placeholder:"Email",class:"border border-gray-300 rounded px-3 py-2 mb-2 w-full"},null,512),[[s.Jo,n.contact.email]]),(0,a.Lk)("div",is,[(0,a.Lk)("div",cs,[(0,a.Lk)("div",ds,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.contact.tags,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"tag-input",key:t,style:{display:"flex","align-items":"center"}},[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.key=t,placeholder:"Key",required:"",class:"border border-gray-300 rounded px-3 py-2 mb-2 w-full",style:{width:"60%"}},null,8,ps),[[s.Jo,e.key]]),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.value=t,placeholder:"Value",required:"",class:"border border-gray-300 rounded px-3 py-2 mb-2 w-full",style:{width:"60%","margin-left":"10px"}},null,8,us),[[s.Jo,e.value]]),(0,a.Lk)("button",{type:"button",onClick:e=>l.removeTag(t),class:"hover:bg-gray-100 rounded-full p-2 transition"},[(0,a.bF)(d,{src:"https://cdn.lordicon.com/skkahier.json",trigger:"hover",colors:"primary:#ff5757,secondary:#000000",style:{width:"32px",height:"32px"}})],8,hs),n.warningData?((0,a.uX)(),(0,a.CE)("span",ms,(0,u.v_)(n.warningData),1)):(0,a.Q3)("",!0)])))),128))])]),(0,a.Lk)("button",{type:"button",onClick:t[12]||(t[12]=(...e)=>l.addTag&&l.addTag(...e)),class:"text-black p-2 text-small border border-black hover:bg-gray-200"},"+ Add Tag")])]),(0,a.Lk)("div",gs,[(0,a.Lk)("button",bs,(0,u.v_)(n.isEditing?"Update Contact":"Add Contact"),1)])],32)])),_:1,__:[32]},8,["onClose"])):(0,a.Q3)("",!0),(0,a.Lk)("div",fs,[t[35]||(t[35]=(0,a.Lk)("h3",{class:"text-xl md:text-2xs mb-0 text-gray-600"},[(0,a.Lk)("b",null,"Contact List")],-1)),(0,a.Lk)("div",ks,[(0,a.Lk)("div",ys,[t[33]||(t[33]=(0,a.Lk)("h3",{class:"text-l"},[(0,a.Lk)("b",null,"Filter by tags:")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[14]||(t[14]=t=>e.tag_key=t),placeholder:"Key",class:"border border-gray-300 rounded px-3 py-2 w-40px"},null,512),[[s.Jo,e.tag_key]]),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=t=>e.tag_value=t),placeholder:"Value",class:"border border-gray-300 rounded px-3 py-2 w-40px"},null,512),[[s.Jo,e.tag_value]]),(0,a.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>l.fiterBytTags&&l.fiterBytTags(...e)),class:"relative my-2 h-auto w-auto p-2 bg-green-700 hover:bg-green-600 text-white"},"Apply filter")]),(0,a.Lk)("div",null,[(0,a.Lk)("button",{onClick:t[17]||(t[17]=e=>n.showPopupimport=!0),class:"bg-green-600 hover:bg-green-600 text-white px-4 py-2"},t[34]||(t[34]=[(0,a.Lk)("i",{class:"bi bi-download"},null,-1),(0,a.eW)(" Import CSV ")]))])])]),(0,a.Lk)("div",vs,[(0,a.Lk)("table",ws,[t[36]||(t[36]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"ID"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Name"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Phone Number"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Email"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Tags"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Created At"),(0,a.Lk)("th",{class:"p-3 md:p-4 border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.contacts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:"hover:bg-gray-50"},[(0,a.Lk)("td",xs,(0,u.v_)(e.id),1),(0,a.Lk)("td",Ls,(0,u.v_)(e.name),1),(0,a.Lk)("td",Cs,(0,u.v_)(e.phone),1),(0,a.Lk)("td",Ss,(0,u.v_)(e.email),1),(0,a.Lk)("td",Es,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.tags,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.Lk)("span",Ts,(0,u.v_)(e.key)+":",1),(0,a.eW)(" "+(0,u.v_)(e.value),1)])))),128))]),(0,a.Lk)("td",_s,(0,u.v_)(l.formatDate(e.created_at)),1),(0,a.Lk)("td",As,[(0,a.Lk)("div",Ps,[(0,a.Lk)("button",{onClick:t=>l.modifyContact(e),class:"hover:bg-white rounded-full p-2 transition"},[(0,a.bF)(d,{src:"https://cdn.lordicon.com/wuvorxbv.json",trigger:"hover",style:{width:"32px",height:"32px"}})],8,Ds),(0,a.Lk)("button",{onClick:t=>l.showConfirmationPopup(e.phone),class:"hover:bg-white rounded-full p-2 transition"},[(0,a.bF)(d,{src:"https://cdn.lordicon.com/skkahier.json",trigger:"hover",colors:"primary:#ff5757,secondary:#000000",style:{width:"32px",height:"32px"}})],8,Is)])])])))),128))])])]),(0,a.Lk)("div",Us,[(0,a.Lk)("div",Ms,[(0,a.Lk)("button",{class:"px-3 py-1 bg-green-600 text-white font-medium rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",onClick:t[18]||(t[18]=(...e)=>l.loadPreviousPage&&l.loadPreviousPage(...e)),disabled:1===n.currentPage}," Previous ",8,js),(0,a.Lk)("div",Bs,(0,u.v_)(n.currentPage),1),(0,a.Lk)("button",{class:"px-3 py-1 bg-green-600 text-white font-medium rounded hover:bg-green-600",onClick:t[19]||(t[19]=(...e)=>l.loadNextPage&&l.loadNextPage(...e))}," Next ")])])])}o(531);const Ws={class:"fixed inset-0 bg-black bg-opacity-20 flex justify-center items-center p-5 z-[10000] text-left shadow-lg"},Xs={class:"bg-[#ffffff] p-6 rounded-md"},$s={class:"flex"};function Ns(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",Ws,[(0,a.Lk)("div",Xs,[(0,a.Lk)("div",$s,[(0,a.Lk)("span",{class:"close",onClick:t[0]||(t[0]=t=>e.$emit("close"))},"×")]),(0,a.RG)(e.$slots,"default",{},void 0,!0)])])}var Os={name:"PopUpSmall"};const Rs=(0,i.A)(Os,[["render",Ns],["__scopeId","data-v-08c6aebc"]]);var Vs=Rs,zs={components:{PopUp1:bo,PopUpSmall:Vs,confirmationPopup:Ee},async mounted(){await this.fetchContactList();const e=document.createElement("script");e.src="https://cdn.lordicon.com/lordicon.js",document.body.appendChild(e)},name:"ContActs1",data(){return{apiUrl:"http://localhost:8000",currentPage:1,showPopup:!1,showPopupimport:!1,showActionPopup:!1,showConfirmPopup:!1,file:null,importcontacts:[],duplicates:[],contact:{id:"",name:"",email:"",phone:"",countryCode:"",tags:[],tag_key:"",tag_value:""},selectedContact:null,contacts:[],isEditing:!1,searchQuery:"",selectedTag:null,sortBy:"updated_at",order:"desc",searchTerm:"",warningData:""}},computed:{filteredContacts(){const e=this.searchQuery.toLowerCase(),t=this.searchTerm.toLowerCase();return this.contacts.filter((o=>{const s=o.phone.toLowerCase().includes(e),a=o.name.toLowerCase().includes(t),r=!this.selectedTag||o.tags.some((e=>e.key.toLowerCase()===this.selectedTag.toLowerCase()));return(s||a)&&r}))},uniqueTags(){const e=this.contacts.flatMap((e=>e.tags.map((e=>e.key))));return[...new Set(e)]},formattedTags(){return this.contacts.map((e=>({...e,formattedTags:e.tags.map((e=>`${e.key}: ${e.value}`)).join(", ")})))}},methods:{showConfirmationPopup(e){this.selectedContact=e,this.showConfirmPopup=!0},async loadNextPage(){const e=this.contacts[0]?.id;await this.fetchContactList(this.currentPage+1);const t=this.contacts[0]?.id;e!==t&&this.contacts.length>0&&(this.currentPage+=1)},async loadPreviousPage(){this.currentPage>1&&(this.currentPage-=1,await this.fetchContactList(this.currentPage))},async submitForm(){const e=(0,ue.dj)(),{id:t,name:o,email:s,phone:a,countryCode:r,tags:n}=this.contact;let l=a;if(r&&""!==r.trim()&&(l=`${r}${a}`),n.some((e=>""===e.key||""===e.value)))return void(this.warningData="Please enter key and value for all tags");const i=n.map((e=>`${e.key}:${e.value}`)),c=t?`${this.apiUrl}/contacts/${t}`:`${this.apiUrl}/contacts/`,d=t?"PUT":"POST",p=localStorage.getItem("token");try{const a=await fetch(c,{method:d,headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"},body:JSON.stringify({name:o,email:s,phone:l,tags:i})});if(a.ok)e.success(t?"Contact updated successfully":"Contact created successfully"),this.clearForm(),this.fetchContactList();else{const t=await a.json();e.error(`Error: ${t.detail}`)}}catch(u){console.error("Error saving contact:",u),e.error("Error saving contact")}},clearForm(){this.contact={id:"",name:"",email:"",phone:"",tags:[]},this.showPopup=!1},closePopup(){this.showPopup=!1,this.clearForm()},formatDate(e){const t={year:"numeric",month:"short",day:"numeric"},o=new Date(e);return o.toLocaleDateString("en-US",t).replace(/,/g,"")},async fetchContactList(e=1){const t=localStorage.getItem("token"),o=10,s=`${this.apiUrl}/contacts/?sort_by=updated_at&order=desc&limit=${o}&offset=${(e-1)*o}`;try{const e=await fetch(s,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Network response was not ok");const o=await e.json();if(console.log(o),0===o.length)return;this.contacts=o.map((e=>({id:e.id,name:e.name,phone:e.phone,email:e.email,tags:e.tags.map((e=>{const[t,o]=e.split(":");return{key:t,value:o}})),created_at:e.created_at,updated_at:e.updated_at})))}catch(a){console.error("Error fetching contacts:",a)}},async fiterBytTags(){const e=localStorage.getItem("token"),t=this.tag_value,o=this.tag_key;try{const s=await fetch(`${this.apiUrl}/contacts-filter/filter?tag_key=${o}&tag_value=${t}`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),a=await s.json();if(this.contacts=a.map((e=>({id:e.id,name:e.name,phone:e.phone,email:e.email,tags:e.tags.map((e=>{const[t,o]=e.split(":");return{key:t,value:o}})),created_at:e.created_at,updated_at:e.updated_at}))),!s.ok)throw new Error("Network response not ok")}catch(s){console.error("Error filtering contacts",s)}},closeActionPopup(){this.showActionPopup=!1,this.selectedContact=null},modifyContact(e){this.isEditing=!0,this.selectedContact=e,this.contact={...this.selectedContact},this.showPopup=!0,this.closeActionPopup()},async deleteContact(e){const t=(0,ue.dj)();this.showConfirmPopup=!1;const o=localStorage.getItem("token");try{const s=await fetch(`${this.apiUrl}/contacts/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(s.ok)t.success("Contact deleted successfully"),this.fetchContactList(),this.closeActionPopup();else{const e=await s.json();t.error(`Error: ${e.detail}`)}}catch(s){console.error("Error deleting contact:",s),t.error("Error deleting contact")}},addTag(){this.warningData="";const e=this.contact.tags[this.contact.tags.length-1];0===this.contact.tags.length||""!==e.key&&""!==e.value?this.contact.tags.push({key:"",value:""}):this.warningData="Please enter key and value for the previous tag"},removeTag(e){this.contact.tags.splice(e,1)},filterContacts(){this.fetchContactList()},onFileChange(e){this.file=e.target.files[0]},async uploadFile(){if(!this.file)return;const e=new FormData,t=localStorage.getItem("token");e.append("file",this.file);try{const o=await ae.A.post(`${this.apiUrl}/contacts/csv/`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${t}`}});this.importcontacts=o.data.contacts||[],this.duplicates=o.data.duplicates||[]}catch(o){console.error("Error importing contacts:",o.response?.data?.detail||o.message)}},async ImportCSV(){const e=(0,ue.dj)();if(!this.file)return;const t=new FormData,o=localStorage.getItem("token");t.append("file",this.file);try{const s=await ae.A.post(`${this.apiUrl}/contacts/bulk_import/`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o}`}});s.status>=200&&s.status<300?(e.success("Contact created successfully"),this.fetchContactList()):e.error(`Error: ${s.data?.detail||"Unknown error"}`)}catch(s){console.error("Error importing contacts:",s.response?.data?.detail||s.message),e.error(`Error: ${s.response?.data?.detail||"Something went wrong"}`)}},closePopupimport(){this.showPopupimport=!1,this.file=null,this.importcontacts=[],this.duplicates=[]}}};const Js=(0,i.A)(zs,[["render",Fs],["__scopeId","data-v-585e2e5c"]]);var Hs=Js;const Gs={class:"content-section m-8 md:ml-72"};function Qs(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",Gs,t[0]||(t[0]=[(0,a.Lk)("h2",null,"Coming Soon...",-1),(0,a.Lk)("p",null,"Your content for scheduled broadcasts goes here.",-1)]))}var Ys={name:"ContActs2",data(){},methods:{}};const qs=(0,i.A)(Ys,[["render",Qs],["__scopeId","data-v-bddb01b2"]]);var Ks=qs,Zs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAADmCAMAAACJZRt4AAAA21BMVEW7or339/ebXI8AAAD///+aWY2/pcG8pL+qf6W0lLO5oLu6oL36+/qVUIi4nbuGdIedYZOldJ6YVYsdGR15aXtJP0rDqcWMeY317/Szm7WeiaD5+/epkqtaTltrXWzt4+vDoLzs7OfQtsvn2eSgi6ItJy7x9Ovf3Nq6pbijaZhYTFmVgZbKvsXBtLri4du6qLW2i67cydkxKjEUERRlV2Y/N0DUzNDAtLeocp3Tus7p3ecZFRnh3d2/q73NxsS9rbbk6dnV1crTz8nPw83KwsPJusjj6tfo5eXMycIreKuYAAAS2klEQVR4nO2deV/aSheAQQzRJESNGEAoiFXA4oIbtbcuba992+//id7ZzmSyzwwBwv15/mgNCck8OetMhkml+h+WyrobsEz5gNtU+YDbVPmA21T5gCtGHCaru+Ky4TBNdzT88fw8/vnzFsmvnz+fB/8bDkcr4FwinOOMhs+/Xn/fWB2Xio2E/dmxJlfv8zFhXFoLlgOHtPVnfHllUaBKolBQ6+1y/me0JMDi4ZDC/swxVxpVlBERXs2flwFYMJzTHY6vJpJcIiJS4XzYLZivSDjHGc5fLHUy4HMn79eF8hUH54zmL66rxcX5bHcyHxZnnwXBOd3x1YJknO9tPCoIrxA4Z/h64+oZY5Ig8xx2i2hXAXDO8NIqEA0LUt91AXgLwznXXwsmA7zxwsFlQTjn+WUZaBRv8ryg9haCc4Zfiwgi6XgLGucCcM7ocllaC/BurhewTW04p/u6bDSK9z7UxtOF644ny7RIEa8z17VNPThneLUKtTFxb/7oKU8Lrju2VodG8F61lKcB5wx/r8giBboXHc9Th3PGk9WqjUpHQ3nKcN33FXqbKO7VaMlwzuht5SYJYk9Uc54anHO94kgSpnN/qdEpwTm/1qY2Ku67kuOpwCF3Wy8bontTcTwFuDW6WyD25Ie8aUrDOcO1ZICY2JZ8WJGFKwsbrjV/ytJJwq03TEbEnUvSycGVig3RSaYEKbiSsUnTycCVjk2WTgLO+bOmajJLpPxOAm7UKR8bopPId/lwpckBEenk57tcuNFNOdlQvsutxPLgui8lZUN0leFicM76a+V0sd9y+gjZcGvv42SL+57tdtlw16Vmy013mXBlDZSBdK514bpvZWdD3buskJkBV3KHo2J/zQgqGXBldzgqWW6XDtctvcNRsYbqcKXOcKLYN6mGmQq3GUaJJd0w0+A2xSixpBpmCpzzKq04czmiAGdfpRhmCtxQks20d3eWIbuuCp47TjbMZDjJ9G3aO/vGcmTrwJWns63kVJ4I54ylFGfu7htbyxJjayZPl1JBJ8LJRRNzd2t5bEg8BbrOUBZOLpqY9v4y0ZAYu9Jw9lWS6pLgRhOZ85k7knrzGl5DS8XGhYJhJnUPEuCcf6WM0mYtyGu3NxtUB7OGFp2C6l4SVJcAN7RkzmbOMJXRuDjY9zIbONvGspt5UNp3DxRUN5aBk1MctUrjaYAa7mc1vNEmcG0duC0Fu0xSXRxOTnEV8wDD0ZYfpJsmU9z2No8+hud5ybZsGNE9+9JsSHXP+XDOX7niBMMZO7Thp+lqaXymh7RZo73GxezkZPfJi33FazyhPbOLhrBHBS6h2xqD60o+9CBwu7Tlt6nhwnhiivtGm9yYAezpVgjP8E4GdM/gxOPaU4GruMM8OOmxBVFzgzAcsjtouHfK4C5I+PFut7lUxQjqXQyCPYMnTwfOjpUpUTjpEWYCdxG2OQBqt8FQGwNBt8a+QIDkhNN5B1VxR/XA04CLd32icNJ9VBJQvLagFyYNop0T0jyg3yZ5wwuzbW9DGWBcVMM72qxoVYOLPdaKwDlXsn1UAgfhQihWWHhsE614J0wVBqcOMTAFxajBi9Xg7Ek3E04yD3C4b8zAguAAhngh8nxu4EolSgDfa5zG99DbpQYXq8HCcApDldQsmWa+Bd4DCNQQ2wEE/I1Qv8GfRHXcdpHCbsE+qeoU4eyvTgacwgMrmsRZuPynEVUcyX282U8Gvw/b1Z1GA8yZpH9uroOLRmOLcVc1zBKFlFEGnOzoAofbFzRAFLfL1dMIypO2qLgdL/gevgX8DrRx9zCseVW4yHhDCM55lR/yInCxcNngtkeATjkob7TfCEIq3QMet+OJqicFqypcpFsXglMZz6NwYF8zqjpue9QUYS/SD9AMPDGm4k24PyxAQnQhm6pwEbsMwakMxDK4b8J9FhVHggi0G5kY/Mm6PoE98wLtyQhhf9aCCw/QinDOXGEglpnliXjbRcWh1nHPujAAoQoJ0aNhsW3Adz6zmARH6sHZb2lwXZWJCxTOOBCtzRMLjbYBO6seDzS8xAY4D+wVUuVicBV3lAI3Unk8YLJOHOPB3TXP3xZlpwGOFUQNnu0DOOaX0CeE7KILN06BU3rYyOAguJF+ebhC/NbwubpAPzNA2AduOAEMgYLP6QWUcNdAgHN+qzz7ADjWahRReEyHLhvsw8Eyqh8eNlikCZzxlJ9QC26SDNeVGtGLwAURxQALHfC6hBHtBnBPRhjhNAbX+IfpWA8u5HQCnEJ5EsCBiyDnAcXtgqWdDri6eD6MJPuZATmCmSWvV/Z1KpRK2OkCOMXn+xBQtlhjLiDuIzdimO2g3YL1ilZZ3Tc8wWmFHD7QKZyx2JdOEty70uNGgAM1zb6B4oK8zAjChZj4JbTJqxiyh9s27crrwAlPkQU4tSlsHI7pBDoruKYEv2Gf4BIaCmrazQMLRo4FNQ6tvXl34UKnP0dEcLoATinLBXChqmSbdd1Cn+H+EHclFB4D78RARlBRGzyj6/XEGdx1ApziE36AE7qaoKYgtQemyPt5tzswugcpHY493TnhpemBzhgKgwtGUjicM9eDCxXLfODgm/AR0UJUwYIlxoZWgipNB06IKAHcpdr0hQDuNtbesDrpGITRjhKwABkJP1iqUK5owd0kwL2pnYPDhXQCtaNITANf0EfnnzP1hNRMZKY1KAsSjIFxONWJJxxOvPN8uEFUHfT1Igyfg0GlyMiez/dowQXD6hxOMVgGcKLTBUN8wnCdn6DN0PMFYytEF7Bpwj3H4NSKrxAcV0lbHP1vR+G2Grv8s+qJcOiW4Z3y8DrYEfbowfFwyeFU53oFcFBeCr4S+jR4Nul5s9tBu92+PTEiT7C8/ZNbtGNwOws929KCs1+jcKqZQIDjSvosaiMwTPHpndFoGChXx5/n4Q/je/Tgfsfg/ipOZBMmMzC7rEam3AhjX5qiMp1BgONPITmcUk8Vy64RtCFmlORjg8YJ2SkdCXA7WnCTqOa60o93uARzbMjgSXw2hrH/z3bWY9d8OIX5XyJcTHPKM9FNQVPezL9IMD7Dm52eaBul0kwNUfiMdQ5nKmvOfArszfCSbc+IP9iXZ9u39eDcaJ7TmBlrVi60vUmGbWtXjy3o0QHcSGPar1k5yJ0cpY3mXWg5HIH7EYW70TmNuXuwJT8/NNT4nGOfZkozgcNw/4tWKB29E5kVdzdLOsGfohEbO5nf2rX10YS+OIfTnmmf3QqTW4RpzoIsbzxlfm0BMiTuwCkKLkfswN7Nyg6fW6uXwuRkdXAhMV0IQXrFh5zE4TR9TlFME1xPqyaWE/dPIdFSR5jrebpZLF9i0VInz2kKdb2ckLKIxPLcSn+7Y7o7KJctLaTEKhSN2nIBMU33yVtaSInVluq9ggUFRZZlXTHW5dHozy0oZkV6Ep2a2PEuj3JPvLQS74krj6GUVxLGUFRHv8or8dGvDfqNap7Exy3/Q3AJI86qzwrKK8F8BuEpT/7X6nXTstC/dMus1y3LqvtmsJsK7A02wltsg3yvHvoRLpwh0lVFX6jQC8N5gjMnwA1jcPnP5/xO8+iwVrs/fyDn9c8+nddqtcOjFutb1nt7VHAHw5yyDZLMzDNhy2yxDRN/pxXIcR2+1DruBI0362f9u/ta7fvdtA5fhcskScLzubwnq6b1UGNy7uPNI9isHU59Atdn2y3catjZw42sw3enaMuCXYi03qwF8sl/DDYe96hq0U28g8+a/r1w+Fly+Zb4ZDU7F9R7wXkRnNkRL1Pbw3T1T2wLadbswS6MU/HhTjTRrmOBOwJ3JGzV7jrkq8IRTf9Q2N9LgUt4Jp4dLs0z4awIrn5eC8kxuhC/73eo0Xucm7QQDj/yBZ5pNlztHhme3xc+kIJLms2QHS474kXP/VCbyEcIoc6vbFV80GKtT3yHt9cMtIi5M+FqX/x6S9wOw6WYZeI8lKx5sv4XdsLHvWmr/6kOjW11jplOsJ8Jlw1aceSH7g263dyg+xzuqIllyuCOrSk7a4f756fWdO9hj522ieNJMyWgJM4gyogo3IP2/DoOxuaUbk79er3DGQKCvXrw950fMupWnXujYKNNnwR3gDPhoDOm2O89cmGTGUcnIxUI8URu1h7EwabPtmnwOyTuxPYJgQLZ15T/Xavj4M+3+j73RuKbTdAhMRCAAxMHDfYYCcClmljarL2MR/7+XQBDtmno+EJi5BSuTwjO8aHnNMQdQUsowt050dZDsKsS1hyHQ0mA6RnuCNxlBudDDRCX5PmWGTUKs/w+wLFrNMk2s6ApBXokiqyQVlIdIb+nmj7C/96TG/W9ybgZ3GOz3+83TQZ35veojx8yOB4X2YUf0NEPafFkmAiX3l9lHjSF05l0m0R5IG/RAHlEFNnDjbij2C0IkA+kqb3gKMQtRss7n8GdQzTaYybM3asuRMtWIlzoN3QiXJrTgXsf89OJcLBBbfUTYSVNfuiAfmma6/f4ruYZa18iHMgXlsDvfd6SfLjL5Anc6U4HlsfN8j5Jc+TCfQJCYFp0zyef8e+R4om47zFwZ8EFexXgUn9XkDp2aYU0hcxS9DmwWSDgJWjP/I7/e4QkMeXZsmYBtwh3DnDsDBVe5/CRJAm4tF+EpM5yZuc8gjvIoiUJMJDDzoAAwv5hvU609N1nhxzzLPDom/f0fwb30MPCo+U5u3dw7lYkkp11Op1e4thZ+m95UstLKKYgarESmcDyu0vT3JkJ+fsTKKLCaqgerwX6dVqbHoLh9X2SlAFuD1THTOYumgrS+3Kpv8JKtUuoSM4tclaTJeV7An7Ert9i12VJERkxuyc9nwd+VnlNIehbiUl8ys0eDLlPesToBuQlcTf993PpdskqhcOWVTc7x1Bd9X0frLDJKhWL9916EAqnFPI+KFE7lQh308cC5RdLmbVD1E1luj46q9QrvZ6YxBO195b+y8dUuzSDcurwsHboQyvvHqCb02EEJtRa97zfs0fbfM4/wF2mfhjjDksf4OoWVXGrHsSg+8N73is4x3KY0OWJLN4W+bVxWrwMYiBpXD3UBaI6fGQELDbiqnjK9pEmoajJnO7BD7jFLs8XDsd0js5miZ2c3C5PZAGDyO/EU5dW4t1sduf3aqI8QnrAMYbaMO5zn7E2s/8gQaIgbgJ3MlxQE5kdgScPLrrMkvQv/IWMhMdQQq16RIEmyNjU6fClaRPv6C4cNKiV9Tj3URoc82DcbxAGa/Lgokv1yK/N4PfANA9xZPbP4KLfm/gqPU5AnY5YCT2A7sIpnyj8HB/OuNPgQHVk+GIKjp0Dl7c2QzVjrba6XzneQ8V7i0Zi0++0UDG/d8ziloWlAn9Wgs+s3F0gwknqcAC90hRdqTkNHx5roJ2zqkbO42OzHupIRTaXKGbmMCyT2FI22ivZlE/yV7Kpjpb0vHP5El+0LWH1qA19CpmwhGfCul8bapcy634p/xyrLPISX3tVe629skmC4vRXSSybJCgueX3L1czgK1Rk17dUWee4LJL80okF1pQtk8TX2UuFk1wNuDwSGq3Mgat2X9bdXDVRWcd502alpC0Nn7Z2utpCDeuV1FfYpK16v8JpwQuL6qr3mxRT3Ndko8x4GUN3Y0pMjTdNbIxhJqe4HDhnMyJm1lv2st7LswlVWOpbJnLg1FZwW4/YGS+u2fh3YbmZrw/MhCu92y3yFrOyu13yKxhk4dbwWwoFsV9y3vqYA1fqdz5mBhMZuBLn8s6PvLbnwlWHpXv3L5W0Nw0pwTk/yvmGXIm3iufDVZ3nEobMot5tXMbuT3o3RxWufHTua87rYxXgykYnySYJh+nKE1Wk/E0BDpWZpYmZku+4V4CrOiXJd7ZEflOGK8mbxW0r/x3pOnDV6tXaw4p9M5RnU4Prrvvdq27WoMKCcFXn5zqDpi2bAvTgUFhZn+PZEwV304FDYeXrmkzTVXI3Pbhq99c6Mp7tvquZpB4cMs2XlStP3SQ14ZDy5qtVnu1e5oyWFAiH48oKledO5IuSAuCw8lZVjdkdDW9bDA4p730lOc+9Ug6Si8NhvLdl26btvugEkgLgcD9oqXi2e/NL1yIXh0Ou9zxZlnHarjUfLaC2xeGqjjN+WwqeO/lVXQxtcTgk3evC8ZCvjbuLohUCh/CG753inM92O1fXBaAVBIesczRH6itCfyiKLOpqXAqCw843fJ8syoeCyGUxSiNSGBwSp3v9r37wtDFZEZ4WSJFwVcw3nN9YyoAIrPPyb4E6o1IwXBXzjcaXb5YraaI21tjN5fOwaLLqMuCwYMD51Q0lTGG0sb5ca/J7Pl4GGJblwGFxEOH18/z9ZWIhSBdzUiEbljV5ufp3fI24lgOGZXlwVBBidzT88+N5/uvv399IXv/+mn/+8Wc46iKs5XERWTYcF0eQVV1zZXDrkA+4TZUPuE2VD7hNlQ+4TZUPuE2VD7hNlf803P8BZe/+DifgjWwAAAAASUVORK5CYII=";const ea={class:"content-section m-8 md:ml-72"},ta={class:"flex flex-col md:flex-row justify-between mb-4 border-b pb-5"},oa={class:"flex-col md:flex-row justify-between mb-4 border-b pb-5"},sa={class:"woocommerce-card p-4 bg-[#f8f9fa] rounded-lg shadow-md max-w-sm pb-5"},aa={class:"text-sm font-medium text-gray-500 mb-2"},ra=["disabled"],na=["disabled"],la=["disabled"],ia=["disabled"],ca={key:0,class:"flex justify-end pt-3 items-center justify-between"},da={key:1,class:"flex justify-end pt-3 items-center justify-between"},pa={class:"popup-content custom-scrollbar p-4"},ua={key:0},ha=["value"],ma={key:0},ga={key:0},ba={key:1},fa=["onUpdate:modelValue"],ka=["value"],ya=["onClick"],va={style:{color:"gray",fontSize:"12px"}},wa={key:1},xa=["value"],La={key:0},Ca={key:0},Sa={key:1},Ea=["onUpdate:modelValue"],Ta=["value"],_a=["onClick"],Aa={class:"bg-[#f5f6fa] items-center space-x-2 p-2 justify-between"},Pa={class:"flex items-center"},Da={class:"mr-2"},Ia={class:"flex justify-between items-center mt-4"},Ua=["onClick"],Ma={class:"bg-[#f5f6fa] items-center space-x-2 p-2 justify-between"},ja={class:"flex items-center space-x-2"},Ba={class:"mb-4"},Fa={class:"mb-4"},Wa={class:"bg-[#f5f6fa] items-center space-x-2 p-2 justify-between"},Xa={style:{color:"gray",fontSize:"12px"}},$a={class:"bg-[#f5f6fa] items-center space-x-2 p-2 justify-between"},Na=["disabled"],Oa={key:0,class:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 mr-2"},Ra={class:"overflow-x-auto max-h-[32vh] custom-scrollbar"},Va={class:"w-full border border-gray-300 rounded-lg text-sm md:text-base bg-white"},za={class:"p-3 md:p-4 text-center border border-gray-200"},Ja={class:"p-3 md:p-4 text-center border border-gray-200"},Ha={class:"p-3 md:p-4 text-center border border-gray-200"},Ga={class:"p-3 md:p-4 text-center border border-gray-200"},Qa={class:"p-3 md:p-4 text-center border border-gray-200"},Ya={class:"flex justify-center"},qa=["onClick"];function Ka(e,t,o,r,n,l){const i=(0,a.g2)("PopUp1"),c=(0,a.g2)("vue3-select"),d=(0,a.g2)("multiselect"),p=(0,a.g2)("lord-icon");return(0,a.uX)(),(0,a.CE)("div",ea,[(0,a.Lk)("div",ta,[t[29]||(t[29]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-2xl font-bold"},"Woocommerce"),(0,a.Lk)("p",null,"Integrate Wotnot with Woocommerce")],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("button",{class:"bg-green-700 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center hover:bg-green-800",onClick:t[0]||(t[0]=e=>n.showPopup=!0)},t[28]||(t[28]=[(0,a.Lk)("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),(0,a.eW)(" Create Integration ")]))])]),(0,a.Lk)("div",oa,[(0,a.Lk)("div",sa,[t[31]||(t[31]=(0,a.Lk)("div",{class:"flex items-center mb-4"},[(0,a.Lk)("img",{src:Zs,alt:"WooCommerce Logo",class:"rounded-full h-12 w-12"}),(0,a.Lk)("h2",{class:"text-xl font-semibold ml-4"},"WooCommerce")],-1)),(0,a.Lk)("p",aa,[t[30]||(t[30]=(0,a.eW)(" Status: ")),(0,a.Lk)("span",{class:(0,u.C4)("connected"===n.status?"text-green-500":"text-red-500")},(0,u.v_)(n.status),3)]),t[32]||(t[32]=(0,a.Lk)("p",{class:"text-sm text-gray-600 mb-4"}," Boost your cart recovery & reengage with your customers to upsell ",-1)),(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>n.showWooStoreSetupPopup=!0),class:"bg-green-600 text-white text-sm font-semibold py-2 px-4 rounded-lg hover:bg-green-700 flex items-center"}," Store Setup → ")])]),n.showWooStoreSetupPopup?((0,a.uX)(),(0,a.Wv)(i,{key:0,onClose:t[8]||(t[8]=e=>n.showWooStoreSetupPopup=!1),class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 custom-scrollbar"},{default:(0,a.k6)((()=>[t[35]||(t[35]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Store Name"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,u.C4)(["w-full p-2 border rounded-md bg-gray-100",{"text-gray-400":"connected"===n.status}]),"onUpdate:modelValue":t[2]||(t[2]=e=>n.store_name=e),disabled:"connected"==n.status},null,10,ra),[[s.Jo,n.store_name]]),t[36]||(t[36]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("REST API Key"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"APIkey",class:(0,u.C4)(["w-full p-2 border rounded-md bg-gray-100",{"text-gray-400":"connected"===n.status}]),"onUpdate:modelValue":t[3]||(t[3]=e=>n.wooAPIkey=e),placeholder:"Enter your REST API key",disabled:"connected"==n.status},null,10,na),[[s.Jo,n.wooAPIkey]]),t[37]||(t[37]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("REST API Secret"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,u.C4)(["w-full p-2 border rounded-md bg-gray-100",{"text-gray-400":"connected"===n.status}]),"onUpdate:modelValue":t[4]||(t[4]=e=>n.wooAPIsecret=e),placeholder:"Enter your REST API secret",disabled:"connected"==n.status},null,10,la),[[s.Jo,n.wooAPIsecret]]),t[38]||(t[38]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Woocommerce Base URL"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,u.C4)(["w-full p-2 border rounded-md bg-gray-100",{"text-gray-400":"connected"===n.status}]),"onUpdate:modelValue":t[5]||(t[5]=e=>n.Base_url=e),disabled:"connected"==n.status},null,10,ia),[[s.Jo,n.Base_url]]),"connected"!=n.status?((0,a.uX)(),(0,a.CE)("div",ca,[(0,a.Lk)("p",null,[t[33]||(t[33]=(0,a.eW)("Status: ")),(0,a.Lk)("span",{class:(0,u.C4)("connected"===n.status?"text-green-500":"text-red-500")},(0,u.v_)(n.status),3)]),(0,a.Lk)("button",{type:"submit",class:"bg-[#23a455] text-[#f5f6fa] px-4 py-2 rounded",onClick:t[6]||(t[6]=(...e)=>l.testWooCommerceConnection&&l.testWooCommerceConnection(...e))},"Connect")])):((0,a.uX)(),(0,a.CE)("div",da,[(0,a.Lk)("p",null,[t[34]||(t[34]=(0,a.eW)(" Status: ")),(0,a.Lk)("span",{class:(0,u.C4)("connected"===n.status?"text-green-500":"text-red-500")},(0,u.v_)(n.status),3)]),(0,a.Lk)("button",{type:"submit",class:"bg-[#23a455] text-[#f5f6fa] px-4 py-2 rounded",onClick:t[7]||(t[7]=(...e)=>l.disconnectWooCommerce&&l.disconnectWooCommerce(...e))},"Disconnect")])),t[39]||(t[39]=(0,a.Lk)("div",null,null,-1))])),_:1,__:[35,36,37,38,39]})):(0,a.Q3)("",!0),n.showPopup?((0,a.uX)(),(0,a.Wv)(i,{key:1,onClose:l.closePopup,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 custom-scrollbar"},{default:(0,a.k6)((()=>[t[63]||(t[63]=(0,a.Lk)("h2",{class:"text-xl font-bold"},"Woocommerce Integration",-1)),t[64]||(t[64]=(0,a.Lk)("hr",{class:"mb-4"},null,-1)),(0,a.Lk)("div",pa,[(0,a.Lk)("form",{class:(0,u.C4)(["space-y-4",{"opacity-50 pointer-events-none":n.isSubmitted}]),onSubmit:t[27]||(t[27]=(0,s.D$)((e=>l.submitIntegrationForm(this.SelectedAction)),["prevent"]))},[(0,a.Lk)("div",null,[t[41]||(t[41]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2",required:""},[(0,a.eW)("Select action"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>n.SelectedAction=e),class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},t[40]||(t[40]=[(0,a.Lk)("option",{value:"",disabled:""},"Select your option",-1),(0,a.Lk)("option",{value:"woo/order_confirmation"},"Send Order Confirmation",-1),(0,a.Lk)("option",{value:"Abandoned Cart"},"Abandoned Cart",-1),(0,a.Lk)("option",{value:"woo/pwn"},"PWNs (Pre Webinar Notifications)",-1)]),512),[[s.u1,n.SelectedAction]])]),"woo/order_confirmation"===n.SelectedAction?((0,a.uX)(),(0,a.CE)("div",ua,[t[48]||(t[48]=(0,a.Lk)("label",{for:"description",class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Description "),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"description","onUpdate:modelValue":t[10]||(t[10]=e=>n.integration_description=e),class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"},null,512),[[s.Jo,n.integration_description]]),t[49]||(t[49]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Select template"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[11]||(t[11]=e=>n.selectedTemplate=e),onChange:t[12]||(t[12]=(...e)=>l.onTemplateSelect&&l.onTemplateSelect(...e)),class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.templates,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e},(0,u.v_)(e.name),9,ha)))),128))],544),[[s.u1,n.selectedTemplate]]),null!==n.selectedTemplate?((0,a.uX)(),(0,a.CE)("div",ma,[n.selectedTemplateHasImage?((0,a.uX)(),(0,a.CE)("div",ga,[t[42]||(t[42]=(0,a.Lk)("label",{for:"",class:"block text-sm font-semibold"},"Upload Media",-1)),(0,a.Lk)("input",{type:"file",onChange:t[13]||(t[13]=(...e)=>l.onFileChange&&l.onFileChange(...e)),class:"mb-2 w-[60%] mr-1",required:""},null,32)])):(0,a.Q3)("",!0),e.uploadedMedia?((0,a.uX)(),(0,a.CE)("div",ba,(0,u.v_)(this.mediaId),1)):(0,a.Q3)("",!0),t[44]||(t[44]=(0,a.Lk)("label",{for:"",class:"block text-gray-400 font-semibold mb-2"},[(0,a.eW)("Add Parameter (if any)"),(0,a.Lk)("span",{class:"text-red-800"})],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.parameters,((e,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o,class:"flex items-center space-x-2 mb-2"},[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.key=t,class:"w-full p-2 border rounded-md bg-gray-100"},[t[43]||(t[43]=(0,a.Lk)("option",{value:"",disabled:""},"Select your parameter",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.parameterOptions,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e.key},(0,u.v_)(e.label),9,ka)))),128))],8,fa),[[s.u1,e.key]]),(0,a.Lk)("button",{onClick:(0,s.D$)((e=>l.removeParameter(o)),["prevent"]),class:"relative my-2 h-8 w-24 border-2 border-solid border-red-500 text-red-500 hover:text-gray-200 hover:bg-red-700"}," Remove ",8,ya)])))),128)),(0,a.Lk)("button",{onClick:t[14]||(t[14]=(0,s.D$)(((...e)=>l.addParameter&&l.addParameter(...e)),["prevent"])),class:"relative my-2 h-auto w-auto p-1 border-2 border-solid border-green-500 text-green-500 hover:text-gray-200"}," Add Parameter "),t[45]||(t[45]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Select product"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bF)(c,{modelValue:n.productID,"onUpdate:modelValue":t[15]||(t[15]=e=>n.productID=e),options:n.products,label:"name",reduce:e=>e.id,placeholder:"Search products...",required:""},null,8,["modelValue","options","reduce"]),(0,a.Lk)("p",va," Selected Product ID: "+(0,u.v_)(n.productID),1),t[46]||(t[46]=(0,a.Lk)("h3",{class:"text-lg font-bold mb-2"},"Woocommerce Setup",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[16]||(t[16]=e=>n.webhookLink=e),class:"w-full p-2 border rounded-md bg-gray-100",disabled:""},null,512),[[s.Jo,n.webhookLink]]),t[47]||(t[47]=(0,a.Lk)("ul",{class:"list-disc pl-5 mt-4 space-y-2 text-sm"},[(0,a.Lk)("li",null,[(0,a.eW)("Navigate to "),(0,a.Lk)("b",null,"WooCommerce > Settings")]),(0,a.Lk)("li",null,[(0,a.eW)("Click on the "),(0,a.Lk)("b",null,"Advanced tab")]),(0,a.Lk)("li",null,[(0,a.eW)("In the "),(0,a.Lk)("b",null,"Advanced settings"),(0,a.eW)(", click on "),(0,a.Lk)("b",null,"Webhook")]),(0,a.Lk)("li",null,[(0,a.eW)("Click the "),(0,a.Lk)("b",null,"Add Webhook"),(0,a.eW)(" button.")]),(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"Configure Webhook Settings")]),(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"Name"),(0,a.eW)(": Give your webhook a name to identify it.")]),(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"Status:"),(0,a.eW)(" Set this to Active.")]),(0,a.Lk)("li",null,"Topic: Choose the event you want the webhook to listen to"),(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"Delivery URL: use the above given webhook URL")]),(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"Secret:"),(0,a.eW)(" leave blank")]),(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"API Version:"),(0,a.eW)(" Leave the default version")]),(0,a.Lk)("li",null,"Click Save Webhook to activate the integration")],-1))])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"woo/pwn"===n.SelectedAction?((0,a.uX)(),(0,a.CE)("div",wa,[t[61]||(t[61]=(0,a.Lk)("label",{for:"description",class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Description "),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"description","onUpdate:modelValue":t[17]||(t[17]=e=>n.integration_description=e),class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"},null,512),[[s.Jo,n.integration_description]]),t[62]||(t[62]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Select template"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[18]||(t[18]=e=>n.selectedTemplate=e),onChange:t[19]||(t[19]=(...e)=>l.onTemplateSelect&&l.onTemplateSelect(...e)),class:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},[t[50]||(t[50]=(0,a.Lk)("option",{value:"",disabled:""},"Select your template",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.templates,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e},(0,u.v_)(e.name),9,xa)))),128))],544),[[s.u1,n.selectedTemplate]]),null!==n.selectedTemplate?((0,a.uX)(),(0,a.CE)("div",La,[n.selectedTemplateHasImage?((0,a.uX)(),(0,a.CE)("div",Ca,[t[51]||(t[51]=(0,a.Lk)("label",{for:"",class:"block text-sm font-semibold"},"Upload Media",-1)),(0,a.Lk)("input",{type:"file",onChange:t[20]||(t[20]=(...e)=>l.onFileChange&&l.onFileChange(...e)),class:"mb-2 w-[60%] mr-1",required:""},null,32)])):(0,a.Q3)("",!0),e.uploadedMedia?((0,a.uX)(),(0,a.CE)("div",Sa,(0,u.v_)(this.mediaId),1)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.parameters,((e,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o,class:"flex items-center space-x-2 mb-2"},[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.key=t,class:"w-full p-2 border rounded-md bg-gray-100"},[t[52]||(t[52]=(0,a.Lk)("option",{value:"",disabled:""},"Select your parameter",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.parameterOptions,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e.key},(0,u.v_)(e.label),9,Ta)))),128))],8,Ea),[[s.u1,e.key]]),(0,a.Lk)("button",{onClick:(0,s.D$)((e=>l.removeParameter(o)),["prevent"]),class:"relative my-2 h-8 w-24 border-2 border-solid border-red-500 text-red-500 hover:text-gray-200 hover:bg-red-700"}," Remove ",8,_a)])))),128)),t[58]||(t[58]=(0,a.Lk)("label",{class:"block text-gray-500 font-semibold mb-2"},[(0,a.eW)("Add parameter (if any)"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.Lk)("button",{onClick:t[21]||(t[21]=(0,s.D$)(((...e)=>l.addParameter&&l.addParameter(...e)),["prevent"])),class:"relative my-2 h-auto w-auto p-1 border-2 border-solid border-green-500 text-green-500 hover:text-gray-200"}," Add Parameter "),t[59]||(t[59]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},[(0,a.eW)("Execution Time and Days"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.Lk)("div",Aa,[(0,a.Lk)("div",Pa,[(0,a.Lk)("div",Da,[t[53]||(t[53]=(0,a.Lk)("label",{for:"scheduleTime",class:"block text-sm font-medium"},[(0,a.eW)("Time"),(0,a.Lk)("span",{class:"text-red-800"},"*"),(0,a.eW)(" (in IST)")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"time","onUpdate:modelValue":t[22]||(t[22]=e=>n.scheduleTime=e),id:"scheduleTime",required:"",class:"border border-gray-300 rounded px-3 py-2 w-full"},null,512),[[s.Jo,n.scheduleTime]])]),(0,a.Lk)("div",Ia,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.days,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,onClick:t=>l.toggleDaySelection(e.id),class:(0,u.C4)(["w-10 h-10 flex items-center justify-center cursor-pointer rounded-full font-bold transition-all duration-200",e.selected?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"])},(0,u.v_)(e.initial),11,Ua)))),128))])])]),t[60]||(t[60]=(0,a.Lk)("label",{class:"block text-gray-700 font-semibold mb-2"},"Filter Contacts by",-1)),(0,a.Lk)("div",Ma,[t[55]||(t[55]=(0,a.Lk)("label",{class:"block text-sm font-medium"},[(0,a.eW)("Date Range"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.Lk)("div",ja,[(0,a.Lk)("div",Ba,[(0,a.bo)((0,a.Lk)("input",{type:"date",id:"startDate","onUpdate:modelValue":t[23]||(t[23]=e=>n.startDate=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[s.Jo,n.startDate]])]),t[54]||(t[54]=(0,a.Lk)("p",null,"to",-1)),(0,a.Lk)("div",Fa,[(0,a.bo)((0,a.Lk)("input",{type:"date",id:"endDate","onUpdate:modelValue":t[24]||(t[24]=e=>n.endDate=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[s.Jo,n.endDate]])])])]),(0,a.Lk)("div",Wa,[t[56]||(t[56]=(0,a.Lk)("label",{for:"Product",class:"block text-sm font-medium"},[(0,a.eW)("Product"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bF)(c,{id:"Product",modelValue:n.productID,"onUpdate:modelValue":t[25]||(t[25]=e=>n.productID=e),options:n.products,label:"name",reduce:e=>e.id,placeholder:"Search products..."},null,8,["modelValue","options","reduce"]),(0,a.Lk)("p",Xa," Selected Product ID: "+(0,u.v_)(n.productID),1)]),(0,a.Lk)("div",$a,[t[57]||(t[57]=(0,a.Lk)("label",{for:"orderStatus",class:"block text-sm font-medium"},[(0,a.eW)("Order Status"),(0,a.Lk)("span",{class:"text-red-800"},"*")],-1)),(0,a.bF)(d,{id:"orderStatus",modelValue:n.selectedStatuses,"onUpdate:modelValue":t[26]||(t[26]=e=>n.selectedStatuses=e),options:n.statuses,multiple:!0,"close-on-select":!1,"clear-on-select":!1,placeholder:"Select order statuses",label:"label","track-by":"value",class:"mt-2",required:""},null,8,["modelValue","options"])])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),(0,a.Lk)("button",{type:"submit",class:"bg-green-700 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center hover:bg-green-800",disabled:n.PopupLoading||n.isSubmitted},[n.PopupLoading?((0,a.uX)(),(0,a.CE)("span",Oa)):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,u.v_)(n.isSubmitted?"Submitted":n.PopupLoading?"Submitting...":"Submit"),1)],8,Na)],34)])])),_:1,__:[63,64]},8,["onClose"])):(0,a.Q3)("",!0),t[66]||(t[66]=(0,a.Lk)("h3",{class:"text-xl md:text-2xs mb-4 text-gray-600"},[(0,a.Lk)("b",null,"Integration List")],-1)),(0,a.Lk)("div",Ra,[(0,a.Lk)("table",Va,[t[65]||(t[65]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-gray-100 text-center text-gray-700 font-semibold"},[(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"ID"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Description"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Type"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Template"),(0,a.Lk)("th",{class:"p-3 md:p-4 text-center border border-gray-300 sticky top-0 z-10 bg-gray-100"},"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.integrations,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:"hover:bg-gray-50"},[(0,a.Lk)("td",za,(0,u.v_)(e.id),1),(0,a.Lk)("td",Ja,(0,u.v_)(e.description),1),(0,a.Lk)("td",Ha,(0,u.v_)(e.type),1),(0,a.Lk)("td",Ga,(0,u.v_)(e.template),1),(0,a.Lk)("td",Qa,[(0,a.Lk)("div",Ya,[(0,a.Lk)("button",{onClick:t=>l.deleteIntegration(e.integration_id),class:"hover:bg-white rounded-full p-2 transition"},[(0,a.bF)(p,{src:"https://cdn.lordicon.com/skkahier.json",colors:"primary:#ff5757,secondary:#000000",trigger:"hover",style:{width:"32px",height:"32px"}})],8,qa)])])])))),128))])])])])}var Za=o(5877),er=o(9280),tr={name:"AppIntegration",data(){return{apiUrl:"http://localhost:8000",showPopup:!1,showWooStoreSetupPopup:!1,SelectedAction:null,templates:[],selectedTemplate:null,webhookLink:"",integrations:[],templateParams:[],parameters:[],parameterOptions:[{label:"Customer Name",key:"billing.first_name"}],parameterFields:[{selected:""}],days:[{id:1,name:"Monday",initial:"M",selected:!1},{id:2,name:"Tuesday",initial:"T",selected:!1},{id:3,name:"Wednesday",initial:"W",selected:!1},{id:4,name:"Thursday",initial:"T",selected:!1},{id:5,name:"Friday",initial:"F",selected:!1},{id:6,name:"Saturday",initial:"S",selected:!1},{id:7,name:"Sunday",initial:"S",selected:!1}],wooAPIsecret:null,wooAPIkey:null,Base_url:"https://",store_name:null,connectionStatus:null,scheduleTime:null,startDate:null,endDate:null,productID:null,OrderStatus:null,statuses:[{value:"pending",label:"Pending Payment"},{value:"processing",label:"Processing"},{value:"on-hold",label:"On Hold"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"},{value:"refunded",label:"Refunded"},{value:"failed",label:"Failed"}],selectedStatuses:[],products:[],integration_description:null,selectedTemplateHasImage:!1,imageUrl:"",media_id:"",statusMessage:"",error:null,isSubmitted:!1,status:"",loading:!0,PopupLoading:!1,deleteLoading:!1}},components:{PopUp1:bo,Multiselect:Za.Ay,Vue3Select:er.A},async mounted(){await this.fetchTemplates(),await this.fetchapiKey(),await this.fetchIntegrationList(),await this.checkIntegration();const e=document.createElement("script");e.src="https://cdn.lordicon.com/lordicon.js",document.body.appendChild(e)},computed:{selectedDays(){return this.days.filter((e=>e.selected)).map((e=>e.name))},isValid(){return this.selectedDays.length>0},commaSeparatedStatuses(){return this.selectedStatuses.map((e=>e.value)).join(",")}},created(){this.fetchProducts()},methods:{onTemplateSelect(){const e=this.templates.find((e=>e.id===this.selectedTemplate.id));console.log(this.previewData);const t=e.components.find((e=>"HEADER"===e.type&&"IMAGE"===e.format));t?(this.selectedTemplateHasImage=!0,this.imageUrl=t.example?.header_handle?.[0]||""):(this.selectedTemplateHasImage=!1,this.imageUrl="")},async disconnectWooCommerce(){try{const e=await ae.A.delete(`${this.apiUrl}/disconnect-woocommerce`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});"success"===e.data.status?(this.connectionStatus="",this.store_name="",this.wooAPIkey="",this.wooAPIsecret="",this.Base_url="",this.status="disconnected",alert(e.data.message)):alert("Failed to disconnect from WooCommerce.")}catch(e){console.error("Error during disconnection:",e),alert("An error occurred while disconnecting.")}},async fetchProducts(){try{const e=await ae.A.get(`${this.apiUrl}/woo_products`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});this.products=e.data}catch(e){console.error("Error fetching products:",e)}},saveStatuses(){this.commaSeparatedStatuses=this.selectedStatuses.join(","),console.log("Comma-separated values:",this.commaSeparatedStatuses)},async checkIntegration(){try{this.loading=!0,this.error=null;const e=await fetch(`${this.apiUrl}/check-integration`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!e.ok){const t=await e.json();throw this.status="disconnected",new Error(t.detail||"Failed to check integration.")}const t=await e.json();this.statusMessage=t.message,this.status=t.status,this.store_name=t.store_info.store_name,this.wooAPIkey=t.store_info.consumer_key,this.wooAPIsecret=t.store_info.consumer_secret,this.Base_url=t.store_info.base_url}catch(e){this.error=e.message||"Something went wrong."}finally{this.loading=!1}},async testWooCommerceConnection(){try{const e=await ae.A.post(`${this.apiUrl}/test-woocommerce`,{base_url:this.Base_url,consumer_key:this.wooAPIkey,consumer_secret:this.wooAPIsecret,store_name:this.store_name},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});this.status="connected",this.checkIntegration(),console.log("Store Info:",e.data.store_info)}catch(e){this.connectionStatus="Connection Failed: "+e.response.data.detail}},submitIntegrationForm(e){"woo/order_confirmation"==e?this.submitTemplate():"woo/pwn"==e&&this.wooPWNform()},toggleDaySelection(e){const t=this.days.find((t=>t.id===e));t&&(t.selected=!t.selected)},submitSelection(){alert(`Selected days: ${this.selectedDays.join(", ")}`)},addParameter(){this.parameters.push({key:this.parameterOptions[0]})},removeParameter(e){this.parameters.splice(e,1)},togglepopup(){console.log("event")},async fetchTemplates(){try{const e=localStorage.getItem("token"),t=await fetch(`${this.apiUrl}/template`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Network response was not ok");const o=await t.json();this.templates=o.data}catch(e){console.error("Error fetching templates:",e)}},async fetchapiKey(){try{const e=localStorage.getItem("token"),t=await fetch(`${this.apiUrl}/webhooklink`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Network response was not ok");const o=await t.json();this.webhookLink=o.webkook_link}catch(e){console.error("Error fetching API key:",e)}},async submitTemplate(){const e={template_id:this.selectedTemplate.name,template_data:JSON.stringify(this.selectedTemplate),parameters:this.parameters,type:this.SelectedAction,product_id:this.productID,description:this.integration_description,image_id:this.media_id};try{this.PopupLoading=!0;const t=(0,ue.dj)(),o=localStorage.getItem("token"),s=await fetch(`${this.apiUrl}/integrate/woo_order_cnf`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok)t.success("Integration saved successfully"),this.PopupLoading=!1,this.isSubmitted=!0,this.fetchIntegrationList();else{this.PopupLoading=!1;const e=await s.json();t.error(`Error: ${e.detail}`)}}catch(t){console.error("Failed to submit the template: ",t)}},convertISTtoUTC(e){return new Date((new Date).toLocaleDateString("en-US",{timeZone:"Asia/Kolkata"})+" "+e).toISOString().slice(11,16)},async wooPWNform(){this.PopupLoading=!0,this.OrderStatus=this.selectedStatuses.map((e=>e.value)).join(",");const e={template_id:this.selectedTemplate.name,template_data:JSON.stringify(this.selectedTemplate),parameters:this.parameters,type:this.SelectedAction,contacts_start_date:this.startDate,contacts_end_date:this.endDate.split("T")[0]+"T23:59:59",repeat_days:[...this.selectedDays],time:this.scheduleTime,rest_key:this.wooAPIkey,rest_secret:this.wooAPIsecret,product_id:this.productID,status:this.OrderStatus,base_url:this.Base_url,description:this.integration_description,image_id:this.media_id},t=(0,ue.dj)();if(0==this.isValid)return this.showError=!0,void t.error("Select at least one day");if(null==this.productID)return this.showError=!0,void t.error("Select a product");if(null==this.OrderStatus)return this.showError=!0,void t.error("Select order status");if(null==this.startDate)return this.showError=!0,void t.error("Select start date");if(null==this.endDate)return this.showError=!0,void t.error("Select end date");if(null==this.scheduleTime)return this.showError=!0,void t.error("Select time");if(null==this.integration_description)return this.showError=!0,void t.error("Enter description");try{const o=localStorage.getItem("token"),s=await fetch(`${this.apiUrl}/integrate/woo_pwn`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok)t.success("Integration saved successfully"),this.PopupLoading=!1,this.isSubmitted=!0,this.fetchIntegrationList();else{const e=await s.json();t.error(`Error: ${e.detail}`)}}catch(o){console.error("Failed to submit the template: ",o)}},onFileChange(e){this.file=e.target.files[0],this.uploadMedia()},async uploadMedia(){const e=localStorage.getItem("token");this.mediafile=event.target.files[0];const t=new FormData;t.append("file",this.mediafile);try{const o=await fetch(`${this.apiUrl}/upload-media`,{method:"POST",headers:{Authorization:`Bearer ${e}`},body:t}),s=await o.json();if(this.media_id=s.whatsapp_media_id,console.log(this.media_id),!o.ok)throw new Error("Network response was not ok");this.uploadedMedia=!0,alert("Media Uploaded Successfully")}catch(o){console.error("Error uploading media:",o)}},async deleteIntegration(e){try{this.deleteLoading=!0;const t=(0,ue.dj)(),o=localStorage.getItem("token"),s=confirm("Are you sure you want to delete this integration?                           Note:Make sure to also delete the webhook from woocommece.");if(!s)return;const a=await fetch(`${this.apiUrl}/integration/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(a.ok)t.success("Integration deleted successfully"),this.fetchIntegrationList();else{const e=await a.json();t.error(`Error:${e.detail}`)}}catch(t){console.error("Failed to delete the integration: ",t)}finally{this.deleteLoading=!1}},closePopup(){this.showPopup=!1,this.clearForm()},clearForm(){this.isSubmitted=!1,this.SelectedAction=null,this.selectedTemplate=null,this.parameters=[],this.productID=null,this.integration_description=null,this.scheduleTime=null,this.startDate=null,this.endDate=null,this.selectedStatuses=[]},async fetchIntegrationList(){try{const e=localStorage.getItem("token"),t=await fetch(`${this.apiUrl}/woo-integration-list`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Network response was not ok");const o=await t.json();this.integrations=o.map((e=>({id:e.id,description:e.description,type:e.type,api_key:e.api_key,template:e.template,integration_id:e.integration_id})))}catch(e){console.error("Failed to submit the template: ",e)}}}};const or=(0,i.A)(tr,[["render",Ka],["__scopeId","data-v-e83768dc"]]);var sr=or;const ar={class:"bg-container"},rr={class:"w-full max-w-sm bg-white p-8 rounded-lg shadow-md"},nr={class:"bg-gradient-to-r from-[#075e54] via-[#089678] to-[#075e54] text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center hover:from-[#054d45] hover:via-[#067a62] hover:to-[#054d45] transition-all duration-300",type:"submit"},lr={key:0},ir={key:1,class:"flex items-center"},cr={key:0,class:"text-red-500 text-sm mt-2"},dr={class:"mt-4 text-center text-sm"};function pr(e,t,o,r,n,l){return(0,a.uX)(),(0,a.CE)("main",ar,[(0,a.Lk)("div",rr,[t[8]||(t[8]=(0,a.Fv)('<div class="flex items-center justify-center" data-v-43e3b926><div class="logo-div" data-v-43e3b926><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-43e3b926><path fill="#075e54" d="M160 368c26.5 0 48 21.5 48 48l0 16 72.5-54.4c8.3-6.2 18.4-9.6 28.8-9.6L448 368c8.8 0 16-7.2 16-16l0-288c0-8.8-7.2-16-16-16L64 48c-8.8 0-16 7.2-16 16l0 288c0 8.8 7.2 16 16 16l96 0zm48 124l-.2 .2-5.1 3.8-17.1 12.8c-4.8 3.6-11.3 4.2-16.8 1.5s-8.8-8.2-8.8-14.3l0-21.3 0-6.4 0-.3 0-4 0-48-48 0-48 0c-35.3 0-64-28.7-64-64L0 64C0 28.7 28.7 0 64 0L448 0c35.3 0 64 28.7 64 64l0 288c0 35.3-28.7 64-64 64l-138.7 0L208 492z" data-v-43e3b926></path></svg></div><div class="logo" data-v-43e3b926> WotNot</div></div><p class="text-xl sm:text-xl font-semibold text-center text-gray-800 mb pb-0" data-v-43e3b926>Login to your Wotnot account</p><hr class="my-6 border-gray-300" data-v-43e3b926>',3)),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,s.D$)(((...e)=>l.handleLogin&&l.handleLogin(...e)),["prevent"])),class:"space-y-4"},[(0,a.Lk)("div",null,[t[4]||(t[4]=(0,a.Lk)("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Email",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>n.username=e),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[s.Jo,n.username]])]),(0,a.Lk)("div",null,[t[5]||(t[5]=(0,a.Lk)("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Password",-1)),(0,a.bo)((0,a.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[s.Jo,n.password]])]),(0,a.Lk)("button",nr,[n.isLoading?((0,a.uX)(),(0,a.CE)("div",ir,t[6]||(t[6]=[(0,a.Lk)("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[(0,a.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,a.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),(0,a.eW)(" Logging in... ")]))):((0,a.uX)(),(0,a.CE)("span",lr,"Login"))]),n.errorMessage?((0,a.uX)(),(0,a.CE)("p",cr,(0,u.v_)(n.errorMessage),1)):(0,a.Q3)("",!0)],32),(0,a.Lk)("p",dr,[t[7]||(t[7]=(0,a.eW)(" Don't have an account? ")),(0,a.Lk)("a",{href:"",class:"text-[#075e54] font-semibold mb-4",onClick:t[3]||(t[3]=(0,s.D$)(((...e)=>l.redirectSignup&&l.redirectSignup(...e)),["prevent"]))},"Sign Up")])])])}var ur={name:"LoginPage",data(){return{apiUrl:"http://localhost:8000",username:"",password:"",errorMessage:"",isLoading:!1}},methods:{async handleLogin(){this.isLoading=!0,fetch(`${this.apiUrl}/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{e.access_token?(localStorage.setItem("token",e.access_token),console.log(),this.$router.push("/dashboard")):alert("Invalid Credentials Credentials")})).catch((e=>{console.error("Error:",e)}))},redirectSignup(){this.$router.push("/signup")}}};const hr=(0,i.A)(ur,[["render",pr],["__scopeId","data-v-43e3b926"]]);var mr=hr;const gr={class:"content-section flex flex-col h-screen bg-gray-900 text-white md:ml-64"},br={class:"fixed w-full flex items-center top-0 px-6 py-4 bg-gray-800"},fr={ref:"chatList",class:"flex-1 overflow-y-auto p-4 mt-16 mb-20"},kr={key:0,class:"p-6 bg-gray-800 border-t border-gray-700"},yr={class:"flex"},vr={key:1,class:"fixed bottom-0 w-[1350px] p-6 bg-gray-800 border-t border-gray-700 flex items-center"};function wr(e,t,o,r,n,l){return(0,a.uX)(),(0,a.CE)("div",gr,[(0,a.Lk)("div",br,[t[6]||(t[6]=(0,a.Lk)("div",{class:"text-2xl font-bold"},"ChatGPT",-1)),(0,a.Lk)("div",{class:"ml-auto text-sm cursor-pointer hover:bg-gray-700 px-3 py-2 rounded-md",onClick:t[0]||(t[0]=e=>n.isConfigMode=!n.isConfigMode)}," Settings ")]),(0,a.Lk)("div",fr,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.messages,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:(0,u.C4)(["p-3 rounded-lg max-w-xs","user"===e.role?"bg-blue-600 self-end":"bg-gray-700 self-start"])},(0,u.v_)(e.text),3)))),128))],512),n.isConfigMode?((0,a.uX)(),(0,a.CE)("div",kr,[t[7]||(t[7]=(0,a.Lk)("div",{class:"text-sm text-gray-400 mb-2"},"Enter API Key:",-1)),(0,a.Lk)("div",yr,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.apiKey=e),class:"flex-1 p-2 bg-gray-700 text-white rounded-lg outline-none",type:"password",placeholder:"sk-xxxxxxxxxx"},null,512),[[s.Jo,n.apiKey]]),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.saveApiKey&&l.saveApiKey(...e)),class:"ml-2 px-4 py-2 bg-green-500 rounded-lg"},"Save")])])):((0,a.uX)(),(0,a.CE)("div",vr,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.inputMessage=e),onKeydown:t[4]||(t[4]=(0,s.jR)(((...e)=>l.sendMessage&&l.sendMessage(...e)),["enter"])),class:"flex-1 p-2 bg-gray-700 text-white rounded-lg outline-none",placeholder:"Type a message..."},null,544),[[s.Jo,n.inputMessage]]),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>l.sendMessage&&l.sendMessage(...e)),class:"ml-2 px-4 py-2 bg-blue-500 rounded-lg"},"Send")]))])}var xr={data(){return{messages:[{role:"assistant",text:"Hello! How can I assist you today?"}],inputMessage:"",isConfigMode:!1,apiKey:localStorage.getItem("apiKey")||""}},methods:{async sendMessage(){if(this.inputMessage.trim()){this.messages.push({role:"user",text:this.inputMessage});try{const e=await ae.A.post("http://127.0.0.1:8000/chat",{message:this.inputMessage});this.messages.push({role:"assistant",text:e.data.response})}catch(e){this.messages.push({role:"assistant",text:"Error connecting to server"})}this.inputMessage="",this.scrollToBottom()}},saveApiKey(){localStorage.setItem("apiKey",this.apiKey),this.isConfigMode=!1},scrollToBottom(){(0,a.dY)((()=>{const e=this.$refs.chatList;e&&(e.scrollTop=e.scrollHeight)}))}}};const Lr=(0,i.A)(xr,[["render",wr]]);var Cr=Lr;const Sr={class:"bg-container"},Er={class:"max-w-md w-full bg-white p-8 rounded-lg shadow-lg"},Tr={class:"space-y-4"},_r={class:"w-full"},Ar={class:"mt-4 text-sm text-center"},Pr={class:"mb-2 text-sm"},Dr={class:"flex flex-col items-center"},Ir={class:"mt-4 text-center text-sm"};function Ur(e,t,o,r,n,l){const i=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",Sr,[(0,a.Lk)("div",Er,[t[10]||(t[10]=(0,a.Lk)("h2",{class:"text-2xl sm:text-2xl font-semibold text-center text-gray-800 mb-4"},[(0,a.eW)(" Get started with "),(0,a.Lk)("span",{class:"logo"},"WotNot")],-1)),t[11]||(t[11]=(0,a.Lk)("hr",{class:"my-3 border-gray-300"},null,-1)),(0,a.Lk)("div",Tr,[t[8]||(t[8]=(0,a.Fv)('<div class="w-full" data-v-155bf640><label for="username" class="block text-sm font-medium text-gray-700" data-v-155bf640>Business Name</label><input type="text" id="username" placeholder="" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required data-v-155bf640></div><div class="w-full" data-v-155bf640><label for="email" class="block text-sm font-medium text-gray-700" data-v-155bf640>Business Email Address</label><input type="email" id="email" placeholder="" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required data-v-155bf640></div>',2)),(0,a.Lk)("div",_r,[t[3]||(t[3]=(0,a.Lk)("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Password",-1)),(0,a.bo)((0,a.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[0]||(t[0]=e=>n.password=e),placeholder:"Set Password",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:""},null,512),[[s.Jo,n.password]]),(0,a.Lk)("div",{class:"h-2 mt-2 rounded transition-all duration-300",style:(0,u.Tr)({width:l.strengthWidth,backgroundColor:l.strengthColor})},null,4),(0,a.Lk)("p",{class:"text-sm mt-1 font-medium",style:(0,u.Tr)({color:l.strengthColor})},(0,u.v_)(l.strengthLabel),5)]),(0,a.Lk)("div",Ar,[(0,a.Lk)("p",Pr,[t[6]||(t[6]=(0,a.eW)(" By signing up you agree to the ")),(0,a.bF)(i,{to:"/terms-and-privacy#terms-and-conditions",class:"text-[#075e54] font-semibold"},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("Terms")]))),_:1,__:[4]}),t[7]||(t[7]=(0,a.eW)(" and ")),(0,a.bF)(i,{to:"/terms-and-privacy#privacy-policy",class:"text-[#075e54] font-semibold"},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("Privacy Policy")]))),_:1,__:[5]})])])]),t[12]||(t[12]=(0,a.Lk)("div",{class:"cf-turnstile","data-sitekey":"0x4AAAAAABeiGZqY3Hf9K04o"},null,-1)),(0,a.Lk)("div",Dr,[(0,a.Lk)("button",{class:"w-full bg-gradient-to-r from-[#075e54] via-[#089678] to-[#075e54] text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center hover:from-[#078478] hover:via-[#08b496] hover:to-[#078478] transition-all duration-300",onClick:t[1]||(t[1]=(0,s.D$)(((...e)=>l.handleSubmit&&l.handleSubmit(...e)),["prevent"]))}," Get Account "),(0,a.Lk)("p",Ir,[t[9]||(t[9]=(0,a.eW)(" Already have an account? ")),(0,a.Lk)("a",{href:"",class:"text-[#075e54] font-semibold mb-4",onClick:t[2]||(t[2]=(...e)=>l.redirectLogin&&l.redirectLogin(...e))},"Login")])])])])}var Mr=o(7065),jr=o.n(Mr),Br={data(){return{apiUrl:"http://localhost:8000",password:""}},name:"BasicSignUpForm",computed:{strengthScore(){return jr()(this.password||"").score},strengthLabel(){return["Very Weak","Weak","Fair","Good","Strong"][this.strengthScore]},strengthColor(){return["#e53e3e","#dd6b20","#d69e2e","#38a169","#3182ce"][this.strengthScore]},strengthWidth(){return this.strengthScore/4*100+"%"}},mounted(){const e=document.createElement("script");e.src="https://challenges.cloudflare.com/turnstile/v0/api.js",e.async=!0,e.defer=!0,document.head.appendChild(e)},methods:{handleSubmit(){const e=document.querySelector('input[name="cf-turnstile-response"]')?.value;if(!e)return void alert("Please complete the CAPTCHA.");const t={username:document.getElementById("username").value,email:document.getElementById("email").value,password:document.getElementById("password").value,cf_token:e};t.username&&t.email&&t.password?fetch(`${this.apiUrl}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{e.success?(alert("Account created successfully!"),document.querySelectorAll("input").forEach((e=>e.value=""))):e.detail?alert(e.detail):alert("Failed to create account. Please try again.")})).catch((e=>console.error(e))):alert("Please fill in all required fields.")},redirectLogin(){this.$router.push("/")}}};const Fr=(0,i.A)(Br,[["render",Ur],["__scopeId","data-v-155bf640"]]);var Wr=Fr;const Xr={id:"app"},$r={class:"navbar"},Nr={class:"nav-left"},Or=["onClick"],Rr={class:"nav-right"},Vr={key:0,class:"flex"},zr={class:"text-green-700 mr-2"},Jr={key:1},Hr={class:"profile-icon"},Gr={key:0},Qr=["src"],Yr={key:1},qr={key:0,class:"dropdown-menu",ref:"dropdownMenu"},Kr={key:0,class:"modal-overlay"},Zr={class:"modal-header"},en={class:"flex flex-1"},tn={class:"flex-1 mt-16 bg-white h-[calc(100vh-65px)]"};function on(e,t,o,r,n,l){const i=(0,a.g2)("router-view"),c=(0,a.g2)("ProfilePopup");return(0,a.uX)(),(0,a.CE)("div",Xr,[(0,a.Lk)("div",$r,[(0,a.Lk)("div",Nr,[t[18]||(t[18]=(0,a.Lk)("div",{class:"logo-div"},[(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},[(0,a.Lk)("path",{fill:"#166534",d:"M160 368c26.5 0 48 21.5 48 48l0 16 72.5-54.4c8.3-6.2 18.4-9.6 28.8-9.6L448 368c8.8 0 16-7.2 16-16l0-288c0-8.8-7.2-16-16-16L64 48c-8.8 0-16 7.2-16 16l0 288c0 8.8 7.2 16 16 16l96 0zm48 124l-.2 .2-5.1 3.8-17.1 12.8c-4.8 3.6-11.3 4.2-16.8 1.5s-8.8-8.2-8.8-14.3l0-21.3 0-6.4 0-.3 0-4 0-48-48 0-48 0c-35.3 0-64-28.7-64-64L0 64C0 28.7 28.7 0 64 0L448 0c35.3 0 64 28.7 64 64l0 288c0 35.3-28.7 64-64 64l-138.7 0L208 492z"})])],-1)),t[19]||(t[19]=(0,a.Lk)("div",{class:"logo"}," WotNot",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.navItems,(e=>((0,a.uX)(),(0,a.CE)("div",{class:(0,u.C4)(["nav-item",{active:r.isActive(e.path)}]),key:e.name,onClick:t=>r.navigate(e.path)},[(0,a.Lk)("i",{class:(0,u.C4)(e.icon)},null,2),(0,a.eW)((0,u.v_)(e.label),1)],10,Or)))),128))]),(0,a.Lk)("div",Rr,[n.user?((0,a.uX)(),(0,a.CE)("div",Vr,[(0,a.Lk)("p",zr,(0,u.v_)(n.user.email),1)])):((0,a.uX)(),(0,a.CE)("div",Jr,t[20]||(t[20]=[(0,a.Lk)("p",{class:"text-gray-600 mr-2"},"Session Expired",-1)]))),(0,a.Lk)("div",{class:"profile-dropdown",onClick:t[4]||(t[4]=(...e)=>l.toggleDropdown&&l.toggleDropdown(...e)),ref:"profileDropdown"},[(0,a.Lk)("div",Hr,[n.profile.profile_picture_url?((0,a.uX)(),(0,a.CE)("div",Gr,[(0,a.Lk)("img",{src:n.profile.profile_picture_url,alt:""},null,8,Qr)])):((0,a.uX)(),(0,a.CE)("div",Yr,t[21]||(t[21]=[(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-person-circle",viewBox:"0 0 16 16"},[(0,a.Lk)("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"}),(0,a.Lk)("path",{"fill-rule":"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"})],-1)])))]),n.dropdownOpen?((0,a.uX)(),(0,a.CE)("div",qr,[(0,a.Lk)("ul",null,[(0,a.Lk)("li",{onClick:t[0]||(t[0]=(...e)=>l.goToProfile&&l.goToProfile(...e))},t[22]||(t[22]=[(0,a.Lk)("i",{class:"bi bi-person-circle"},null,-1),(0,a.eW)(" View Profile")])),(0,a.Lk)("li",{onClick:t[1]||(t[1]=(...e)=>l.goToCostAnalytics&&l.goToCostAnalytics(...e))},t[23]||(t[23]=[(0,a.Lk)("i",{class:"bi bi-currency-rupee"},null,-1),(0,a.eW)(" Purchase History ")])),(0,a.Lk)("li",{onClick:t[2]||(t[2]=(...e)=>l.goToSettings&&l.goToSettings(...e))},t[24]||(t[24]=[(0,a.Lk)("i",{class:"bi bi-gear-fill"},null,-1),(0,a.eW)(" Settings")])),(0,a.Lk)("li",{onClick:t[3]||(t[3]=(...e)=>l.logout&&l.logout(...e))},t[25]||(t[25]=[(0,a.Lk)("i",{class:"bi bi-box-arrow-right"},null,-1),(0,a.eW)(" Logout")]))])],512)):(0,a.Q3)("",!0)],512)])]),n.walletModalOpen?((0,a.uX)(),(0,a.CE)("div",Kr,[(0,a.Lk)("div",{class:"modal-content",onClick:t[7]||(t[7]=(0,s.D$)((()=>{}),["stop"]))},[(0,a.Lk)("div",Zr,[t[26]||(t[26]=(0,a.Lk)("h2",null,"Wallet",-1)),(0,a.Lk)("span",{class:"close-btn",onClick:t[5]||(t[5]=(...e)=>l.toggleWalletModal&&l.toggleWalletModal(...e))},"×")]),(0,a.Lk)("p",null,[t[27]||(t[27]=(0,a.Lk)("strong",null,"Current Balance:",-1)),(0,a.eW)(" "+(0,u.v_)(n.currentBalance),1)]),(0,a.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>l.topUpBalance&&l.topUpBalance(...e)),class:"topup-btn"},"Top Up Balance")])])):(0,a.Q3)("",!0),(0,a.Lk)("div",en,[(0,a.Lk)("button",{onClick:t[8]||(t[8]=e=>n.isMenuOpen=!n.isMenuOpen),class:"p-2 md:hidden"},t[28]||(t[28]=[(0,a.Lk)("i",{class:"bi bi-list text-2xl z-[1000] absolute top-[60px]"},null,-1)])),"broadcast"===r.currentSection?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,u.C4)(["fixed top-12 left-0 w-64 h-[calc(100vh-65px)] bg-gray-100 p-4 overflow-y-auto mt-4 z-50 transform md:transform-none transition-transform duration-300 ease-in-out",{"-translate-x-full":!n.isMenuOpen,"translate-x-0":n.isMenuOpen}])},[(0,a.Lk)("a",{href:"#",onClick:t[9]||(t[9]=(0,s.D$)((e=>r.navigate("/broadcast/broadcast2")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/broadcast/broadcast2"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/broadcast/broadcast2")},"block p-3 text-gray-600 rounded-lg"])},t[29]||(t[29]=[(0,a.Lk)("i",{class:"bi bi-broadcast mr-2"},null,-1),(0,a.eW)("Broadcast Messages ")]),2),(0,a.Lk)("a",{href:"#",onClick:t[10]||(t[10]=(0,s.D$)((e=>r.navigate("/broadcast/broadcast1")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/broadcast/broadcast1"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/broadcast/broadcast1")},"block p-3 text-gray-600 rounded-lg"])},t[30]||(t[30]=[(0,a.Lk)("i",{class:"bi bi-chat-right-text-fill mr-2"},null,-1),(0,a.eW)("Manage Templates ")]),2),(0,a.Lk)("a",{href:"#",onClick:t[11]||(t[11]=(0,s.D$)((e=>r.navigate("/broadcast/broadcast3")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/broadcast/broadcast3"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/broadcast/broadcast3")},"block p-3 text-gray-600 rounded-lg"])},t[31]||(t[31]=[(0,a.Lk)("i",{class:"bi bi-calendar2-range-fill mr-2"},null,-1),(0,a.eW)("Scheduled Broadcasts ")]),2)],2)):(0,a.Q3)("",!0),"Contacts"===r.currentSection?((0,a.uX)(),(0,a.CE)("div",{key:1,class:(0,u.C4)(["fixed top-12 left-0 w-64 h-[calc(100vh-65px)] bg-gray-100 p-4 overflow-y-auto mt-4 z-50 transform md:transform-none transition-transform duration-300 ease-in-out",{"-translate-x-full":!n.isMenuOpen,"translate-x-0":n.isMenuOpen}])},[(0,a.Lk)("a",{href:"#",onClick:t[12]||(t[12]=(0,s.D$)((e=>r.navigate("/contacts/contacts1")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/contacts/contacts1"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/contacts/contacts1")},"block p-3 text-gray-600 rounded-lg"])},t[32]||(t[32]=[(0,a.Lk)("i",{class:"bi bi-journal-bookmark-fill mr-2"},null,-1),(0,a.eW)("Manage Contacts ")]),2),(0,a.Lk)("a",{href:"#",onClick:t[13]||(t[13]=(0,s.D$)((e=>r.navigate("/contacts/contacts2")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/contacts/contacts2"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/contacts/contacts2")},"block p-3 text-gray-600 rounded-lg"])},t[33]||(t[33]=[(0,a.Lk)("i",{class:"bi bi-tags-fill mr-2"},null,-1),(0,a.eW)("Manage Tags ")]),2)],2)):(0,a.Q3)("",!0),"Integration"===r.currentSection?((0,a.uX)(),(0,a.CE)("div",{key:2,class:(0,u.C4)(["fixed top-12 left-0 w-64 h-[calc(100vh-65px)] bg-gray-100 p-4 overflow-y-auto mt-4 z-50 transform md:transform-none transition-transform duration-300 ease-in-out",{"-translate-x-full":!n.isMenuOpen,"translate-x-0":n.isMenuOpen}])},[(0,a.Lk)("a",{href:"#",onClick:t[14]||(t[14]=(0,s.D$)((e=>r.navigate("/integration/integration1")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/integration/integration1"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/integration/integration1")},"block p-3 text-gray-600 rounded-lg"])},t[34]||(t[34]=[(0,a.Lk)("i",{class:"bi bi-link-45deg"},null,-1),(0,a.eW)(" Woocommerce ")]),2)],2)):(0,a.Q3)("",!0),"Analytics"===r.currentSection?((0,a.uX)(),(0,a.CE)("div",{key:3,class:(0,u.C4)(["fixed top-12 left-0 w-64 h-[calc(100vh-65px)] bg-gray-100 p-4 overflow-y-auto mt-4 z-50 transform md:transform-none transition-transform duration-300 ease-in-out",{"-translate-x-full":!n.isMenuOpen,"translate-x-0":n.isMenuOpen}])},[(0,a.Lk)("a",{href:"#",onClick:t[15]||(t[15]=(0,s.D$)((e=>r.navigate("/analytics/cost")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/analytics/cost"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/analytics/cost")},"block p-3 text-gray-600 rounded-lg"])},t[35]||(t[35]=[(0,a.Lk)("i",{class:"bi bi-currency-dollar"},null,-1),(0,a.eW)(" Cost ")]),2),(0,a.Lk)("a",{href:"#",onClick:t[16]||(t[16]=(0,s.D$)((e=>r.navigate("/analytics/conversations")),["prevent"])),class:(0,u.C4)([{"text-green-800 font-semibold":r.isActive("/analytics/conversations"),"hover:bg-gray-200 hover:font-semibold":!r.isActive("/analytics/conversations")},"block p-3 text-gray-600 rounded-lg"])},t[36]||(t[36]=[(0,a.Lk)("i",{class:"bi bi-link-45deg"},null,-1),(0,a.eW)(" Conversations ")]),2)],2)):(0,a.Q3)("",!0),(0,a.Lk)("div",tn,[(0,a.bF)(i)]),(0,a.bF)(c,{visible:n.showProfilePopup,user:n.user,onClose:t[17]||(t[17]=e=>n.showProfilePopup=!1)},null,8,["visible","user"])])])}const sn={class:"flex justify-between items-center p-4 border-b border-gray-200"},an={class:"relative mt-1"},rn=["readonly"],nn={class:"relative mt-1"},ln=["readonly"];function cn(e,t,o,r,n,l){return o.visible?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-end z-50",onClick:t[7]||(t[7]=(0,s.D$)(((...e)=>l.close&&l.close(...e)),["self"]))},[(0,a.Lk)("div",{class:(0,u.C4)(["w-80 h-full bg-white shadow-lg transform transition-transform duration-300",o.visible?"translate-x-0":"translate-x-full"])},[(0,a.Lk)("div",sn,[t[9]||(t[9]=(0,a.Lk)("h2",{class:"text-xl font-semibold text-gray-900"},"Profile Details",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.close&&l.close(...e)),class:"text-gray-600 hover:text-gray-900"},t[8]||(t[8]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,a.Lk)("form",{onSubmit:t[6]||(t[6]=(0,s.D$)(((...e)=>l.saveProfile&&l.saveProfile(...e)),["prevent"])),class:"p-4 space-y-4"},[(0,a.Lk)("div",null,[t[10]||(t[10]=(0,a.Lk)("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email:",-1)),(0,a.Lk)("div",an,[(0,a.bo)((0,a.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>n.localUser.email=e),readonly:n.isEmailReadonly,class:"block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,8,rn),[[s.Jo,n.localUser.email]])])]),(0,a.Lk)("div",null,[t[11]||(t[11]=(0,a.Lk)("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Username:",-1)),(0,a.Lk)("div",nn,[(0,a.bo)((0,a.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[2]||(t[2]=e=>n.localUser.name=e),readonly:n.isNameReadonly,class:"block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,8,ln),[[s.Jo,n.localUser.name]])])]),(0,a.Lk)("div",null,[t[12]||(t[12]=(0,a.Lk)("label",{for:"whatsapp_business_id",class:"block text-sm font-medium text-gray-700"},"WhatsApp Business ID:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"whatsapp_business_id","onUpdate:modelValue":t[3]||(t[3]=e=>n.localUser.whatsapp_business_id=e),readonly:"",class:"block w-full p-2 mt-1 border border-gray-300 rounded-md shadow-sm sm:text-sm"},null,512),[[s.Jo,n.localUser.whatsapp_business_id]])]),(0,a.Lk)("div",null,[t[13]||(t[13]=(0,a.Lk)("label",{for:"phone_id",class:"block text-sm font-medium text-gray-700"},"Phone ID:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"phone_id","onUpdate:modelValue":t[4]||(t[4]=e=>n.localUser.phone_id=e),readonly:"",class:"block w-full p-2 mt-1 border border-gray-300 rounded-md shadow-sm sm:text-sm"},null,512),[[s.Jo,n.localUser.phone_id]])]),(0,a.Lk)("div",null,[t[14]||(t[14]=(0,a.Lk)("label",{for:"access_token",class:"block text-sm font-medium text-gray-700"},"Access Token:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"access_token","onUpdate:modelValue":t[5]||(t[5]=e=>n.localUser.access_token=e),readonly:"",class:"block w-full p-2 mt-1 border border-gray-300 rounded-md shadow-sm sm:text-sm"},null,512),[[s.Jo,n.localUser.access_token]])])],32)],2)])):(0,a.Q3)("",!0)}var dn={name:"ProfileSidebar",props:{visible:{type:Boolean,required:!0},user:{type:Object,required:!0}},data(){return{apiUrl:"http://localhost:8000",localUser:{...this.user},isEmailReadonly:!0,isNameReadonly:!0}},watch:{visible:{immediate:!0,handler(e){e&&this.fetchUserDetails()}},user:{immediate:!0,handler(e){this.localUser={...e}}}},methods:{close(){this.$emit("close")},toggleEmailReadonly(){this.isEmailReadonly=!this.isEmailReadonly},toggleNameReadonly(){this.isNameReadonly=!this.isNameReadonly},async fetchUserDetails(){try{const e=await fetch(`${this.apiUrl}/user`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error("Failed to fetch user details");const t=await e.json();this.localUser.email=t.email,this.localUser.name=t.name,this.localUser.whatsapp_business_id=t["Whatsapp_Business_Id"],this.localUser.phone_id=t["Phone_id"],this.localUser.access_token=t["Access_Token"]}catch(e){console.error("Error fetching user details:",e)}},async saveProfile(){try{const e=await fetch(`${this.apiUrl}/user`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({email:this.localUser.email,name:this.localUser.name,Whatsapp_Business_Id:this.localUser.whatsapp_business_id,Phone_id:this.localUser.phone_id,Access_Token:this.localUser.access_token})});if(!e.ok)throw new Error("Failed to save user details");console.log("Profile saved",this.localUser),this.$emit("update:user",this.localUser),this.close()}catch(e){console.error("Error saving user details:",e)}}}};const pn=(0,i.A)(dn,[["render",cn],["__scopeId","data-v-17bf17e0"]]);var un=pn,hn={name:"DashboardView",components:{ProfilePopup:un},data(){return{apiUrl:"http://localhost:8000",localUser:{whatsapp_business_id:""},navItems:[{name:"broadcast",label:"Broadcast",icon:"bi bi-broadcast",path:"/broadcast/broadcast2"},{name:"Contacts",label:"Contacts",icon:"bi bi-person-video2",path:"/contacts/contacts1"},{name:"Integration",label:"Integration",icon:"bi bi-plugin",path:"/integration/integration1"},{name:"chatbot",label:"Chatbot",path:"/chatbot/chatbotview",icon:"bi bi-robot"},{name:"Analytics",label:"Analytics",path:"/analytics/cost",icon:"bi bi-graph-up"}],user:null,dropdownOpen:!1,showProfilePopup:!1,isMenuOpen:!1,walletModalOpen:!1,currentBalance:0,profile:{about:"",address:"",email:"",description:"",websites:"",vertical:"OTHER",messaging_product:"whatsapp",profile_picture_url:""},originalProfile:{}}},setup(){const e=(0,p.rd)(),t=(0,p.lq)(),o=e=>t.path===e,s=t=>{e.push(t)};return{navigate:s,isActive:o,currentSection:mn(t.path)}},watch:{"$route.path":function(e){this.currentSection=mn(e)}},async mounted(){await this.fetchProfile(),await this.fetchUserDetails(),await this.created(),document.addEventListener("click",this.handleOutsideClick);const e=()=>{this.sessionInfoResponse&&this.sdkResponse&&fetch(`${this.apiUrl}/subscribe_customer`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({sessionInfoResponse:this.sessionInfoResponse,sdkResponse:this.sdkResponse})}).then((e=>e.json())).then((e=>{console.log("Response from backend:",e)})).catch((e=>{console.error("Error sending data to backend:",e)}))};this.$watch((()=>[this.sessionInfoResponse,this.sdkResponse]),(t=>{const[o,s]=t;o&&s&&e()}),{immediate:!0,deep:!0}),window.fbAsyncInit=()=>{FB.init({appId:"2621821927998797",autoLogAppEvents:!0,xfbml:!0,version:"v21.0"})};const t=document.createElement("script");t.src="https://connect.facebook.net/en_US/sdk.js",t.async=!0,t.defer=!0,t.crossOrigin="anonymous",document.body.appendChild(t),window.addEventListener("message",(e=>{if("https://www.facebook.com"===e.origin||"https://web.facebook.com"===e.origin)try{const t=JSON.parse(e.data);if("WA_EMBEDDED_SIGNUP"===t.type)if("FINISH"===t.event){const{phone_number_id:e,waba_id:o}=t.data;console.log("Phone number ID:",e,"WhatsApp business account ID:",o)}else if("CANCEL"===t.event){const{current_step:e}=t.data;console.warn("Cancelled at step:",e)}else if("ERROR"===t.event){const{error_message:e}=t.data;console.error("Error:",e)}this.sessionInfoResponse=JSON.stringify(t,null,2)}catch{console.log("Non-JSON Response:",e.data)}}))},beforeUnmount(){document.removeEventListener("click",this.handleOutsideClick)},methods:{async created(){try{const e=await fetch(`${this.apiUrl}/user`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error("Failed to fetch user details");this.user=await e.json()}catch(e){console.error("Error fetching user details:",e)}},async fetchUserDetails(){try{const e=await fetch(`${this.apiUrl}/user`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error("Failed to fetch user details");const t=await e.json();this.localUser.whatsapp_business_id=t["Whatsapp_Business_Id"]}catch(e){console.error("Error fetching user details:",e)}},async fetchWalletDetails(e){try{const t=await fetch(`${this.apiUrl}/conversations-cost/${e}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const o=await t.json();this.currentBalance=o,this.currentBalance=this.currentBalance.toFixed(3)}catch(t){return console.error("Error fetching wallet details:",t),null}},async fetchProfile(){try{const e=localStorage.getItem("token"),t=await ae.A.get(`${this.apiUrl}/get-business-profile/`,{headers:{Authorization:`Bearer ${e}`}});if(t.status>=200&&t.status<300&&t.data.data.length){const e=t.data.data[0];this.profile={about:e.about||"",address:e.address||"",email:e.email||"",websites:e.websites&&e.websites.join(", ")||"",vertical:e.vertical||"OTHER",messaging_product:e.messaging_product||"whatsapp",description:e.description||"",profile_picture_url:e.profile_picture_url||""},this.originalProfile={...this.profile}}}catch(e){console.error("Error fetching profile:",e.response?.data?.detail||e.message)}finally{this.loading=!1}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},async toggleWalletModal(){this.walletModalOpen=!this.walletModalOpen;const e=this.walletModalOpen;e&&await this.fetchWalletDetails(this.localUser.whatsapp_business_id)},topUpBalance(){alert("Coming Soon...")},goToProfile(){this.showProfilePopup=!0},goToSettings(){this.$router.push("/settings")},goToCostAnalytics(){this.$router.push("/analytics/cost")},logout(){localStorage.removeItem("token"),this.$router.push("/")},handleOutsideClick(e){const t=this.$refs.dropdownMenu,o=this.$refs.profileDropdown;t&&!t.contains(e.target)&&o&&!o.contains(e.target)&&(this.dropdownOpen=!1)}}};function mn(e){return e.startsWith("/broadcast")?"broadcast":e.startsWith("/contacts")?"Contacts":e.startsWith("/integration")?"Integration":e.startsWith("/chatbot")?"Chatbot":e.startsWith("/analytics")?"Analytics":e.startsWith("/agent")?"AIagent":"broadcast"}const gn=(0,i.A)(hn,[["render",on]]);var bn=gn;const fn={class:"flex flex-col m-8 overflow-y-auto h-[80vh] md:ml-72"},kn={class:"w-full max-w-3xl space-y-6"},yn={class:"flex"},vn=["src"],wn=["scr"],xn={class:"flex flex ml-4 items-center max-w-[50px]"},Ln=["disabled"],Cn={key:0,class:"mt-4 p-2 bg-green-100 border border-green-300 rounded"},Sn={key:1,class:"mt-4 p-2 bg-red-100 border border-red-300 rounded"},En={class:"text-sm text-red-700"},Tn={class:"grid grid-cols-2 gap-6"},_n={class:"grid grid-cols-2 gap-6"},An={class:"grid grid-cols-2 gap-6"},Pn={class:"flex justify-end space-x-4"};function Dn(e,t,o,r,n,l){return(0,a.uX)(),(0,a.CE)("div",fn,[t[22]||(t[22]=(0,a.Lk)("div",{class:"flex flex-col md:flex-row justify-between mb-4 border-b pb-5"},[(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-xl md:text-2xl font-bold"},"Profile Settings"),(0,a.Lk)("p",null,"Change your business profile details")])],-1)),(0,a.Lk)("div",kn,[(0,a.Lk)("div",yn,[(0,a.Lk)("div",null,[(0,a.Lk)("img",{src:n.profile.profile_picture_url,alt:"Description of image",style:{width:"100px",height:"100px","object-fit":"cover","object-position":"start",display:"block","border-radius":"4px"}},null,8,vn),(0,a.Lk)("img",{scr:n.profile.profile_picture_url},null,8,wn),t[11]||(t[11]=(0,a.Lk)("h3",{class:"block mb-2 font-bold"},"Profile Picture",-1))]),(0,a.Lk)("div",xn,[(0,a.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>l.handleFileChange&&l.handleFileChange(...e)),class:"mb-4"},null,32),(0,a.Lk)("div",null,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.uploadFile&&l.uploadFile(...e)),disabled:!n.selectedFile||n.isUploading,class:"px-4 py-2 bg-blue-500 text-white rounded-lg disabled:bg-gray-400"},(0,u.v_)(n.isUploading?"Uploading...":"Upload"),9,Ln)]),n.uploadResponse?((0,a.uX)(),(0,a.CE)("div",Cn,t[12]||(t[12]=[(0,a.Lk)("p",{class:"text-sm text-green-700"},"Upload Successful!",-1)]))):(0,a.Q3)("",!0),n.uploadError?((0,a.uX)(),(0,a.CE)("div",Sn,[(0,a.Lk)("p",En,"Error: "+(0,u.v_)(n.uploadError),1)])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",Tn,[(0,a.Lk)("div",null,[t[13]||(t[13]=(0,a.Lk)("label",{for:"about",class:"block mb-2 font-bold"},"About",-1)),(0,a.bo)((0,a.Lk)("input",{id:"about",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>n.profile.about=e),class:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-green-500"},null,512),[[s.Jo,n.profile.about]])]),(0,a.Lk)("div",null,[t[14]||(t[14]=(0,a.Lk)("label",{for:"businessAddress",class:"block mb-2 font-bold"},"Business Address",-1)),(0,a.bo)((0,a.Lk)("input",{id:"businessAddress",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>n.profile.address=e),class:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-green-500"},null,512),[[s.Jo,n.profile.address]])])]),(0,a.Lk)("div",_n,[(0,a.Lk)("div",null,[t[15]||(t[15]=(0,a.Lk)("label",{for:"businessDescription",class:"block mb-2 font-bold"},"Business Description",-1)),(0,a.bo)((0,a.Lk)("textarea",{id:"businessDescription","onUpdate:modelValue":t[4]||(t[4]=e=>n.profile.description=e),class:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-green-500 resize-none"},null,512),[[s.Jo,n.profile.description]])]),(0,a.Lk)("div",null,[t[16]||(t[16]=(0,a.Lk)("label",{for:"businessEmail",class:"block mb-2 font-bold"},"Email for Business Contact",-1)),(0,a.bo)((0,a.Lk)("input",{id:"businessEmail",type:"email","onUpdate:modelValue":t[5]||(t[5]=e=>n.profile.email=e),class:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-green-500"},null,512),[[s.Jo,n.profile.email]])])]),(0,a.Lk)("div",An,[(0,a.Lk)("div",null,[t[18]||(t[18]=(0,a.Lk)("label",{for:"businessIndustry",class:"block mb-2 font-bold"},"Business Industry",-1)),(0,a.bo)((0,a.Lk)("select",{id:"businessIndustry","onUpdate:modelValue":t[6]||(t[6]=e=>n.profile.vertical=e),class:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-green-500"},t[17]||(t[17]=[(0,a.Fv)('<option value="TECH" data-v-68b1a0cd>Tech</option><option value="BEAUTY" data-v-68b1a0cd>Beauty</option><option value="HEALTH" data-v-68b1a0cd>Health</option><option value="EDU" data-v-68b1a0cd>Education</option><option value="OTHER" data-v-68b1a0cd>Other</option>',5)]),512),[[s.u1,n.profile.vertical]])]),(0,a.Lk)("div",null,[t[19]||(t[19]=(0,a.Lk)("label",{for:"websites",class:"block mb-2 font-bold"},"Websites (comma-separated)",-1)),(0,a.bo)((0,a.Lk)("input",{id:"websites",type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>n.profile.websites=e),class:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-green-500"},null,512),[[s.Jo,n.profile.websites]])])]),(0,a.Lk)("div",Pn,[(0,a.Lk)("button",{type:"button",onClick:t[8]||(t[8]=(...e)=>l.resetProfile&&l.resetProfile(...e)),class:"bg-gray-300 text-white rounded px-6 py-2 hover:bg-gray-400 transition"}," Reset "),(0,a.Lk)("button",{type:"button",onClick:t[9]||(t[9]=(...e)=>l.updateProfile&&l.updateProfile(...e)),class:"bg-green-500 text-white rounded px-6 py-2 hover:bg-green-600 transition"}," Save ")])]),(0,a.Lk)("div",null,[t[21]||(t[21]=(0,a.Lk)("div",{class:"flex flex-col md:flex-row justify-between mb-4 border-b pb-5"},[(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-xl md:text-2xl font-bold"},"Signup for API"),(0,a.Lk)("p",null,"Signup with facebook to get Whatsapp API")])],-1)),(0,a.Lk)("div",null,[t[20]||(t[20]=(0,a.Lk)("div",{id:"fb-root"},null,-1)),(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>l.launchWhatsAppSignup&&l.launchWhatsAppSignup(...e)),style:{"background-color":"#1877f2",border:"0","border-radius":"4px",color:"#fff",cursor:"pointer","font-family":"Helvetica, Arial, sans-serif","font-size":"16px","font-weight":"bold",height:"40px",padding:"0 24px"}}," Login with Facebook ")])])])}var In={data(){return{apiUrl:"http://localhost:8000",selectedFile:null,isUploading:!1,uploadResponse:null,uploadError:null,uploadHandleID:null,profile:{about:"",address:"",email:"",description:"",websites:"",vertical:"OTHER",messaging_product:"whatsapp",profile_picture_url:""},originalProfile:{},loading:!0,sessionInfoResponse:"",sdkResponse:""}},async mounted(){await this.fetchProfile(),document.addEventListener("click",this.handleOutsideClick);const e=()=>{this.sessionInfoResponse&&this.sdkResponse&&fetch(`${this.apiUrl}/subscribe_customer`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({sessionInfoResponse:this.sessionInfoResponse,sdkResponse:this.sdkResponse})}).then((e=>e.json())).then((e=>{console.log("Response from backend:",e)})).catch((e=>{console.error("Error sending data to backend:",e)}))};this.$watch((()=>[this.sessionInfoResponse,this.sdkResponse]),(t=>{const[o,s]=t;o&&s&&e()}),{immediate:!0,deep:!0}),window.fbAsyncInit=()=>{FB.init({appId:"2621821927998797",autoLogAppEvents:!0,xfbml:!0,version:"v21.0"})};const t=document.createElement("script");t.src="https://connect.facebook.net/en_US/sdk.js",t.async=!0,t.defer=!0,t.crossOrigin="anonymous",document.body.appendChild(t),window.addEventListener("message",(e=>{if("https://www.facebook.com"===e.origin||"https://web.facebook.com"===e.origin)try{const t=JSON.parse(e.data);if("WA_EMBEDDED_SIGNUP"===t.type)if("FINISH"===t.event){const{phone_number_id:e,waba_id:o}=t.data;console.log("Phone number ID:",e,"WhatsApp business account ID:",o)}else if("CANCEL"===t.event){const{current_step:e}=t.data;console.warn("Cancelled at step:",e)}else if("ERROR"===t.event){const{error_message:e}=t.data;console.error("Error:",e)}this.sessionInfoResponse=JSON.stringify(t,null,2)}catch{console.log("Non-JSON Response:",e.data)}}))},methods:{fbLoginCallback(e){if(e.authResponse){const t=e.authResponse.code;console.log("Auth Response Code:",t)}this.sdkResponse=JSON.stringify(e,null,2)},launchWhatsAppSignup(){FB.login(this.fbLoginCallback,{config_id:"951833230236631",response_type:"code",override_default_response_type:!0,extras:{setup:{},featureType:"",sessionInfoVersion:"2"}})},loadFacebookSDK(){if(document.getElementById("facebook-jssdk"))this.initializeFacebookSDK();else{const e=document.createElement("script");e.id="facebook-jssdk",e.src="https://connect.facebook.net/en_US/sdk.js",e.async=!0,e.defer=!0,e.onload=this.initializeFacebookSDK,document.body.appendChild(e)}},initializeFacebookSDK(){window.fbAsyncInit=()=>{FB.init({appId:"2621821927998797",cookie:!0,xfbml:!0,version:"v20.0"}),this.renderFacebookButton()}},async fetchProfile(){try{const e=localStorage.getItem("token"),t=await ae.A.get(`${this.apiUrl}/get-business-profile/`,{headers:{Authorization:`Bearer ${e}`}});if(t.status>=200&&t.status<300&&t.data.data.length){const e=t.data.data[0];this.profile={about:e.about||"",address:e.address||"",email:e.email||"",websites:e.websites&&e.websites.join(", ")||"",vertical:e.vertical||"OTHER",messaging_product:e.messaging_product||"whatsapp",description:e.description||"",profile_picture_url:e.profile_picture_url||""},this.originalProfile={...this.profile}}}catch(e){console.error("Error fetching profile:",e.response?.data?.detail||e.message)}finally{this.loading=!1}},async updateProfile(){const e=(0,ue.dj)();try{const t=localStorage.getItem("token"),o={about:this.profile.about,address:this.profile.address,email:this.profile.email,description:this.profile.description,websites:this.profile.websites?this.profile.websites.split(",").map((e=>e.trim())):[],vertical:this.profile.vertical||"OTHER",messaging_product:this.profile.messaging_product||"whatsapp",profile_picture_handle:this.uploadHandleID||""},s=await ae.A.post(`${this.apiUrl}/update-profile/`,o,{headers:{Authorization:`Bearer ${t}`}});s.status>=200&&s.status<300&&(e.success("Profile updated successfully!"),await this.fetchProfile())}catch(t){e.error("Failed to update profile!"),console.error("Error updating profile:",t.response?.data?.detail||t.message)}},resetProfile(){this.profile={...this.originalProfile}},handleFileChange(e){this.selectedFile=e.target.files[0]},async uploadFile(){if(!this.selectedFile)return void alert("Please select a file first.");this.isUploading=!0,this.uploadResponse=null,this.uploadError=null;const e=new FormData;e.append("file",this.selectedFile);try{const t=localStorage.getItem("token"),o=await ae.A.post(`${this.apiUrl}/resumable-upload/`,e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data"}});this.uploadResponse=o.data,this.uploadHandleID=o.data.upload_response?.h||"N/A",console.log(this.uploadHandleID)}catch(t){this.uploadError=t.response?t.response.data.detail:"Upload failed"}finally{this.isUploading=!1}}}};const Un=(0,i.A)(In,[["render",Dn],["__scopeId","data-v-68b1a0cd"]]);var Mn=Un;const jn={id:"app",class:"main-container"},Bn={class:"sidebar"},Fn={class:"w-40px"},Wn={class:"chat-list"},Xn=["onClick"],$n={class:""},Nn=["innerHTML"],On={class:"messageTime"},Rn={class:"chat-area"},Vn={class:"chat-header"},zn={class:"timer"},Jn={key:0,class:"text-gray-600"},Hn={class:"flex flex-col items-start justify-start w-full text-[14px] p-3"},Gn={style:{"font-size":"13px",color:"rgb(132, 138, 134)"}},Qn={class:"flex items-start justify-end w-full"},Yn={id:"currentTime"},qn={class:"chat-content",id:"chatContent",ref:"chatContent"},Kn=["innerHTML"],Zn={id:"messages"},el={key:0,class:"text-center my-2 text-sm text-gray-500"},tl=["onContextmenu"],ol={style:{width:"100%","max-width":"300px"}},sl={key:0,class:"replied-message-context mb-2 text-sm text-gray-600"},al={class:"replied-message"},rl=["innerHTML"],nl=["innerHTML"],ll={class:"messageTime"},il={key:0},cl={key:0,class:"flex justify-between p-4"},dl=["innerHTML"],pl={class:"message-input-area"},ul={key:0,class:"custom-picker",ref:"picker"},hl={key:1,class:"message-input-area flex justify-center text-center"},ml={class:"contact-info"},gl={class:"inner-container bg-white p-4 border-radius-4 h-inherit"},bl={class:"contact-table"},fl={class:"inner-container bg-white p-4 border-radius-4 h-inherit"},kl={class:"contact-table"},yl={style:{color:"gray","font-weight":"300"}};function vl(e,t,o,r,n,l){const i=(0,a.g2)("EmojiPicker");return(0,a.uX)(),(0,a.CE)("div",jn,[(0,a.Lk)("div",Bn,[(0,a.Lk)("b",null,[(0,a.Lk)("div",Fn,[(0,a.bo)((0,a.Lk)("select",{name:"",id:"","onUpdate:modelValue":t[0]||(t[0]=e=>n.chatStatusFilter=e),onChange:t[1]||(t[1]=(...e)=>l.filterChatsByStatus&&l.filterChatsByStatus(...e)),class:"no-border px-3 py-2 text-black",style:{"font-size":"16px",outline:"none"}},t[10]||(t[10]=[(0,a.Lk)("option",{value:"",selected:"",style:{"font-size":"16px",color:"black"}},"All Chats",-1),(0,a.Lk)("option",{value:"true",style:{"font-size":"16px",color:"black"}},"Active Chats ",-1)]),544),[[s.u1,n.chatStatusFilter]])])]),(0,a.Lk)("ul",Wn,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.activeChat,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.message_id},[(0,a.Lk)("div",{class:"flex bg-white justify-between rounded-lg p-4 text-black shadow-md",onClick:t=>(l.ConversationSSE(e.sender_wa_id),n.ActiveWaid=e.sender_wa_id,n.ActiveWaidName=e.sender_name)},[(0,a.Lk)("div",$n,[(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,(0,u.v_)(e.sender_name),1)]),(0,a.Lk)("div",{innerHTML:l.truncateMessage(e.message_content)},null,8,Nn)]),(0,a.Lk)("div",On,[(0,a.Lk)("p",null,(0,u.v_)(e.last_chat_time.split("T")[1].substring(0,5)),1)])],8,Xn)])))),128))])])]),(0,a.Lk)("div",Rn,[(0,a.Lk)("div",Vn,[(0,a.Lk)("div",zn,[n.ActiveWaid?((0,a.uX)(),(0,a.CE)("div",Jn,t[11]||(t[11]=[(0,a.Lk)("i",{class:"bi bi-person-circle",style:{"font-size":"2.1rem"}},null,-1)]))):(0,a.Q3)("",!0),(0,a.Lk)("div",Hn,[(0,a.Lk)("h3",null,[(0,a.Lk)("b",null,(0,u.v_)(n.ActiveWaidName),1)]),(0,a.Lk)("p",Gn,[(0,a.Lk)("b",null,(0,u.v_)(n.ActiveWaid),1)])]),(0,a.Lk)("div",Qn,[(0,a.Lk)("span",Yn,(0,u.v_)(n.selectedRemainingTime),1)])])]),(0,a.Lk)("div",qn,[(0,a.Lk)("div",{innerHTML:n.chatContent},null,8,Kn),(0,a.Lk)("div",Zn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.selectedchat,((e,o)=>((0,a.uX)(),(0,a.CE)("div",{key:e.id},[l.shouldShowDate(o)?((0,a.uX)(),(0,a.CE)("div",el,[(0,a.Lk)("p",null,(0,u.v_)(l.formatDate(n.selectedchat[o].timestamp.split("T")[0])),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",{class:(0,u.C4)({message:!0,"sent-message":"sent"==e.direction}),onContextmenu:(0,s.D$)((t=>l.showContextMenu(t,e)),["prevent"])},[(0,a.Lk)("div",ol,[e.context_message_id?((0,a.uX)(),(0,a.CE)("div",sl,[(0,a.Lk)("div",al,[t[12]||(t[12]=(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,"Replied to:")],-1)),(0,a.Lk)("div",{class:"p-2 border border-gray-300 rounded-md",innerHTML:l.getRepliedMessageContent(e.context_message_id)},null,8,rl)])])):(0,a.Q3)("",!0),(0,a.Lk)("div",{style:{"white-space":"pre-line","word-wrap":"break-word","overflow-wrap":"break-word","max-width":"100%"},innerHTML:l.processMessageContent(e.message_content)},null,8,nl),(0,a.Lk)("div",ll,[(0,a.Lk)("p",null,(0,u.v_)(e.timestamp.split("T")[1].substring(0,5)),1)])])],42,tl)])))),128)),n.contextMenuVisible?((0,a.uX)(),(0,a.CE)("div",{key:0,style:(0,u.Tr)({top:n.contextMenuPosition.y+"px",left:n.contextMenuPosition.x+"px"}),class:"custom-context-menu"},[(0,a.Lk)("ul",null,[(0,a.Lk)("li",{onClick:t[2]||(t[2]=(...e)=>l.replyToMessage&&l.replyToMessage(...e))},"Reply")])],4)):(0,a.Q3)("",!0)])],512),"Chat is expired"!=n.selectedRemainingTime?((0,a.uX)(),(0,a.CE)("div",il,[n.replyMessage?((0,a.uX)(),(0,a.CE)("div",cl,[(0,a.Lk)("div",null,[t[13]||(t[13]=(0,a.Lk)("b",null,"Replying to: ",-1)),(0,a.Lk)("p",{innerHTML:this.getRepliedMessageContent(n.selectedMessage.message_id)},null,8,dl)]),(0,a.Lk)("span",{class:"relative bottom-1 text-xl cursor-pointer text-black mr-4",onClick:t[3]||(t[3]=(...e)=>l.replyMessageClose&&l.replyMessageClose(...e))},"×")])):(0,a.Q3)("",!0),(0,a.Lk)("div",pl,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>n.newMessage=e),onKeyup:t[5]||(t[5]=(0,s.jR)(((...t)=>e.sendMessage&&e.sendMessage(...t)),["enter"])),placeholder:"Type a message..."},null,544),[[s.Jo,n.newMessage]]),t[15]||(t[15]=(0,a.Lk)("label",{for:"file-upload",class:"upload-label"},[(0,a.Lk)("i",{class:"bi bi-paperclip"})],-1)),(0,a.Lk)("button",{onClick:t[6]||(t[6]=(0,s.D$)(((...e)=>l.togglePicker&&l.togglePicker(...e)),["stop"])),class:"emoji-button"},t[14]||(t[14]=[(0,a.Lk)("i",{class:"bi bi-emoji-smile"},null,-1)])),n.showPicker?((0,a.uX)(),(0,a.CE)("div",ul,[(0,a.bF)(i,{onSelect:l.onEmojiSelect},null,8,["onSelect"])],512)):(0,a.Q3)("",!0),(0,a.Lk)("input",{type:"file",id:"file-upload",onChange:t[7]||(t[7]=(...e)=>l.FileUpload&&l.FileUpload(...e)),class:"file-input"},null,32),n.replyMessage?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:1,id:"send-button",class:"bg-green-700 text-white px-6 py-3 rounded-lg shadow-lg font-medium flex items-center justify-center hover:bg-green-800",onClick:t[8]||(t[8]=e=>l.sendChatMessage())},"Send")),n.replyMessage?((0,a.uX)(),(0,a.CE)("button",{key:2,id:"send-button",onClick:t[9]||(t[9]=e=>l.sendChatMessageReply())},"Reply")):(0,a.Q3)("",!0)])])):((0,a.uX)(),(0,a.CE)("div",hl,t[16]||(t[16]=[(0,a.Lk)("h2",null,[(0,a.eW)("Chats are marked as expired 24 hours after the last received customer message. "),(0,a.Lk)("br"),(0,a.eW)("WhatsApp allows only template messages to be sent in such chats. ")],-1)])))]),(0,a.Lk)("div",ml,[(0,a.Lk)("div",gl,[t[20]||(t[20]=(0,a.Lk)("h4",null,[(0,a.Lk)("i",{class:"bi bi-person-vcard",style:{"font-size":"18px",color:"gray","font-weight":"300","margin-right":"2px"}}),(0,a.Lk)("strong",null," Contact Details")],-1)),(0,a.Lk)("table",bl,[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[t[17]||(t[17]=(0,a.Lk)("td",{style:{color:"gray","font-weight":"300"}},"Name",-1)),(0,a.Lk)("td",null,(0,u.v_)(n.contactInfo.name),1)]),(0,a.Lk)("tr",null,[t[18]||(t[18]=(0,a.Lk)("td",{style:{color:"gray","font-weight":"300"}},"Phone",-1)),(0,a.Lk)("td",null,(0,u.v_)(n.contactInfo.phone),1)]),(0,a.Lk)("tr",null,[t[19]||(t[19]=(0,a.Lk)("td",{style:{color:"gray","font-weight":"300"}},"Email",-1)),(0,a.Lk)("td",null,(0,u.v_)(n.contactInfo.email),1)])])])]),(0,a.Lk)("div",fl,[t[22]||(t[22]=(0,a.Lk)("h4",null,[(0,a.Lk)("i",{class:"bi bi-at",style:{color:"gray","font-weight":"300","margin-right":"2px"}}),(0,a.Lk)("strong",null,"Contact Attributes")],-1)),(0,a.Lk)("table",kl,[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[t[21]||(t[21]=(0,a.Lk)("td",{style:{color:"gray","font-weight":"300"}},"Created at",-1)),(0,a.Lk)("td",null,(0,u.v_)(n.contactInfo.created_at),1)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.contactInfo.tags,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",yl,(0,u.v_)(e.split(":")[0]),1),(0,a.Lk)("td",null,(0,u.v_)(e.split(":")[1]),1)])))),128))])])])])])}var wl=o(1114),xl=o(5810),Ll={components:{EmojiPicker:wl.A},name:"ChatbotView",data(){return{apiUrl:"http://localhost:8000",contextMenuVisible:!1,contextMenuPosition:{x:0,y:0},selectedMessage:null,replyMessage:!1,parsedTemplate:null,chatStatusFilter:"",showPicker:!1,activeChat:[],selectedchat:[],selectedChatTime:null,selectedRemainingTime:null,timer:null,ActiveWaid:"",ActiveWaidName:"",chats:[],chatTitle:"",chatContent:"",contactInfo:{},messages:[],newMessage:"",currentTime:"",progressSeconds:0,eventSourceA:null,eventSourceB:null}},async mounted(){document.addEventListener("click",this.handleClickOutside),await this.fetchActiveChatlist(),document.addEventListener("click",(()=>{this.contextMenuVisible=!1}))},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside),this.eventSourceB&&(console.log("Closing eventSourceB:",this.eventSourceB),this.eventSourceB.close(),this.eventSourceB=null),this.eventSourceA&&(this.eventSourceA.close(),console.log("SSE connection closed on component unmount."))},methods:{truncateMessage(e){return e.length>60?`${e.slice(0,60)} <span style="color: gray; cursor: pointer;">...read more</span>`:e},processMessageContent(e){console.log(e);const t="#template_message# ";if(e.startsWith(t)){const s=e.replace(t,"");try{const e=JSON.parse(s);return e.components&&Array.isArray(e.components)?e.components.map((e=>{if("HEADER"===e.type){if("TEXT"===e.format)return`<strong>${e.text}</strong> `;if("IMAGE"===e.format&&e.example?.header_handle)return`<div style="width: auto; height: 200px; overflow: hidden; position: relative; border-radius: 5px">\n                          <img src="${e.example.header_handle[0]}" alt="Description of image" \n                          style="width: 100%; height: 100%; object-fit: cover; object-position: start; display: block ; border-radius: 4px">\n                          </div>`}else{if("BODY"===e.type)return`<div class="template-body mb-2">${e.text}</div>`;if("FOOTER"===e.type)return`<div class="template-footer text-sm text-gray-500">${e.text}</div>`;if("BUTTONS"===e.type)return e.buttons.map((e=>"URL"===e.type?`\n      <div style="text-align: left; font-size:16px;">\n        <a href="${e.url}" target="_blank" \n           style="display: inline-flex; align-items: center; \n           text-decoration: none; font-weight: bold; color: #007bff; \n           border-top: 1px solid #ddd;">\n          <svg xmlns="http://www.w3.org/2000/svg" fill="#007bff" width="19" height="19" viewBox="0 0 24 24" style="margin-right: 5px;">\n            <path d="M14 3v2h3.586l-8.293 8.293 1.414 1.414 8.293-8.293v3.586h2v-7h-7z"/>\n            <path d="M5 5h6v-2h-6c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-6h-2v6h-14v-14z"/>\n          </svg>\n          <span style="padding: 5px">${e.text}</span>\n        </a>\n      </div>`:"REPLY"===e.type?`\n      <div style="text-align: left;">\n        <button style="display: inline-block; margin: 5px 0; padding: 10px 15px; \n                       background-color: #007bff; color: white; border: none; \n                       border-radius: 20px; cursor: pointer; font-weight: bold;">\n          ${e.text}\n        </button>\n      </div>`:"")).join("")}return""})).join(""):(console.error("Invalid template structure:",e),"<div>Error: Invalid template message structure.</div>")}catch(o){return console.error("Failed to parse template message:",o),"<div>Error: Unable to parse template message.</div>"}}return`<p>${e}</p>`},replyMessageClose(){this.replyMessage=!1,this.selectedMessage=""},showContextMenu(e,t){this.contextMenuVisible=!0,this.contextMenuPosition={x:e.clientX,y:e.clientY},this.selectedMessage=t},replyToMessage(){this.selectedMessage&&(this.replyMessage=!0,console.log("Replying to:",this.getRepliedMessageContent(this.selectedMessage.message_id))),this.contextMenuVisible=!1},getRepliedMessageContent(e){if(!Array.isArray(this.selectedchat))return console.error("selectedchat is not defined or is not an array"),"";const t=this.selectedchat.find((t=>t.message_id===e));return t?this.processMessageContent(t.message_content):(console.warn(`Message with ID ${e} not found in selectedchat`),"")},shouldShowDate(e){if(0===e)return!0;const t=this.selectedchat[e].timestamp.split("T")[0],o=this.selectedchat[e-1].timestamp.split("T")[0];return t!==o},formatDate(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},FileUpload(e){const t=e.target.files[0];console.log("File uploaded:",t)},togglePicker(){this.showPicker=!this.showPicker},handleClickOutside(e){this.showPicker&&!this.$refs.picker.contains(e.target)&&(this.showPicker=!1)},onEmojiSelect(e){e&&e.i?this.newMessage+=e.i:console.error("Invalid emoji object:",e)},SetChatTime(e){console.log(e),this.selectedChatTime=e;const t=new Date(e),o=t,s=new Date(o.setHours(o.getHours()+24));this.timer&&clearInterval(this.timer);const a=()=>{const e=new Date,t=(0,xl.L_)(e,"UTC"),o=s-t;if(o<=0)return clearInterval(this.timer),void(this.selectedRemainingTime="Chat is expired");const a=Math.floor(o/1e3/60%60),r=Math.floor(o/1e3/60/60%24),n=Math.floor(o/1e3/60/60/24);let l="";n>0&&(l+=`${n} : `),l+=`${String(r).padStart(2,"0")} : `,l+=`${String(a).padStart(2,"0")}  `,this.selectedRemainingTime=l.trim()};a(),this.timer=setInterval(a,1e3)},beforeDestroy(){this.timer&&clearInterval(this.timer)},async fetchActiveChatlist(e=null){try{this.eventSourceB&&(this.eventSourceB.close(),console.log("Previous SSE connection closed."));const t=localStorage.getItem("token");this.eventSourceB=new EventSource(`${this.apiUrl}/active-conversations?token=${t}`,{}),this.eventSourceB.onmessage=t=>{const o=JSON.parse(t.data);this.activeChat=o.map((e=>({message_content:e.message_content,sender_name:e.sender_name,business_account_id:e.business_account_id,active:e.active,message_id:e.message_id,id:e.id,sender_wa_id:e.sender_wa_id,last_chat_time:e.last_chat_time}))).filter((t=>null===e||""===e||t.active==("true"===e)))},this.eventSourceB.onerror=e=>{console.error("Unable to fetch active conversations",e),this.eventSourceB.close()}}catch(t){console.error("Unable to fetch active conversations")}},filterChatsByStatus(e){const t=e.target.value;this.fetchActiveChatlist(t)},async ConversationSSE(e){this.selectedRemainingTime=null,this.eventSourceA&&(this.eventSourceA.close(),console.log("Previous SSE connection closed."));const t=localStorage.getItem("token");this.eventSourceA=new EventSource(`${this.apiUrl}/sse/conversations/${e}?token=${t}`,{headers:{Authorization:`Bearer ${t}`}}),await this.ActiveContactDetails(e),this.contactInfo.name=this.contactInfo.name?this.contactInfo.name:this.ActiveWaidName,this.contactInfo.phone=this.contactInfo.phone?this.contactInfo.phone:this.ActiveWaid,this.eventSourceA.onmessage=e=>{try{const t=JSON.parse(e.data),o=this.$refs.chatContent,s=o.scrollHeight-o.scrollTop<=o.clientHeight+10;if(this.selectedchat=t,t.length>0){const e=t.filter((e=>"Receive"===e.direction));if(e.length>0){const t=e[e.length-1];this.SetChatTime(t.timestamp)}}s&&this.scrollToBottom()}catch(t){console.error("Error parsing SSE data",t)}},this.eventSourceA.onerror=e=>{console.error("SSE connection error:",e)},console.log("New SSE connection established.")},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.chatContent;e&&(e.scrollTop=e.scrollHeight)}))},async ActiveContactDetails(e){this.contactInfo={};const t=localStorage.getItem("token");try{const o=await fetch(`${this.apiUrl}/contacts/${e}`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error("Network response was not ok");const s=await o.json();this.contactInfo=s}catch(o){console.error("Error fetching contact details:",o)}},async sendChatMessage(){const e=this.newMessage,t=this.ActiveWaid;try{const o=localStorage.getItem("token"),s={wa_id:t,body:e},a=await fetch(`${this.apiUrl}/send-text-message/`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Network response not okay");this.newMessage=""}catch(o){console.error("Error sending message")}},async sendChatMessageReply(){const e=this.newMessage,t=this.ActiveWaid;try{const o=localStorage.getItem("token"),s={wa_id:t,body:e,context_message_id:this.selectedMessage.message_id},a=await fetch(`${this.apiUrl}/send-text-message-reply/`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Network response not okay");this.newMessage="",this.selectedMessage="",this.replyMessage=!1}catch(o){console.error("Error sending message")}}}};const Cl=(0,i.A)(Ll,[["render",vl],["__scopeId","data-v-195e9b68"]]);var Sl=Cl;const El={class:"content-section m-8 md:ml-72"},Tl={class:"rounded-lg mb-4 rounded-[14px] bg-white border border-[#cccccc]"},_l={class:"grid grid-cols-[45%_54%] gap-4"},Al={class:"bg-white rounded-lg rounded-[14px] border border-[#cccccc]"},Pl={class:"bg-white rounded-lg rounded-[14px] border border-[#cccccc]"};function Dl(e,t,o,s,r,n){const l=(0,a.g2)("CostSummary"),i=(0,a.g2)("CostBarChart"),c=(0,a.g2)("PurchaseHistory");return(0,a.uX)(),(0,a.CE)("div",El,[(0,a.Lk)("div",Tl,[(0,a.bF)(l)]),(0,a.Lk)("div",_l,[(0,a.Lk)("div",Al,[(0,a.bF)(i)]),(0,a.Lk)("div",Pl,[(0,a.bF)(c)])])])}const Il={class:"cost-summary"},Ul={class:"grid-container"},Ml={class:"grid-item"},jl={class:"cost"},Bl={class:"change"},Fl={class:"grid-item"},Wl={class:"cost"},Xl={class:"date-range"},$l={class:"grid-item"},Nl={class:"cost"},Ol={class:"change"},Rl={class:"grid-item"},Vl={class:"cost"};function zl(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",Il,[t[6]||(t[6]=(0,a.Lk)("h2",{class:"title"},[(0,a.eW)("Cost Summary "),(0,a.Lk)("span",{class:"info"},"Info")],-1)),(0,a.Lk)("div",Ul,[(0,a.Lk)("div",Ml,[t[1]||(t[1]=(0,a.Lk)("h3",null,"Month-to-date cost",-1)),(0,a.Lk)("p",jl,[(0,a.Lk)("u",null,"₹"+(0,u.v_)(r.monthToDateCost),1)]),(0,a.Lk)("p",Bl,[(0,a.Lk)("span",{class:(0,u.C4)(r.monthToDateChangeClass)},(0,u.v_)(r.monthToDateChange),3),t[0]||(t[0]=(0,a.eW)("% compared to last month for same period "))])]),(0,a.Lk)("div",Fl,[t[2]||(t[2]=(0,a.Lk)("h3",null,"Last month’s cost for same time period",-1)),(0,a.Lk)("p",Wl,[(0,a.Lk)("u",null,"₹"+(0,u.v_)(r.lastMonthSamePeriodCost),1)]),(0,a.Lk)("p",Xl,(0,u.v_)(r.lastMonthDateRange),1)]),(0,a.Lk)("div",$l,[t[4]||(t[4]=(0,a.Lk)("h3",null,"Total forecasted cost for current month",-1)),(0,a.Lk)("p",Nl,[(0,a.Lk)("u",null,"₹"+(0,u.v_)(r.forecastedCost),1)]),(0,a.Lk)("p",Ol,[(0,a.Lk)("span",{class:(0,u.C4)(r.forecastChangeClass)},(0,u.v_)(r.forecastChange),3),t[3]||(t[3]=(0,a.eW)("% compared to last month's total costs "))])]),(0,a.Lk)("div",Rl,[t[5]||(t[5]=(0,a.Lk)("h3",null,"Last month’s total cost",-1)),(0,a.Lk)("p",Vl,[(0,a.Lk)("u",null,"₹"+(0,u.v_)(r.lastMonthTotalCost),1)])])])])}var Jl=o(4353),Hl=o.n(Jl),Gl={data(){return{apiUrl:"http://localhost:8000",monthToDateCost:0,monthToDateChange:"",monthToDateChangeClass:"",lastMonthSamePeriodCost:0,lastMonthDateRange:"",forecastedCost:0,forecastChange:"",forecastChangeClass:"",lastMonthTotalCost:0}},methods:{async fetchAnalyticsData(){try{const e=await ae.A.get(`${this.apiUrl}/conversation-cost-history/`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("Raw API Response:",e.data);const t=e.data.conversation_analytics;if(!t||0===t.length)return void console.warn("No conversation data available.");this.processData(t)}catch(e){console.error("Error fetching analytics:",e)}},processData(e){const t=Hl()().format("YYYY-MM"),o=Hl()().subtract(1,"month").format("YYYY-MM"),s=Hl()().date();let a=0,r=0,n=0,l=Hl()().subtract(1,"month").daysInMonth();e.forEach((e=>{const l=Hl()(e.start_time).format("YYYY-MM"),i=Hl()(e.start_time).date();l===t&&(a+=e.cost),l===o&&(n+=e.cost,i<=s&&(r+=e.cost))})),this.monthToDateCost=parseFloat(a.toFixed(2)),this.lastMonthSamePeriodCost=parseFloat(r.toFixed(2)),this.lastMonthTotalCost=parseFloat(n.toFixed(2)),this.monthToDateChange=parseFloat(((a-r)/(r||1)*100).toFixed(2)),this.forecastedCost=parseFloat((a/s*l).toFixed(2)),this.forecastChange=parseFloat(((this.forecastedCost-n)/(n||1)*100).toFixed(2)),this.forecastChangeClass=e.forecast_change>0?"up":"down",this.monthToDateChangeClass=a>r?"up":"down",console.log("Processed Summary Data:",{monthToDateCost:this.monthToDateCost,monthToDateChange:this.monthToDateChange,lastMonthSamePeriodCost:this.lastMonthSamePeriodCost,lastMonthTotalCost:this.lastMonthTotalCost,forecastedCost:this.forecastedCost,forecastChange:this.forecastChange})}},mounted(){this.fetchAnalyticsData()}};const Ql=(0,i.A)(Gl,[["render",zl],["__scopeId","data-v-19379b48"]]);var Yl=Ql;const ql={class:"cost-summary"},Kl={ref:"chartCanvas"};function Zl(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",ql,[t[0]||(t[0]=(0,a.Lk)("h2",{class:"title"},[(0,a.eW)("Cost Breakdown "),(0,a.Lk)("span",{class:"info"},"Info")],-1)),(0,a.Lk)("canvas",Kl,null,512)])}var ei=o(953),ti=o(8508);ti.t1.register(ti.A6,ti.E8,ti.PP,ti.kc,ti.hE,ti.m_,ti.s$);var oi={setup(){const e=(0,ei.KR)(null);let t=null;const o="http://localhost:8000",s=async()=>{try{const e=await ae.A.get(`${o}/conversation-cost-history/`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("API Response:",e.data);const t=e.data.conversation_analytics,s={};t.forEach((e=>{const t=new Date(e.start_time),o=t.toLocaleString("default",{month:"short",year:"numeric"});s[o]||(s[o]={MARKETING:0,UTILITY:0}),s[o][e.conversation_category]+=e.cost})),console.log("Processed Monthly Data:",s);const a=Object.keys(s).map((e=>({month:e,date:new Date(e)}))).sort(((e,t)=>e.date-t.date)).map((e=>e.month)),n=a.slice(-4),l=n.map((e=>s[e]?.MARKETING||0)),i=n.map((e=>s[e]?.UTILITY||0));r(n,l,i)}catch(e){console.error("Error fetching data:",e)}},r=(o,s,a)=>{t&&t.destroy();const r=e.value.getContext("2d");t=new ti.t1(r,{type:"bar",data:{labels:o,datasets:[{label:"Marketing",backgroundColor:"#7B61FF",data:s,stack:"stack1"},{label:"Utility",backgroundColor:"red",data:a,stack:"stack1"}]},options:{responsive:!0,plugins:{legend:{display:!0},title:{display:!0,text:"Cost Breakdown (Last 4 Months)"}},scales:{x:{grid:{display:!1},stacked:!0},y:{grid:{drawBorder:!1,drawTicks:!1,color:function(e){return 0===e.tick.value?"transparent":"#cccccc"}},stacked:!0}},elements:{bar:{barThickness:20}}}})};return(0,a.sV)(s),{chartCanvas:e}}};const si=(0,i.A)(oi,[["render",Zl],["__scopeId","data-v-2cc4a990"]]);var ai=si;const ri={class:"cost-summary"},ni={class:"overflow-x-auto max-h-[33vh] custom-scrollbar"},li={class:"w-full rounded-lg border-collapse"},ii={class:"bg-white"},ci={class:"border-[#ddd] p-2 md:p-4 text-left"},di={class:"border-[#ddd] p-2 md:p-4 text-left"},pi={class:"border-[#ddd] p-2 md:p-4 text-left"},ui={class:"border-[#ddd] p-2 md:p-4 text-left"},hi={class:"border-[#ddd] p-2 md:p-4 text-left"};function mi(e,t,o,s,r,n){return(0,a.uX)(),(0,a.CE)("div",ri,[t[1]||(t[1]=(0,a.Lk)("h2",{class:"title"},[(0,a.eW)("Transactions "),(0,a.Lk)("span",{class:"info"},"Info")],-1)),(0,a.Lk)("div",ni,[(0,a.Lk)("table",li,[t[0]||(t[0]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",{class:"bg-[#fff] text-center"},[(0,a.Lk)("th",{class:"p-2 text-left md:p-4 border-b-2 bg-[#fff] sticky top-0"},"Start Time"),(0,a.Lk)("th",{class:"p-2 text-left md:p-4 border-b-2 bg-[#fff] sticky top-0"},"End Time"),(0,a.Lk)("th",{class:"p-2 text-left md:p-4 border-b-2 bg-[#fff] sticky top-0"},"Conversation Type"),(0,a.Lk)("th",{class:"p-2 text-left md:p-4 border-b-2 bg-[#fff] sticky top-0"},"Conversation Category"),(0,a.Lk)("th",{class:"p-2 text-left md:p-4 border-b-2 bg-[#fff] sticky top-0"},"Cost")])],-1)),(0,a.Lk)("tbody",ii,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.sortedAnalyticsData,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t,class:"text-center"},[(0,a.Lk)("td",ci,(0,u.v_)(e.start_time),1),(0,a.Lk)("td",di,(0,u.v_)(e.end_time),1),(0,a.Lk)("td",pi,(0,u.v_)(e.conversation_type),1),(0,a.Lk)("td",ui,(0,u.v_)(e.conversation_category),1),(0,a.Lk)("td",hi,(0,u.v_)(e.cost),1)])))),128))])])])])}var gi={data(){return{apiUrl:"http://localhost:8000",selectedMonth:"",currentMonthStartDate:"",localUser:{whatsapp_business_id:""},analyticsData:[],loading:!0,error:null}},async mounted(){await this.fetchUserDetails();const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),o=new Date(e.getFullYear(),e.getMonth()+1,0);this.currentMonthStartDate=t.toISOString().split("T")[0],this.currentMonthEndDate=o.toISOString().split("T")[0],await this.fetchConversationHistory(this.currentMonthStartDate,this.currentMonthEndDate)},computed:{sortedAnalyticsData(){return[...this.analyticsData].sort(((e,t)=>new Date(t.start_time)-new Date(e.start_time)))}},methods:{async onMonthChange(){if(!this.selectedMonth)return;const[e,t]=this.selectedMonth.split("-"),o=new Date(e,t-1,1).toISOString().split("T")[0],s=new Date(e,t,0).toISOString().split("T")[0];await this.fetchConversationHistory(o,s)},async fetchUserDetails(){try{const e=await fetch(`${this.apiUrl}/user`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error("Failed to fetch user details");const t=await e.json();console.log(t),this.localUser.whatsapp_business_id=t["Whatsapp_Business_Id"]}catch(e){console.error("Error fetching user details:",e)}},async fetchConversationHistory(e,t){try{const o=await fetch(`${this.apiUrl}/conversation-cost-history/?start_date=${e}&end_date=${t}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s=await o.json();this.analyticsData=s.conversation_analytics,this.loading=!1}catch(o){this.error=o.message||"Failed to fetch data",this.loading=!1}},goToDashboard(){this.$router.push("/dashboard")}}};const bi=(0,i.A)(gi,[["render",mi],["__scopeId","data-v-9253a6c6"]]);var fi=bi,ki={components:{CostSummary:Yl,CostBarChart:ai,PurchaseHistory:fi}};const yi=(0,i.A)(ki,[["render",Dl],["__scopeId","data-v-0dd50add"]]);var vi=yi;const wi={class:"content-section m-8 md:ml-72"},xi={class:"bg-white rounded-lg rounded-[14px] border border-[#cccccc] max-w-[800px] p-4"},Li={class:"flex justify-between items-center"},Ci={class:"flex items-center ml-auto justify-end"},Si={key:0,class:"error"},Ei={ref:"analyticsChart"};function Ti(e,t,o,s,r,n){const l=(0,a.g2)("el-date-picker");return(0,a.uX)(),(0,a.CE)("div",wi,[(0,a.Lk)("div",xi,[(0,a.Lk)("div",Li,[t[2]||(t[2]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"title"},[(0,a.eW)("Conversations "),(0,a.Lk)("span",{class:"info"},"Info")])],-1)),(0,a.Lk)("div",Ci,[(0,a.bF)(l,{modelValue:r.dateRange,"onUpdate:modelValue":t[0]||(t[0]=e=>r.dateRange=e),type:"daterange","range-separator":"to","start-placeholder":"Start date","end-placeholder":"End date","value-format":"YYYY-MM-DD",onChange:n.updateDates,class:"max-w-[100%] mr-2"},null,8,["modelValue","onChange"]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>n.fetchAnalyticsData&&n.fetchAnalyticsData(...e)),class:"relative h-auto w-auto p-1 text-[15px] border-solid text-white bg-blue-500 hover:bg-blue-700"},"Apply")])]),r.error?((0,a.uX)(),(0,a.CE)("div",Si,(0,u.v_)(r.error),1)):(0,a.Q3)("",!0),(0,a.Lk)("canvas",Ei,null,512)])])}var _i=o(1601),Ai=(o(4188),{name:"dataAnalytics",data(){return{apiUrl:"http://localhost:8000",dateRange:[],startDate:"",endDate:"",analyticsData:null,error:null,loading:!1,chart:null,chartLabels:[],chartData:{sent:[],delivered:[]}}},created(){const e=new Date;this.endDate=e.toISOString().split("T")[0];const t=new Date;t.setDate(e.getDate()-7),this.startDate=t.toISOString().split("T")[0],this.fetchAnalyticsData(),this.renderChart()},methods:{updateDates(){this.startDate=this.dateRange?this.dateRange[0]:null,this.endDate=this.dateRange?this.dateRange[1]:null},fetchAnalyticsData(){if(!this.startDate||!this.endDate)return void(this.error="Start and end dates are required.");this.loading=!0,this.error=null,this.chartLabels=[],this.chartData={sent:[],delivered:[]};const e=`${this.apiUrl}/get-analytics?start=${this.startDate}&end=${this.endDate}`;fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then((e=>{if(!e.ok)throw new Error("Failed to fetch analytics");return e.json()})).then((e=>{this.analyticsData=e;const t=e.analytics?.data_points||[];if(0===t.length)return void(this.error="No analytics data found.");let o=t;if(t.length>10){const e=Math.ceil(t.length/10);o=t.filter(((t,o)=>o%e===0))}o.forEach((e=>{const t=new Date(1e3*e.start),o=t.toLocaleDateString("en-IN",{day:"2-digit",month:"short"});this.chartLabels.push(o),this.chartData.sent.push(e.sent||0),this.chartData.delivered.push(e.delivered||0)})),this.renderChart()})).catch((e=>{this.error=e.message})).finally((()=>{this.loading=!1}))},renderChart(){const e=this.$refs.analyticsChart;this.chart&&this.chart.destroy(),this.chart=new _i.A(e,{type:"line",data:{labels:this.chartLabels,datasets:[{label:"not delivered",data:this.chartData.sent.map(((e,t)=>e-this.chartData.delivered[t])),borderColor:"Red",backgroundColor:"rgba(123, 97, 255, 0.2)",borderDash:[5,5],tension:0},{label:"Sent",data:this.chartData.sent,borderColor:"#7B61FF",backgroundColor:"rgba(123, 97, 255, 0.2)",borderDash:[],tension:0},{label:"Delivered",data:this.chartData.delivered,borderColor:"#00C2D7",backgroundColor:"rgba(0, 194, 215, 0.2)",borderDash:[5,5],tension:0}]},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"All Conversations (Sent & Delivered)"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Messages"}},x:{title:{display:!0,text:"Date"}}}}})}}});const Pi=(0,i.A)(Ai,[["render",Ti],["__scopeId","data-v-525acc5c"]]);var Di=Pi;const Ii={class:"page-container"},Ui={class:"header"},Mi={class:"content-wrapper"},ji={class:"content-card"},Bi={class:"back-link"};function Fi(e,t,o,s,r,n){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",Ii,[(0,a.Lk)("header",Ui,[(0,a.bF)(l,{to:"/",class:"logo-link"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.Lk)("img",{src:"/path/to/your/wotnot-logo.svg",alt:"WotNot Logo",class:"logo-icon"},null,-1),(0,a.Lk)("span",{class:"logo-text"},"WotNot",-1)]))),_:1,__:[0]})]),(0,a.Lk)("main",Mi,[(0,a.Lk)("div",ji,[t[2]||(t[2]=(0,a.Fv)('<h1 id="terms-and-conditions" data-v-1c4cb574>Terms and Conditions</h1><p class="last-updated" data-v-1c4cb574>Last updated: May 25, 2025</p><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>1. Introduction</h2><p data-v-1c4cb574> Welcome to WotNot! These Terms and Conditions (&quot;Terms&quot;) govern your use of the WotNot website and any related services provided by us. By accessing or using our Service, you agree to be bound by these Terms. If you disagree with any part of the terms, then you may not access the Service. </p></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>2. Account Terms</h2><ul data-v-1c4cb574><li data-v-1c4cb574>You must be at least 18 years old to use this Service.</li><li data-v-1c4cb574> You are responsible for maintaining the security of your account and password. </li><li data-v-1c4cb574> You agree to provide true, accurate, current, and complete information when registering for an account. </li><li data-v-1c4cb574> You may not use the Service for any illegal or unauthorized purpose. </li></ul></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>3. Intellectual Property</h2><p data-v-1c4cb574> The Service and its original content, features, and functionality are and will remain the exclusive property of WotNot and its licensors. Our trademarks and trade dress may not be used in connection with any product or service without the prior written consent of WotNot. </p></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>4. Termination</h2><p data-v-1c4cb574> We may terminate or suspend your account immediately, without prior notice or liability, for any reason whatsoever, including without limitation if you breach the Terms. Upon termination, your right to use the Service will immediately cease. </p></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>5. Governing Law</h2><p data-v-1c4cb574> These Terms shall be governed and construed in accordance with the laws of [Your Country/State], without regard to its conflict of law provisions. </p></section><hr class="section-divider" data-v-1c4cb574><h1 id="privacy-policy" data-v-1c4cb574>Privacy Policy</h1><p class="last-updated" data-v-1c4cb574>Last updated: May 25, 2025</p><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>1. Introduction</h2><p data-v-1c4cb574> Your privacy is important to us. This Privacy Policy describes how WotNot (&quot;we,&quot; &quot;us,&quot; or &quot;our&quot;) collects, uses, and discloses your personal information when you use our website (the &quot;Service&quot;). </p></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>2. Information We Collect</h2><h3 data-v-1c4cb574>Personal Information:</h3><p data-v-1c4cb574> When you register for an account or interact with our Service, we may collect personally identifiable information, such as: </p><ul data-v-1c4cb574><li data-v-1c4cb574>Email address</li><li data-v-1c4cb574>Name (optional, if collected)</li><li data-v-1c4cb574>Password (stored securely, typically as a hash)</li></ul><h3 data-v-1c4cb574>Usage Data:</h3><p data-v-1c4cb574> We may also collect information that your browser sends whenever you visit our Service (&quot;Usage Data&quot;). This Usage Data may include information such as your computer&#39;s Internet Protocol address (e.g., IP address), browser type, browser version, the pages of our Service that you visit, the time and date of your visit, the time spent on those pages, unique device identifiers, and other diagnostic data. </p></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>3. How We Use Your Information</h2><p data-v-1c4cb574>WotNot uses the collected data for various purposes:</p><ul data-v-1c4cb574><li data-v-1c4cb574>To provide and maintain the Service</li><li data-v-1c4cb574>To notify you about changes to our Service</li><li data-v-1c4cb574> To allow you to participate in interactive features of our Service when you choose to do so </li><li data-v-1c4cb574>To provide customer support</li><li data-v-1c4cb574>To monitor the usage of the Service</li><li data-v-1c4cb574>To detect, prevent, and address technical issues</li></ul></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>4. Disclosure of Your Information</h2><p data-v-1c4cb574> We may share your information with trusted third parties who assist us in operating our website, conducting our business, or serving our users, so long as those parties agree to keep this information confidential. We may also release your information when we believe release is appropriate to comply with the law, enforce our site policies, or protect ours or others&#39; rights, property, or safety. </p></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>5. Your Data Protection Rights</h2><p data-v-1c4cb574> Depending on your location, you may have the following data protection rights: </p><ul data-v-1c4cb574><li data-v-1c4cb574> The right to access, update, or delete the information we have on you. </li><li data-v-1c4cb574>The right of rectification.</li><li data-v-1c4cb574>The right to object.</li><li data-v-1c4cb574>The right of restriction.</li><li data-v-1c4cb574>The right to data portability.</li><li data-v-1c4cb574>The right to withdraw consent.</li></ul><p data-v-1c4cb574> To exercise any of these rights, please contact us at [Your Contact Email Address]. </p></section><section class="section-content" data-v-1c4cb574><h2 data-v-1c4cb574>6. Changes to This Privacy Policy</h2><p data-v-1c4cb574> We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page. You are advised to review this Privacy Policy periodically for any changes. </p></section>',16)),(0,a.Lk)("div",Bi,[(0,a.bF)(l,{to:"/",class:"button"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("Back to Login")]))),_:1,__:[1]})])])])])}var Wi={name:"TermsAndPrivacy"};const Xi=(0,i.A)(Wi,[["render",Fi],["__scopeId","data-v-1c4cb574"]]);var $i=Xi;const Ni=(0,ue.dj)(),Oi=[{path:"/",component:mr},{path:"/signup",component:Wr},{path:"/terms-and-privacy",component:$i,name:"TermsAndPrivacy"},{path:"/dashboard",component:bn,meta:{requiresAuth:!0},children:[{path:"/agent",component:Cr,name:"AIagent"},{path:"/analytics/cost",component:vi,name:"Costanalytics"},{path:"/analytics/conversations",component:Di,name:"DataAnalytics"},{path:"/broadcast/broadcast1",component:Ae,name:"Broadcast1"},{path:"/broadcast/broadcast2",component:yo,name:"Broadcast2"},{path:"/broadcast/broadcast3",component:Mo,name:"Broadcast3"},{path:"/contacts/contacts1",component:Hs,name:"Contacts1"},{path:"/contacts/contacts2",component:Ks,name:"Contacts2"},{path:"/integration/integration1",component:sr,name:"Integration1"},{path:"/profile",component:un},{path:"/settings",component:Mn},{path:"",redirect:"/broadcast/broadcast2"},{path:"/chatbot/chatbotview",component:Sl,name:"ChatbotView"}]}],Ri=(0,p.aE)({history:(0,p.LA)(),routes:Oi});Ri.beforeEach(((e,t,o)=>{const s=localStorage.getItem("token");if(e.matched.some((e=>e.meta.requiresAuth))){if(!s)return Ni.error("Session expired. Please log in again."),o("/");try{const e=JSON.parse(atob(s.split(".")[1])),t=Math.floor(Date.now()/1e3);if(e.exp<t)return localStorage.removeItem("token"),Ni.error("Session expired. Please log in again."),o("/")}catch(a){return localStorage.removeItem("token"),o("/")}}o()}));var Vi=Ri,zi=(o(7917),o(8583));const Ji=(0,s.Ef)(d);Ji.config.compilerOptions=Ji.config.compilerOptions||{},Ji.config.compilerOptions.isCustomElement=e=>"lord-icon"===e||e.startsWith("lord-icon-");const Hi=document.createElement("script");Hi.src="https://cdn.lordicon.com/lusqsztk.js",Hi.async=!0,document.head.appendChild(Hi),Ji.use(zi.A),Ji.use(ue.Ay,{position:ue.II.TOP_LEFT,timeout:5e3,zIndex:2147483647}),Ji.config.devtools=!0,Ji.use(Vi).mount("#app")}},t={};function o(s){var a=t[s];if(void 0!==a)return a.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,s,a,r){if(!s){var n=1/0;for(d=0;d<e.length;d++){s=e[d][0],a=e[d][1],r=e[d][2];for(var l=!0,i=0;i<s.length;i++)(!1&r||n>=r)&&Object.keys(o.O).every((function(e){return o.O[e](s[i])}))?s.splice(i--,1):(l=!1,r<n&&(n=r));if(l){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[s,a,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var a,r,n=s[0],l=s[1],i=s[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(a in l)o.o(l,a)&&(o.m[a]=l[a]);if(i)var d=i(o)}for(t&&t(s);c<n.length;c++)r=n[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},s=self["webpackChunkWotnot"]=self["webpackChunkWotnot"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[504],(function(){return o(2660)}));s=o.O(s)})();
//# sourceMappingURL=app.529fc22f.js.map